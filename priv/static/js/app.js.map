{"version":3,"sources":["c:/Projects/yacht/node_modules/phoenix/priv/static/phoenix.js","c:/Projects/yacht/node_modules/phoenix_html/priv/static/phoenix_html.js","c:/Projects/yacht/web/static/js/jscolor.js","c:/Projects/yacht/web/static/js/roomcontroller.js","c:/Projects/yacht/web/static/js/setup.js","c:/Projects/yacht/web/static/js/socket.js","web/static/js/app.js","web/static/js/jscolor.js","web/static/js/roomcontroller.js","web/static/js/setup.js","web/static/js/socket.js"],"names":["window","jscolor","jsc","register","attachDOMReadyEvent","init","attachEvent","document","onDocumentMouseDown","onDocumentTouchStart","onWindowResize","lookupClass","installByClassName","tryInstallOnElements","elms","className","matchClass","RegExp","i","length","type","undefined","toLowerCase","isColorAttrSupported","m","match","targetElm","optsStr","dataOptions","getDataAttr","opts","Function","eParseError","warn","elm","createElement","setAttribute","isCanvasSupported","getContext","fetchElement","mixed","getElementById","isElementType","nodeName","el","name","attrName","attrValue","getAttribute","evnt","func","addEventListener","detachEvent","removeEventListener","_attachedGroupEvents","attachGroupEvent","groupName","hasOwnProperty","push","detachGroupEvents","evt","fired","fireOnce","readyState","setTimeout","arguments","callee","documentElement","doScroll","top","tryScroll","body","e","msg","console","preventDefault","returnValue","captureTarget","target","setCapture","_capturedTarget","releaseTarget","releaseCapture","fireEvent","createEvent","ev","initEvent","dispatchEvent","createEventObject","classNameToList","replace","split","hasClass","indexOf","setClass","classList","unsetClass","repl","getStyle","getComputedStyle","currentStyle","setStyle","helper","getSupportedProp","names","style","props","borderRadius","boxShadow","prop","value","alphaOpacity","Math","round","parseFloat","opacity","filter","setBorderRadius","setBoxShadow","getElementPos","relativeToViewport","x","y","rect","getBoundingClientRect","left","viewPos","getViewPos","getElementSize","offsetWidth","offsetHeight","getAbsPointerPos","event","changedTouches","clientX","clientY","getRelPointerPos","srcElement","targetRect","doc","pageXOffset","scrollLeft","clientLeft","pageYOffset","scrollTop","clientTop","getViewSize","innerWidth","clientWidth","innerHeight","clientHeight","redrawPosition","picker","owner","thisObj","tp","vp","fixed","targetElement","ts","vs","ps","getPickerOuterDims","a","b","c","position","l","smartPosition","pp","positionValue","contractShadow","_drawPosition","vShadow","shadowBlur","wrap","boxS","shadow","BoxShadow","shadowColor","getPickerDims","displaySlider","getSliderComponent","dims","insetWidth","padding","width","getPadToSliderPadding","sliderSize","height","closable","buttonHeight","borderWidth","max","pointerBorderWidth","pointerThickness","getPadYComponent","mode","charAt","_jscLinkedInstance","showOnClick","show","_jscControlName","onControlPointerStart","hide","onParentScroll","_pointerMoveEvent","mouse","touch","_pointerEndEvent","_pointerOrigin","controlName","pointerType","_jscInstance","registerDragEvents","offset","onDocumentPointerMove","onDocumentPointerEnd","parent","frameElement","ofs","abs","rel","hsv","fromHSV","setPad","setSld","dispatchFineChange","dispatchChange","valueElement","onFineChange","callback","call","ofsX","ofsY","pointerAbs","xVal","yVal","leaveSld","leavePad","_vmlNS","_vmlCSS","_vmlReady","initVML","namespaces","add","styleSheets","tags","ss","createStyleSheet","owningElement","id","addRule","createPalette","paletteObj","draw","canvas","ctx","drawFunc","clearRect","hGrad","createLinearGradient","addColorStop","fillStyle","fillRect","vGrad","vmlContainer","overflow","method","angle","colors","hRect","stroked","appendChild","vRect","color","color2","createSliderGradient","sliderObj","color1","grad","leaveValue","leaveStyle","hShadow","blur","spread","inset","prototype","toString","vals","join","options","styleElement","required","refine","hash","uppercase","activeClass","minS","maxS","minV","maxV","rgb","crossSize","closeText","buttonColor","backgroundColor","borderColor","insetColor","pointerColor","pointerBorderColor","zIndex","container","opt","isPickerOwner","detachPicker","drawPicker","redraw","importColor","exportColor","fromString","backgroundImage","_jscOrigStyle","test","flags","toUpperCase","innerHTML","isLight","redrawPad","redrawSld","h","s","v","isNaN","min","HSV_RGB","fromRGB","r","g","RGB_HSV","str","parseInt","substr","params","re","mR","mG","mB","toHEXString","toRGBString","_processParentElementsInDOM","_linkedElementsProcessed","currStyle","_jscEventsAttached","parentNode","n","u","floor","f","THIS","removeChild","box","boxB","pad","padB","padM","padPal","cross","crossBY","crossBX","crossLY","crossLX","sld","sldB","sldM","sldGrad","sldPtrS","sldPtrIB","sldPtrMB","sldPtrOB","btn","btnT","p","crossOuterSize","padToSliderPadding","PI","padCursor","clear","border","background","cursor","display","right","sliderPtrSpace","setBtnBorder","insetColors","outsetColor","bottom","font","textAlign","eOldIE","onmousedown","lineHeight","createTextNode","yComponent","rgb1","rgb2","sldComponent","blurValue","getElementsByTagName","onclick","origCallback","updateField","inputElms","buttonElms","yachtApp","controller","RoomController","$scope","$","getJSON","data","users","$apply","angular","module","currUser","cursorStates","drawing","mousePos","lastPos","mouseCanvas","mouseCtx","collabCanvas","strokeStyle","lineWidth","socket","token","userToken","clearCanvas","reloadUserTable","scope","connect","channel","receive","log","resp","on","moveTo","payload","from","lineTo","to","stroke","img","cursorKeys","Object","keys","forEach","currKey","drawImage","downloadCanvas","link","canvasId","filename","href","toDataURL","download","ready","baseName","random","val","change","colorValue","requestAnimFrame","requestAnimationFrame","webkitRequestAnimationFrame","mozRequestAnimationFrame","oRequestAnimationFrame","msRequestAnimaitonFrame","clearBtn","changeUserBtn","getMousePos","getTouchPos","touches","mouseEvent","MouseEvent","canvasDom","touchEvent","renderCanvas","drawLoop"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AC3vCA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACpCA;;;;;;;;;;;;AAaA;;AAGA,IAAI,CAACA,OAAOC,OAAZ,EAAqB;AAAED,QAAOC,OAAP,GAAkB,YAAY;;AAGrD,MAAIC,MAAM;;AAGTC,aAAW,oBAAY;AACtBD,QAAIE,mBAAJ,CAAwBF,IAAIG,IAA5B;AACAH,QAAII,WAAJ,CAAgBC,QAAhB,EAA0B,WAA1B,EAAuCL,IAAIM,mBAA3C;AACAN,QAAII,WAAJ,CAAgBC,QAAhB,EAA0B,YAA1B,EAAwCL,IAAIO,oBAA5C;AACAP,QAAII,WAAJ,CAAgBN,MAAhB,EAAwB,QAAxB,EAAkCE,IAAIQ,cAAtC;AACA,IARQ;;AAWTL,SAAO,gBAAY;AAClB,QAAIH,IAAID,OAAJ,CAAYU,WAAhB,EAA6B;AAC5BT,SAAID,OAAJ,CAAYW,kBAAZ,CAA+BV,IAAID,OAAJ,CAAYU,WAA3C;AACA;AACD,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","file":"priv\\static\\js\\app.js","sourcesContent":["\nrequire.register(\"phoenix/priv/static/phoenix.js\", function(exports, require, module) {\n  require = __makeRelativeRequire(require, {}, \"phoenix\");\n  (function() {\n    (function(exports){\n\"use strict\";\n\nvar _typeof = typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\" ? function (obj) { return typeof obj; } : function (obj) { return obj && typeof Symbol === \"function\" && obj.constructor === Symbol ? \"symbol\" : typeof obj; };\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nfunction _toConsumableArray(arr) { if (Array.isArray(arr)) { for (var i = 0, arr2 = Array(arr.length); i < arr.length; i++) { arr2[i] = arr[i]; } return arr2; } else { return Array.from(arr); } }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\n// Phoenix Channels JavaScript client\n//\n// ## Socket Connection\n//\n// A single connection is established to the server and\n// channels are multiplexed over the connection.\n// Connect to the server using the `Socket` class:\n//\n//     let socket = new Socket(\"/ws\", {params: {userToken: \"123\"}})\n//     socket.connect()\n//\n// The `Socket` constructor takes the mount point of the socket,\n// the authentication params, as well as options that can be found in\n// the Socket docs, such as configuring the `LongPoll` transport, and\n// heartbeat.\n//\n// ## Channels\n//\n// Channels are isolated, concurrent processes on the server that\n// subscribe to topics and broker events between the client and server.\n// To join a channel, you must provide the topic, and channel params for\n// authorization. Here's an example chat room example where `\"new_msg\"`\n// events are listened for, messages are pushed to the server, and\n// the channel is joined with ok/error/timeout matches:\n//\n//     let channel = socket.channel(\"room:123\", {token: roomToken})\n//     channel.on(\"new_msg\", msg => console.log(\"Got message\", msg) )\n//     $input.onEnter( e => {\n//       channel.push(\"new_msg\", {body: e.target.val}, 10000)\n//        .receive(\"ok\", (msg) => console.log(\"created message\", msg) )\n//        .receive(\"error\", (reasons) => console.log(\"create failed\", reasons) )\n//        .receive(\"timeout\", () => console.log(\"Networking issue...\") )\n//     })\n//     channel.join()\n//       .receive(\"ok\", ({messages}) => console.log(\"catching up\", messages) )\n//       .receive(\"error\", ({reason}) => console.log(\"failed join\", reason) )\n//       .receive(\"timeout\", () => console.log(\"Networking issue. Still waiting...\") )\n//\n//\n// ## Joining\n//\n// Creating a channel with `socket.channel(topic, params)`, binds the params to\n// `channel.params`, which are sent up on `channel.join()`.\n// Subsequent rejoins will send up the modified params for\n// updating authorization params, or passing up last_message_id information.\n// Successful joins receive an \"ok\" status, while unsuccessful joins\n// receive \"error\".\n//\n// ## Duplicate Join Subscriptions\n//\n// While the client may join any number of topics on any number of channels,\n// the client may only hold a single subscription for each unique topic at any\n// given time. When attempting to create a duplicate subscription,\n// the server will close the existing channel, log a warning, and\n// spawn a new channel for the topic. The client will have their\n// `channel.onClose` callbacks fired for the existing channel, and the new\n// channel join will have its receive hooks processed as normal.\n//\n// ## Pushing Messages\n//\n// From the previous example, we can see that pushing messages to the server\n// can be done with `channel.push(eventName, payload)` and we can optionally\n// receive responses from the push. Additionally, we can use\n// `receive(\"timeout\", callback)` to abort waiting for our other `receive` hooks\n//  and take action after some period of waiting. The default timeout is 5000ms.\n//\n//\n// ## Socket Hooks\n//\n// Lifecycle events of the multiplexed connection can be hooked into via\n// `socket.onError()` and `socket.onClose()` events, ie:\n//\n//     socket.onError( () => console.log(\"there was an error with the connection!\") )\n//     socket.onClose( () => console.log(\"the connection dropped\") )\n//\n//\n// ## Channel Hooks\n//\n// For each joined channel, you can bind to `onError` and `onClose` events\n// to monitor the channel lifecycle, ie:\n//\n//     channel.onError( () => console.log(\"there was an error!\") )\n//     channel.onClose( () => console.log(\"the channel has gone away gracefully\") )\n//\n// ### onError hooks\n//\n// `onError` hooks are invoked if the socket connection drops, or the channel\n// crashes on the server. In either case, a channel rejoin is attempted\n// automatically in an exponential backoff manner.\n//\n// ### onClose hooks\n//\n// `onClose` hooks are invoked only in two cases. 1) the channel explicitly\n// closed on the server, or 2). The client explicitly closed, by calling\n// `channel.leave()`\n//\n//\n// ## Presence\n//\n// The `Presence` object provides features for syncing presence information\n// from the server with the client and handling presences joining and leaving.\n//\n// ### Syncing initial state from the server\n//\n// `Presence.syncState` is used to sync the list of presences on the server\n// with the client's state. An optional `onJoin` and `onLeave` callback can\n// be provided to react to changes in the client's local presences across\n// disconnects and reconnects with the server.\n//\n// `Presence.syncDiff` is used to sync a diff of presence join and leave\n// events from the server, as they happen. Like `syncState`, `syncDiff`\n// accepts optional `onJoin` and `onLeave` callbacks to react to a user\n// joining or leaving from a device.\n//\n// ### Listing Presences\n//\n// `Presence.list` is used to return a list of presence information\n// based on the local state of metadata. By default, all presence\n// metadata is returned, but a `listBy` function can be supplied to\n// allow the client to select which metadata to use for a given presence.\n// For example, you may have a user online from different devices with a\n// a metadata status of \"online\", but they have set themselves to \"away\"\n// on another device. In this case, they app may choose to use the \"away\"\n// status for what appears on the UI. The example below defines a `listBy`\n// function which prioritizes the first metadata which was registered for\n// each user. This could be the first tab they opened, or the first device\n// they came online from:\n//\n//     let state = {}\n//     state = Presence.syncState(state, stateFromServer)\n//     let listBy = (id, {metas: [first, ...rest]}) => {\n//       first.count = rest.length + 1 // count of this user's presences\n//       first.id = id\n//       return first\n//     }\n//     let onlineUsers = Presence.list(state, listBy)\n//\n//\n// ### Example Usage\n//\n//     // detect if user has joined for the 1st time or from another tab/device\n//     let onJoin = (id, current, newPres) => {\n//       if(!current){\n//         console.log(\"user has entered for the first time\", newPres)\n//       } else {\n//         console.log(\"user additional presence\", newPres)\n//       }\n//     }\n//     // detect if user has left from all tabs/devices, or is still present\n//     let onLeave = (id, current, leftPres) => {\n//       if(current.metas.length === 0){\n//         console.log(\"user has left from all devices\", leftPres)\n//       } else {\n//         console.log(\"user left from a device\", leftPres)\n//       }\n//     }\n//     let presences = {} // client's initial empty presence state\n//     // receive initial presence data from server, sent after join\n//     myChannel.on(\"presences\", state => {\n//       presences = Presence.syncState(presences, state, onJoin, onLeave)\n//       displayUsers(Presence.list(presences))\n//     })\n//     // receive \"presence_diff\" from server, containing join/leave events\n//     myChannel.on(\"presence_diff\", diff => {\n//       presences = Presence.syncDiff(presences, diff, onJoin, onLeave)\n//       this.setState({users: Presence.list(room.presences, listBy)})\n//     })\n//\nvar VSN = \"1.0.0\";\nvar SOCKET_STATES = { connecting: 0, open: 1, closing: 2, closed: 3 };\nvar DEFAULT_TIMEOUT = 10000;\nvar CHANNEL_STATES = {\n  closed: \"closed\",\n  errored: \"errored\",\n  joined: \"joined\",\n  joining: \"joining\",\n  leaving: \"leaving\"\n};\nvar CHANNEL_EVENTS = {\n  close: \"phx_close\",\n  error: \"phx_error\",\n  join: \"phx_join\",\n  reply: \"phx_reply\",\n  leave: \"phx_leave\"\n};\nvar TRANSPORTS = {\n  longpoll: \"longpoll\",\n  websocket: \"websocket\"\n};\n\nvar Push = function () {\n\n  // Initializes the Push\n  //\n  // channel - The Channel\n  // event - The event, for example `\"phx_join\"`\n  // payload - The payload, for example `{user_id: 123}`\n  // timeout - The push timeout in milliseconds\n  //\n\n  function Push(channel, event, payload, timeout) {\n    _classCallCheck(this, Push);\n\n    this.channel = channel;\n    this.event = event;\n    this.payload = payload || {};\n    this.receivedResp = null;\n    this.timeout = timeout;\n    this.timeoutTimer = null;\n    this.recHooks = [];\n    this.sent = false;\n  }\n\n  _createClass(Push, [{\n    key: \"resend\",\n    value: function resend(timeout) {\n      this.timeout = timeout;\n      this.cancelRefEvent();\n      this.ref = null;\n      this.refEvent = null;\n      this.receivedResp = null;\n      this.sent = false;\n      this.send();\n    }\n  }, {\n    key: \"send\",\n    value: function send() {\n      if (this.hasReceived(\"timeout\")) {\n        return;\n      }\n      this.startTimeout();\n      this.sent = true;\n      this.channel.socket.push({\n        topic: this.channel.topic,\n        event: this.event,\n        payload: this.payload,\n        ref: this.ref\n      });\n    }\n  }, {\n    key: \"receive\",\n    value: function receive(status, callback) {\n      if (this.hasReceived(status)) {\n        callback(this.receivedResp.response);\n      }\n\n      this.recHooks.push({ status: status, callback: callback });\n      return this;\n    }\n\n    // private\n\n  }, {\n    key: \"matchReceive\",\n    value: function matchReceive(_ref) {\n      var status = _ref.status;\n      var response = _ref.response;\n      var ref = _ref.ref;\n\n      this.recHooks.filter(function (h) {\n        return h.status === status;\n      }).forEach(function (h) {\n        return h.callback(response);\n      });\n    }\n  }, {\n    key: \"cancelRefEvent\",\n    value: function cancelRefEvent() {\n      if (!this.refEvent) {\n        return;\n      }\n      this.channel.off(this.refEvent);\n    }\n  }, {\n    key: \"cancelTimeout\",\n    value: function cancelTimeout() {\n      clearTimeout(this.timeoutTimer);\n      this.timeoutTimer = null;\n    }\n  }, {\n    key: \"startTimeout\",\n    value: function startTimeout() {\n      var _this = this;\n\n      if (this.timeoutTimer) {\n        return;\n      }\n      this.ref = this.channel.socket.makeRef();\n      this.refEvent = this.channel.replyEventName(this.ref);\n\n      this.channel.on(this.refEvent, function (payload) {\n        _this.cancelRefEvent();\n        _this.cancelTimeout();\n        _this.receivedResp = payload;\n        _this.matchReceive(payload);\n      });\n\n      this.timeoutTimer = setTimeout(function () {\n        _this.trigger(\"timeout\", {});\n      }, this.timeout);\n    }\n  }, {\n    key: \"hasReceived\",\n    value: function hasReceived(status) {\n      return this.receivedResp && this.receivedResp.status === status;\n    }\n  }, {\n    key: \"trigger\",\n    value: function trigger(status, response) {\n      this.channel.trigger(this.refEvent, { status: status, response: response });\n    }\n  }]);\n\n  return Push;\n}();\n\nvar Channel = exports.Channel = function () {\n  function Channel(topic, params, socket) {\n    var _this2 = this;\n\n    _classCallCheck(this, Channel);\n\n    this.state = CHANNEL_STATES.closed;\n    this.topic = topic;\n    this.params = params || {};\n    this.socket = socket;\n    this.bindings = [];\n    this.timeout = this.socket.timeout;\n    this.joinedOnce = false;\n    this.joinPush = new Push(this, CHANNEL_EVENTS.join, this.params, this.timeout);\n    this.pushBuffer = [];\n    this.rejoinTimer = new Timer(function () {\n      return _this2.rejoinUntilConnected();\n    }, this.socket.reconnectAfterMs);\n    this.joinPush.receive(\"ok\", function () {\n      _this2.state = CHANNEL_STATES.joined;\n      _this2.rejoinTimer.reset();\n      _this2.pushBuffer.forEach(function (pushEvent) {\n        return pushEvent.send();\n      });\n      _this2.pushBuffer = [];\n    });\n    this.onClose(function () {\n      _this2.rejoinTimer.reset();\n      _this2.socket.log(\"channel\", \"close \" + _this2.topic + \" \" + _this2.joinRef());\n      _this2.state = CHANNEL_STATES.closed;\n      _this2.socket.remove(_this2);\n    });\n    this.onError(function (reason) {\n      if (_this2.isLeaving() || _this2.isClosed()) {\n        return;\n      }\n      _this2.socket.log(\"channel\", \"error \" + _this2.topic, reason);\n      _this2.state = CHANNEL_STATES.errored;\n      _this2.rejoinTimer.scheduleTimeout();\n    });\n    this.joinPush.receive(\"timeout\", function () {\n      if (!_this2.isJoining()) {\n        return;\n      }\n      _this2.socket.log(\"channel\", \"timeout \" + _this2.topic, _this2.joinPush.timeout);\n      _this2.state = CHANNEL_STATES.errored;\n      _this2.rejoinTimer.scheduleTimeout();\n    });\n    this.on(CHANNEL_EVENTS.reply, function (payload, ref) {\n      _this2.trigger(_this2.replyEventName(ref), payload);\n    });\n  }\n\n  _createClass(Channel, [{\n    key: \"rejoinUntilConnected\",\n    value: function rejoinUntilConnected() {\n      this.rejoinTimer.scheduleTimeout();\n      if (this.socket.isConnected()) {\n        this.rejoin();\n      }\n    }\n  }, {\n    key: \"join\",\n    value: function join() {\n      var timeout = arguments.length <= 0 || arguments[0] === undefined ? this.timeout : arguments[0];\n\n      if (this.joinedOnce) {\n        throw \"tried to join multiple times. 'join' can only be called a single time per channel instance\";\n      } else {\n        this.joinedOnce = true;\n        this.rejoin(timeout);\n        return this.joinPush;\n      }\n    }\n  }, {\n    key: \"onClose\",\n    value: function onClose(callback) {\n      this.on(CHANNEL_EVENTS.close, callback);\n    }\n  }, {\n    key: \"onError\",\n    value: function onError(callback) {\n      this.on(CHANNEL_EVENTS.error, function (reason) {\n        return callback(reason);\n      });\n    }\n  }, {\n    key: \"on\",\n    value: function on(event, callback) {\n      this.bindings.push({ event: event, callback: callback });\n    }\n  }, {\n    key: \"off\",\n    value: function off(event) {\n      this.bindings = this.bindings.filter(function (bind) {\n        return bind.event !== event;\n      });\n    }\n  }, {\n    key: \"canPush\",\n    value: function canPush() {\n      return this.socket.isConnected() && this.isJoined();\n    }\n  }, {\n    key: \"push\",\n    value: function push(event, payload) {\n      var timeout = arguments.length <= 2 || arguments[2] === undefined ? this.timeout : arguments[2];\n\n      if (!this.joinedOnce) {\n        throw \"tried to push '\" + event + \"' to '\" + this.topic + \"' before joining. Use channel.join() before pushing events\";\n      }\n      var pushEvent = new Push(this, event, payload, timeout);\n      if (this.canPush()) {\n        pushEvent.send();\n      } else {\n        pushEvent.startTimeout();\n        this.pushBuffer.push(pushEvent);\n      }\n\n      return pushEvent;\n    }\n\n    // Leaves the channel\n    //\n    // Unsubscribes from server events, and\n    // instructs channel to terminate on server\n    //\n    // Triggers onClose() hooks\n    //\n    // To receive leave acknowledgements, use the a `receive`\n    // hook to bind to the server ack, ie:\n    //\n    //     channel.leave().receive(\"ok\", () => alert(\"left!\") )\n    //\n\n  }, {\n    key: \"leave\",\n    value: function leave() {\n      var _this3 = this;\n\n      var timeout = arguments.length <= 0 || arguments[0] === undefined ? this.timeout : arguments[0];\n\n      this.state = CHANNEL_STATES.leaving;\n      var onClose = function onClose() {\n        _this3.socket.log(\"channel\", \"leave \" + _this3.topic);\n        _this3.trigger(CHANNEL_EVENTS.close, \"leave\", _this3.joinRef());\n      };\n      var leavePush = new Push(this, CHANNEL_EVENTS.leave, {}, timeout);\n      leavePush.receive(\"ok\", function () {\n        return onClose();\n      }).receive(\"timeout\", function () {\n        return onClose();\n      });\n      leavePush.send();\n      if (!this.canPush()) {\n        leavePush.trigger(\"ok\", {});\n      }\n\n      return leavePush;\n    }\n\n    // Overridable message hook\n    //\n    // Receives all events for specialized message handling\n    // before dispatching to the channel callbacks.\n    //\n    // Must return the payload, modified or unmodified\n\n  }, {\n    key: \"onMessage\",\n    value: function onMessage(event, payload, ref) {\n      return payload;\n    }\n\n    // private\n\n  }, {\n    key: \"isMember\",\n    value: function isMember(topic) {\n      return this.topic === topic;\n    }\n  }, {\n    key: \"joinRef\",\n    value: function joinRef() {\n      return this.joinPush.ref;\n    }\n  }, {\n    key: \"sendJoin\",\n    value: function sendJoin(timeout) {\n      this.state = CHANNEL_STATES.joining;\n      this.joinPush.resend(timeout);\n    }\n  }, {\n    key: \"rejoin\",\n    value: function rejoin() {\n      var timeout = arguments.length <= 0 || arguments[0] === undefined ? this.timeout : arguments[0];\n      if (this.isLeaving()) {\n        return;\n      }\n      this.sendJoin(timeout);\n    }\n  }, {\n    key: \"trigger\",\n    value: function trigger(event, payload, ref) {\n      var close = CHANNEL_EVENTS.close;\n      var error = CHANNEL_EVENTS.error;\n      var leave = CHANNEL_EVENTS.leave;\n      var join = CHANNEL_EVENTS.join;\n\n      if (ref && [close, error, leave, join].indexOf(event) >= 0 && ref !== this.joinRef()) {\n        return;\n      }\n      var handledPayload = this.onMessage(event, payload, ref);\n      if (payload && !handledPayload) {\n        throw \"channel onMessage callbacks must return the payload, modified or unmodified\";\n      }\n\n      this.bindings.filter(function (bind) {\n        return bind.event === event;\n      }).map(function (bind) {\n        return bind.callback(handledPayload, ref);\n      });\n    }\n  }, {\n    key: \"replyEventName\",\n    value: function replyEventName(ref) {\n      return \"chan_reply_\" + ref;\n    }\n  }, {\n    key: \"isClosed\",\n    value: function isClosed() {\n      return this.state === CHANNEL_STATES.closed;\n    }\n  }, {\n    key: \"isErrored\",\n    value: function isErrored() {\n      return this.state === CHANNEL_STATES.errored;\n    }\n  }, {\n    key: \"isJoined\",\n    value: function isJoined() {\n      return this.state === CHANNEL_STATES.joined;\n    }\n  }, {\n    key: \"isJoining\",\n    value: function isJoining() {\n      return this.state === CHANNEL_STATES.joining;\n    }\n  }, {\n    key: \"isLeaving\",\n    value: function isLeaving() {\n      return this.state === CHANNEL_STATES.leaving;\n    }\n  }]);\n\n  return Channel;\n}();\n\nvar Socket = exports.Socket = function () {\n\n  // Initializes the Socket\n  //\n  // endPoint - The string WebSocket endpoint, ie, \"ws://example.com/ws\",\n  //                                               \"wss://example.com\"\n  //                                               \"/ws\" (inherited host & protocol)\n  // opts - Optional configuration\n  //   transport - The Websocket Transport, for example WebSocket or Phoenix.LongPoll.\n  //               Defaults to WebSocket with automatic LongPoll fallback.\n  //   timeout - The default timeout in milliseconds to trigger push timeouts.\n  //             Defaults `DEFAULT_TIMEOUT`\n  //   heartbeatIntervalMs - The millisec interval to send a heartbeat message\n  //   reconnectAfterMs - The optional function that returns the millsec\n  //                      reconnect interval. Defaults to stepped backoff of:\n  //\n  //     function(tries){\n  //       return [1000, 5000, 10000][tries - 1] || 10000\n  //     }\n  //\n  //   logger - The optional function for specialized logging, ie:\n  //     `logger: (kind, msg, data) => { console.log(`${kind}: ${msg}`, data) }\n  //\n  //   longpollerTimeout - The maximum timeout of a long poll AJAX request.\n  //                        Defaults to 20s (double the server long poll timer).\n  //\n  //   params - The optional params to pass when connecting\n  //\n  // For IE8 support use an ES5-shim (https://github.com/es-shims/es5-shim)\n  //\n\n  function Socket(endPoint) {\n    var _this4 = this;\n\n    var opts = arguments.length <= 1 || arguments[1] === undefined ? {} : arguments[1];\n\n    _classCallCheck(this, Socket);\n\n    this.stateChangeCallbacks = { open: [], close: [], error: [], message: [] };\n    this.channels = [];\n    this.sendBuffer = [];\n    this.ref = 0;\n    this.timeout = opts.timeout || DEFAULT_TIMEOUT;\n    this.transport = opts.transport || window.WebSocket || LongPoll;\n    this.heartbeatIntervalMs = opts.heartbeatIntervalMs || 30000;\n    this.reconnectAfterMs = opts.reconnectAfterMs || function (tries) {\n      return [1000, 2000, 5000, 10000][tries - 1] || 10000;\n    };\n    this.logger = opts.logger || function () {}; // noop\n    this.longpollerTimeout = opts.longpollerTimeout || 20000;\n    this.params = opts.params || {};\n    this.endPoint = endPoint + \"/\" + TRANSPORTS.websocket;\n    this.reconnectTimer = new Timer(function () {\n      _this4.disconnect(function () {\n        return _this4.connect();\n      });\n    }, this.reconnectAfterMs);\n  }\n\n  _createClass(Socket, [{\n    key: \"protocol\",\n    value: function protocol() {\n      return location.protocol.match(/^https/) ? \"wss\" : \"ws\";\n    }\n  }, {\n    key: \"endPointURL\",\n    value: function endPointURL() {\n      var uri = Ajax.appendParams(Ajax.appendParams(this.endPoint, this.params), { vsn: VSN });\n      if (uri.charAt(0) !== \"/\") {\n        return uri;\n      }\n      if (uri.charAt(1) === \"/\") {\n        return this.protocol() + \":\" + uri;\n      }\n\n      return this.protocol() + \"://\" + location.host + uri;\n    }\n  }, {\n    key: \"disconnect\",\n    value: function disconnect(callback, code, reason) {\n      if (this.conn) {\n        this.conn.onclose = function () {}; // noop\n        if (code) {\n          this.conn.close(code, reason || \"\");\n        } else {\n          this.conn.close();\n        }\n        this.conn = null;\n      }\n      callback && callback();\n    }\n\n    // params - The params to send when connecting, for example `{user_id: userToken}`\n\n  }, {\n    key: \"connect\",\n    value: function connect(params) {\n      var _this5 = this;\n\n      if (params) {\n        console && console.log(\"passing params to connect is deprecated. Instead pass :params to the Socket constructor\");\n        this.params = params;\n      }\n      if (this.conn) {\n        return;\n      }\n\n      this.conn = new this.transport(this.endPointURL());\n      this.conn.timeout = this.longpollerTimeout;\n      this.conn.onopen = function () {\n        return _this5.onConnOpen();\n      };\n      this.conn.onerror = function (error) {\n        return _this5.onConnError(error);\n      };\n      this.conn.onmessage = function (event) {\n        return _this5.onConnMessage(event);\n      };\n      this.conn.onclose = function (event) {\n        return _this5.onConnClose(event);\n      };\n    }\n\n    // Logs the message. Override `this.logger` for specialized logging. noops by default\n\n  }, {\n    key: \"log\",\n    value: function log(kind, msg, data) {\n      this.logger(kind, msg, data);\n    }\n\n    // Registers callbacks for connection state change events\n    //\n    // Examples\n    //\n    //    socket.onError(function(error){ alert(\"An error occurred\") })\n    //\n\n  }, {\n    key: \"onOpen\",\n    value: function onOpen(callback) {\n      this.stateChangeCallbacks.open.push(callback);\n    }\n  }, {\n    key: \"onClose\",\n    value: function onClose(callback) {\n      this.stateChangeCallbacks.close.push(callback);\n    }\n  }, {\n    key: \"onError\",\n    value: function onError(callback) {\n      this.stateChangeCallbacks.error.push(callback);\n    }\n  }, {\n    key: \"onMessage\",\n    value: function onMessage(callback) {\n      this.stateChangeCallbacks.message.push(callback);\n    }\n  }, {\n    key: \"onConnOpen\",\n    value: function onConnOpen() {\n      var _this6 = this;\n\n      this.log(\"transport\", \"connected to \" + this.endPointURL(), this.transport.prototype);\n      this.flushSendBuffer();\n      this.reconnectTimer.reset();\n      if (!this.conn.skipHeartbeat) {\n        clearInterval(this.heartbeatTimer);\n        this.heartbeatTimer = setInterval(function () {\n          return _this6.sendHeartbeat();\n        }, this.heartbeatIntervalMs);\n      }\n      this.stateChangeCallbacks.open.forEach(function (callback) {\n        return callback();\n      });\n    }\n  }, {\n    key: \"onConnClose\",\n    value: function onConnClose(event) {\n      this.log(\"transport\", \"close\", event);\n      this.triggerChanError();\n      clearInterval(this.heartbeatTimer);\n      this.reconnectTimer.scheduleTimeout();\n      this.stateChangeCallbacks.close.forEach(function (callback) {\n        return callback(event);\n      });\n    }\n  }, {\n    key: \"onConnError\",\n    value: function onConnError(error) {\n      this.log(\"transport\", error);\n      this.triggerChanError();\n      this.stateChangeCallbacks.error.forEach(function (callback) {\n        return callback(error);\n      });\n    }\n  }, {\n    key: \"triggerChanError\",\n    value: function triggerChanError() {\n      this.channels.forEach(function (channel) {\n        return channel.trigger(CHANNEL_EVENTS.error);\n      });\n    }\n  }, {\n    key: \"connectionState\",\n    value: function connectionState() {\n      switch (this.conn && this.conn.readyState) {\n        case SOCKET_STATES.connecting:\n          return \"connecting\";\n        case SOCKET_STATES.open:\n          return \"open\";\n        case SOCKET_STATES.closing:\n          return \"closing\";\n        default:\n          return \"closed\";\n      }\n    }\n  }, {\n    key: \"isConnected\",\n    value: function isConnected() {\n      return this.connectionState() === \"open\";\n    }\n  }, {\n    key: \"remove\",\n    value: function remove(channel) {\n      this.channels = this.channels.filter(function (c) {\n        return c.joinRef() !== channel.joinRef();\n      });\n    }\n  }, {\n    key: \"channel\",\n    value: function channel(topic) {\n      var chanParams = arguments.length <= 1 || arguments[1] === undefined ? {} : arguments[1];\n\n      var chan = new Channel(topic, chanParams, this);\n      this.channels.push(chan);\n      return chan;\n    }\n  }, {\n    key: \"push\",\n    value: function push(data) {\n      var _this7 = this;\n\n      var topic = data.topic;\n      var event = data.event;\n      var payload = data.payload;\n      var ref = data.ref;\n\n      var callback = function callback() {\n        return _this7.conn.send(JSON.stringify(data));\n      };\n      this.log(\"push\", topic + \" \" + event + \" (\" + ref + \")\", payload);\n      if (this.isConnected()) {\n        callback();\n      } else {\n        this.sendBuffer.push(callback);\n      }\n    }\n\n    // Return the next message ref, accounting for overflows\n\n  }, {\n    key: \"makeRef\",\n    value: function makeRef() {\n      var newRef = this.ref + 1;\n      if (newRef === this.ref) {\n        this.ref = 0;\n      } else {\n        this.ref = newRef;\n      }\n\n      return this.ref.toString();\n    }\n  }, {\n    key: \"sendHeartbeat\",\n    value: function sendHeartbeat() {\n      if (!this.isConnected()) {\n        return;\n      }\n      this.push({ topic: \"phoenix\", event: \"heartbeat\", payload: {}, ref: this.makeRef() });\n    }\n  }, {\n    key: \"flushSendBuffer\",\n    value: function flushSendBuffer() {\n      if (this.isConnected() && this.sendBuffer.length > 0) {\n        this.sendBuffer.forEach(function (callback) {\n          return callback();\n        });\n        this.sendBuffer = [];\n      }\n    }\n  }, {\n    key: \"onConnMessage\",\n    value: function onConnMessage(rawMessage) {\n      var msg = JSON.parse(rawMessage.data);\n      var topic = msg.topic;\n      var event = msg.event;\n      var payload = msg.payload;\n      var ref = msg.ref;\n\n      this.log(\"receive\", (payload.status || \"\") + \" \" + topic + \" \" + event + \" \" + (ref && \"(\" + ref + \")\" || \"\"), payload);\n      this.channels.filter(function (channel) {\n        return channel.isMember(topic);\n      }).forEach(function (channel) {\n        return channel.trigger(event, payload, ref);\n      });\n      this.stateChangeCallbacks.message.forEach(function (callback) {\n        return callback(msg);\n      });\n    }\n  }]);\n\n  return Socket;\n}();\n\nvar LongPoll = exports.LongPoll = function () {\n  function LongPoll(endPoint) {\n    _classCallCheck(this, LongPoll);\n\n    this.endPoint = null;\n    this.token = null;\n    this.skipHeartbeat = true;\n    this.onopen = function () {}; // noop\n    this.onerror = function () {}; // noop\n    this.onmessage = function () {}; // noop\n    this.onclose = function () {}; // noop\n    this.pollEndpoint = this.normalizeEndpoint(endPoint);\n    this.readyState = SOCKET_STATES.connecting;\n\n    this.poll();\n  }\n\n  _createClass(LongPoll, [{\n    key: \"normalizeEndpoint\",\n    value: function normalizeEndpoint(endPoint) {\n      return endPoint.replace(\"ws://\", \"http://\").replace(\"wss://\", \"https://\").replace(new RegExp(\"(.*)\\/\" + TRANSPORTS.websocket), \"$1/\" + TRANSPORTS.longpoll);\n    }\n  }, {\n    key: \"endpointURL\",\n    value: function endpointURL() {\n      return Ajax.appendParams(this.pollEndpoint, { token: this.token });\n    }\n  }, {\n    key: \"closeAndRetry\",\n    value: function closeAndRetry() {\n      this.close();\n      this.readyState = SOCKET_STATES.connecting;\n    }\n  }, {\n    key: \"ontimeout\",\n    value: function ontimeout() {\n      this.onerror(\"timeout\");\n      this.closeAndRetry();\n    }\n  }, {\n    key: \"poll\",\n    value: function poll() {\n      var _this8 = this;\n\n      if (!(this.readyState === SOCKET_STATES.open || this.readyState === SOCKET_STATES.connecting)) {\n        return;\n      }\n\n      Ajax.request(\"GET\", this.endpointURL(), \"application/json\", null, this.timeout, this.ontimeout.bind(this), function (resp) {\n        if (resp) {\n          var status = resp.status;\n          var token = resp.token;\n          var messages = resp.messages;\n\n          _this8.token = token;\n        } else {\n          var status = 0;\n        }\n\n        switch (status) {\n          case 200:\n            messages.forEach(function (msg) {\n              return _this8.onmessage({ data: JSON.stringify(msg) });\n            });\n            _this8.poll();\n            break;\n          case 204:\n            _this8.poll();\n            break;\n          case 410:\n            _this8.readyState = SOCKET_STATES.open;\n            _this8.onopen();\n            _this8.poll();\n            break;\n          case 0:\n          case 500:\n            _this8.onerror();\n            _this8.closeAndRetry();\n            break;\n          default:\n            throw \"unhandled poll status \" + status;\n        }\n      });\n    }\n  }, {\n    key: \"send\",\n    value: function send(body) {\n      var _this9 = this;\n\n      Ajax.request(\"POST\", this.endpointURL(), \"application/json\", body, this.timeout, this.onerror.bind(this, \"timeout\"), function (resp) {\n        if (!resp || resp.status !== 200) {\n          _this9.onerror(status);\n          _this9.closeAndRetry();\n        }\n      });\n    }\n  }, {\n    key: \"close\",\n    value: function close(code, reason) {\n      this.readyState = SOCKET_STATES.closed;\n      this.onclose();\n    }\n  }]);\n\n  return LongPoll;\n}();\n\nvar Ajax = exports.Ajax = function () {\n  function Ajax() {\n    _classCallCheck(this, Ajax);\n  }\n\n  _createClass(Ajax, null, [{\n    key: \"request\",\n    value: function request(method, endPoint, accept, body, timeout, ontimeout, callback) {\n      if (window.XDomainRequest) {\n        var req = new XDomainRequest(); // IE8, IE9\n        this.xdomainRequest(req, method, endPoint, body, timeout, ontimeout, callback);\n      } else {\n        var req = window.XMLHttpRequest ? new XMLHttpRequest() : // IE7+, Firefox, Chrome, Opera, Safari\n        new ActiveXObject(\"Microsoft.XMLHTTP\"); // IE6, IE5\n        this.xhrRequest(req, method, endPoint, accept, body, timeout, ontimeout, callback);\n      }\n    }\n  }, {\n    key: \"xdomainRequest\",\n    value: function xdomainRequest(req, method, endPoint, body, timeout, ontimeout, callback) {\n      var _this10 = this;\n\n      req.timeout = timeout;\n      req.open(method, endPoint);\n      req.onload = function () {\n        var response = _this10.parseJSON(req.responseText);\n        callback && callback(response);\n      };\n      if (ontimeout) {\n        req.ontimeout = ontimeout;\n      }\n\n      // Work around bug in IE9 that requires an attached onprogress handler\n      req.onprogress = function () {};\n\n      req.send(body);\n    }\n  }, {\n    key: \"xhrRequest\",\n    value: function xhrRequest(req, method, endPoint, accept, body, timeout, ontimeout, callback) {\n      var _this11 = this;\n\n      req.timeout = timeout;\n      req.open(method, endPoint, true);\n      req.setRequestHeader(\"Content-Type\", accept);\n      req.onerror = function () {\n        callback && callback(null);\n      };\n      req.onreadystatechange = function () {\n        if (req.readyState === _this11.states.complete && callback) {\n          var response = _this11.parseJSON(req.responseText);\n          callback(response);\n        }\n      };\n      if (ontimeout) {\n        req.ontimeout = ontimeout;\n      }\n\n      req.send(body);\n    }\n  }, {\n    key: \"parseJSON\",\n    value: function parseJSON(resp) {\n      return resp && resp !== \"\" ? JSON.parse(resp) : null;\n    }\n  }, {\n    key: \"serialize\",\n    value: function serialize(obj, parentKey) {\n      var queryStr = [];\n      for (var key in obj) {\n        if (!obj.hasOwnProperty(key)) {\n          continue;\n        }\n        var paramKey = parentKey ? parentKey + \"[\" + key + \"]\" : key;\n        var paramVal = obj[key];\n        if ((typeof paramVal === \"undefined\" ? \"undefined\" : _typeof(paramVal)) === \"object\") {\n          queryStr.push(this.serialize(paramVal, paramKey));\n        } else {\n          queryStr.push(encodeURIComponent(paramKey) + \"=\" + encodeURIComponent(paramVal));\n        }\n      }\n      return queryStr.join(\"&\");\n    }\n  }, {\n    key: \"appendParams\",\n    value: function appendParams(url, params) {\n      if (Object.keys(params).length === 0) {\n        return url;\n      }\n\n      var prefix = url.match(/\\?/) ? \"&\" : \"?\";\n      return \"\" + url + prefix + this.serialize(params);\n    }\n  }]);\n\n  return Ajax;\n}();\n\nAjax.states = { complete: 4 };\n\nvar Presence = exports.Presence = {\n  syncState: function syncState(currentState, newState, onJoin, onLeave) {\n    var _this12 = this;\n\n    var state = this.clone(currentState);\n    var joins = {};\n    var leaves = {};\n\n    this.map(state, function (key, presence) {\n      if (!newState[key]) {\n        leaves[key] = presence;\n      }\n    });\n    this.map(newState, function (key, newPresence) {\n      var currentPresence = state[key];\n      if (currentPresence) {\n        (function () {\n          var newRefs = newPresence.metas.map(function (m) {\n            return m.phx_ref;\n          });\n          var curRefs = currentPresence.metas.map(function (m) {\n            return m.phx_ref;\n          });\n          var joinedMetas = newPresence.metas.filter(function (m) {\n            return curRefs.indexOf(m.phx_ref) < 0;\n          });\n          var leftMetas = currentPresence.metas.filter(function (m) {\n            return newRefs.indexOf(m.phx_ref) < 0;\n          });\n          if (joinedMetas.length > 0) {\n            joins[key] = newPresence;\n            joins[key].metas = joinedMetas;\n          }\n          if (leftMetas.length > 0) {\n            leaves[key] = _this12.clone(currentPresence);\n            leaves[key].metas = leftMetas;\n          }\n        })();\n      } else {\n        joins[key] = newPresence;\n      }\n    });\n    return this.syncDiff(state, { joins: joins, leaves: leaves }, onJoin, onLeave);\n  },\n  syncDiff: function syncDiff(currentState, _ref2, onJoin, onLeave) {\n    var joins = _ref2.joins;\n    var leaves = _ref2.leaves;\n\n    var state = this.clone(currentState);\n    if (!onJoin) {\n      onJoin = function onJoin() {};\n    }\n    if (!onLeave) {\n      onLeave = function onLeave() {};\n    }\n\n    this.map(joins, function (key, newPresence) {\n      var currentPresence = state[key];\n      state[key] = newPresence;\n      if (currentPresence) {\n        var _state$key$metas;\n\n        (_state$key$metas = state[key].metas).unshift.apply(_state$key$metas, _toConsumableArray(currentPresence.metas));\n      }\n      onJoin(key, currentPresence, newPresence);\n    });\n    this.map(leaves, function (key, leftPresence) {\n      var currentPresence = state[key];\n      if (!currentPresence) {\n        return;\n      }\n      var refsToRemove = leftPresence.metas.map(function (m) {\n        return m.phx_ref;\n      });\n      currentPresence.metas = currentPresence.metas.filter(function (p) {\n        return refsToRemove.indexOf(p.phx_ref) < 0;\n      });\n      onLeave(key, currentPresence, leftPresence);\n      if (currentPresence.metas.length === 0) {\n        delete state[key];\n      }\n    });\n    return state;\n  },\n  list: function list(presences, chooser) {\n    if (!chooser) {\n      chooser = function chooser(key, pres) {\n        return pres;\n      };\n    }\n\n    return this.map(presences, function (key, presence) {\n      return chooser(key, presence);\n    });\n  },\n\n  // private\n\n  map: function map(obj, func) {\n    return Object.getOwnPropertyNames(obj).map(function (key) {\n      return func(key, obj[key]);\n    });\n  },\n  clone: function clone(obj) {\n    return JSON.parse(JSON.stringify(obj));\n  }\n};\n\n// Creates a timer that accepts a `timerCalc` function to perform\n// calculated timeout retries, such as exponential backoff.\n//\n// ## Examples\n//\n//    let reconnectTimer = new Timer(() => this.connect(), function(tries){\n//      return [1000, 5000, 10000][tries - 1] || 10000\n//    })\n//    reconnectTimer.scheduleTimeout() // fires after 1000\n//    reconnectTimer.scheduleTimeout() // fires after 5000\n//    reconnectTimer.reset()\n//    reconnectTimer.scheduleTimeout() // fires after 1000\n//\n\nvar Timer = function () {\n  function Timer(callback, timerCalc) {\n    _classCallCheck(this, Timer);\n\n    this.callback = callback;\n    this.timerCalc = timerCalc;\n    this.timer = null;\n    this.tries = 0;\n  }\n\n  _createClass(Timer, [{\n    key: \"reset\",\n    value: function reset() {\n      this.tries = 0;\n      clearTimeout(this.timer);\n    }\n\n    // Cancels any previous scheduleTimeout and schedules callback\n\n  }, {\n    key: \"scheduleTimeout\",\n    value: function scheduleTimeout() {\n      var _this13 = this;\n\n      clearTimeout(this.timer);\n\n      this.timer = setTimeout(function () {\n        _this13.tries = _this13.tries + 1;\n        _this13.callback();\n      }, this.timerCalc(this.tries + 1));\n    }\n  }]);\n\n  return Timer;\n}();\n\n})(typeof(exports) === \"undefined\" ? window.Phoenix = window.Phoenix || {} : exports);\n  })();\n});","\nrequire.register(\"phoenix_html/priv/static/phoenix_html.js\", function(exports, require, module) {\n  require = __makeRelativeRequire(require, {}, \"phoenix_html\");\n  (function() {\n    'use strict';\n\nfunction isLinkToSubmitParent(element) {\n  var isLinkTag = element.tagName === 'A';\n  var shouldSubmitParent = element.getAttribute('data-submit') === 'parent';\n\n  return isLinkTag && shouldSubmitParent;\n}\n\nfunction didHandleSubmitLinkClick(element) {\n  while (element && element.getAttribute) {\n    if (isLinkToSubmitParent(element)) {\n      var message = element.getAttribute('data-confirm');\n      if (message === null || confirm(message)) {\n        element.parentNode.submit();\n      };\n      return true;\n    } else {\n      element = element.parentNode;\n    }\n  }\n  return false;\n}\n\n// for links with HTTP methods other than GET\nwindow.addEventListener('click', function (event) {\n  if (event.target && didHandleSubmitLinkClick(event.target)) {\n    event.preventDefault();\n    return false;\n  }\n}, false);\n  })();\n});","/**\r\n * jscolor - JavaScript Color Picker\r\n *\r\n * @link    http://jscolor.com\r\n * @license For open source use: GPLv3\r\n *          For commercial use: JSColor Commercial License\r\n * @author  Jan Odvarko\r\n * @version 2.0.4\r\n *\r\n * See usage examples at http://jscolor.com/examples/\r\n */\r\n\r\n\r\n\"use strict\";\r\n\r\n\r\nif (!window.jscolor) { window.jscolor = (function () {\r\n\r\n\r\nvar jsc = {\r\n\r\n\r\n\tregister : function () {\r\n\t\tjsc.attachDOMReadyEvent(jsc.init);\r\n\t\tjsc.attachEvent(document, 'mousedown', jsc.onDocumentMouseDown);\r\n\t\tjsc.attachEvent(document, 'touchstart', jsc.onDocumentTouchStart);\r\n\t\tjsc.attachEvent(window, 'resize', jsc.onWindowResize);\r\n\t},\r\n\r\n\r\n\tinit : function () {\r\n\t\tif (jsc.jscolor.lookupClass) {\r\n\t\t\tjsc.jscolor.installByClassName(jsc.jscolor.lookupClass);\r\n\t\t}\r\n\t},\r\n\r\n\r\n\ttryInstallOnElements : function (elms, className) {\r\n\t\tvar matchClass = new RegExp('(^|\\\\s)(' + className + ')(\\\\s*(\\\\{[^}]*\\\\})|\\\\s|$)', 'i');\r\n\r\n\t\tfor (var i = 0; i < elms.length; i += 1) {\r\n\t\t\tif (elms[i].type !== undefined && elms[i].type.toLowerCase() == 'color') {\r\n\t\t\t\tif (jsc.isColorAttrSupported) {\r\n\t\t\t\t\t// skip inputs of type 'color' if supported by the browser\r\n\t\t\t\t\tcontinue;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tvar m;\r\n\t\t\tif (!elms[i].jscolor && elms[i].className && (m = elms[i].className.match(matchClass))) {\r\n\t\t\t\tvar targetElm = elms[i];\r\n\t\t\t\tvar optsStr = null;\r\n\r\n\t\t\t\tvar dataOptions = jsc.getDataAttr(targetElm, 'jscolor');\r\n\t\t\t\tif (dataOptions !== null) {\r\n\t\t\t\t\toptsStr = dataOptions;\r\n\t\t\t\t} else if (m[4]) {\r\n\t\t\t\t\toptsStr = m[4];\r\n\t\t\t\t}\r\n\r\n\t\t\t\tvar opts = {};\r\n\t\t\t\tif (optsStr) {\r\n\t\t\t\t\ttry {\r\n\t\t\t\t\t\topts = (new Function ('return (' + optsStr + ')'))();\r\n\t\t\t\t\t} catch(eParseError) {\r\n\t\t\t\t\t\tjsc.warn('Error parsing jscolor options: ' + eParseError + ':\\n' + optsStr);\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\ttargetElm.jscolor = new jsc.jscolor(targetElm, opts);\r\n\t\t\t}\r\n\t\t}\r\n\t},\r\n\r\n\r\n\tisColorAttrSupported : (function () {\r\n\t\tvar elm = document.createElement('input');\r\n\t\tif (elm.setAttribute) {\r\n\t\t\telm.setAttribute('type', 'color');\r\n\t\t\tif (elm.type.toLowerCase() == 'color') {\r\n\t\t\t\treturn true;\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn false;\r\n\t})(),\r\n\r\n\r\n\tisCanvasSupported : (function () {\r\n\t\tvar elm = document.createElement('canvas');\r\n\t\treturn !!(elm.getContext && elm.getContext('2d'));\r\n\t})(),\r\n\r\n\r\n\tfetchElement : function (mixed) {\r\n\t\treturn typeof mixed === 'string' ? document.getElementById(mixed) : mixed;\r\n\t},\r\n\r\n\r\n\tisElementType : function (elm, type) {\r\n\t\treturn elm.nodeName.toLowerCase() === type.toLowerCase();\r\n\t},\r\n\r\n\r\n\tgetDataAttr : function (el, name) {\r\n\t\tvar attrName = 'data-' + name;\r\n\t\tvar attrValue = el.getAttribute(attrName);\r\n\t\tif (attrValue !== null) {\r\n\t\t\treturn attrValue;\r\n\t\t}\r\n\t\treturn null;\r\n\t},\r\n\r\n\r\n\tattachEvent : function (el, evnt, func) {\r\n\t\tif (el.addEventListener) {\r\n\t\t\tel.addEventListener(evnt, func, false);\r\n\t\t} else if (el.attachEvent) {\r\n\t\t\tel.attachEvent('on' + evnt, func);\r\n\t\t}\r\n\t},\r\n\r\n\r\n\tdetachEvent : function (el, evnt, func) {\r\n\t\tif (el.removeEventListener) {\r\n\t\t\tel.removeEventListener(evnt, func, false);\r\n\t\t} else if (el.detachEvent) {\r\n\t\t\tel.detachEvent('on' + evnt, func);\r\n\t\t}\r\n\t},\r\n\r\n\r\n\t_attachedGroupEvents : {},\r\n\r\n\r\n\tattachGroupEvent : function (groupName, el, evnt, func) {\r\n\t\tif (!jsc._attachedGroupEvents.hasOwnProperty(groupName)) {\r\n\t\t\tjsc._attachedGroupEvents[groupName] = [];\r\n\t\t}\r\n\t\tjsc._attachedGroupEvents[groupName].push([el, evnt, func]);\r\n\t\tjsc.attachEvent(el, evnt, func);\r\n\t},\r\n\r\n\r\n\tdetachGroupEvents : function (groupName) {\r\n\t\tif (jsc._attachedGroupEvents.hasOwnProperty(groupName)) {\r\n\t\t\tfor (var i = 0; i < jsc._attachedGroupEvents[groupName].length; i += 1) {\r\n\t\t\t\tvar evt = jsc._attachedGroupEvents[groupName][i];\r\n\t\t\t\tjsc.detachEvent(evt[0], evt[1], evt[2]);\r\n\t\t\t}\r\n\t\t\tdelete jsc._attachedGroupEvents[groupName];\r\n\t\t}\r\n\t},\r\n\r\n\r\n\tattachDOMReadyEvent : function (func) {\r\n\t\tvar fired = false;\r\n\t\tvar fireOnce = function () {\r\n\t\t\tif (!fired) {\r\n\t\t\t\tfired = true;\r\n\t\t\t\tfunc();\r\n\t\t\t}\r\n\t\t};\r\n\r\n\t\tif (document.readyState === 'complete') {\r\n\t\t\tsetTimeout(fireOnce, 1); // async\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tif (document.addEventListener) {\r\n\t\t\tdocument.addEventListener('DOMContentLoaded', fireOnce, false);\r\n\r\n\t\t\t// Fallback\r\n\t\t\twindow.addEventListener('load', fireOnce, false);\r\n\r\n\t\t} else if (document.attachEvent) {\r\n\t\t\t// IE\r\n\t\t\tdocument.attachEvent('onreadystatechange', function () {\r\n\t\t\t\tif (document.readyState === 'complete') {\r\n\t\t\t\t\tdocument.detachEvent('onreadystatechange', arguments.callee);\r\n\t\t\t\t\tfireOnce();\r\n\t\t\t\t}\r\n\t\t\t})\r\n\r\n\t\t\t// Fallback\r\n\t\t\twindow.attachEvent('onload', fireOnce);\r\n\r\n\t\t\t// IE7/8\r\n\t\t\tif (document.documentElement.doScroll && window == window.top) {\r\n\t\t\t\tvar tryScroll = function () {\r\n\t\t\t\t\tif (!document.body) { return; }\r\n\t\t\t\t\ttry {\r\n\t\t\t\t\t\tdocument.documentElement.doScroll('left');\r\n\t\t\t\t\t\tfireOnce();\r\n\t\t\t\t\t} catch (e) {\r\n\t\t\t\t\t\tsetTimeout(tryScroll, 1);\r\n\t\t\t\t\t}\r\n\t\t\t\t};\r\n\t\t\t\ttryScroll();\r\n\t\t\t}\r\n\t\t}\r\n\t},\r\n\r\n\r\n\twarn : function (msg) {\r\n\t\tif (window.console && window.console.warn) {\r\n\t\t\twindow.console.warn(msg);\r\n\t\t}\r\n\t},\r\n\r\n\r\n\tpreventDefault : function (e) {\r\n\t\tif (e.preventDefault) { e.preventDefault(); }\r\n\t\te.returnValue = false;\r\n\t},\r\n\r\n\r\n\tcaptureTarget : function (target) {\r\n\t\t// IE\r\n\t\tif (target.setCapture) {\r\n\t\t\tjsc._capturedTarget = target;\r\n\t\t\tjsc._capturedTarget.setCapture();\r\n\t\t}\r\n\t},\r\n\r\n\r\n\treleaseTarget : function () {\r\n\t\t// IE\r\n\t\tif (jsc._capturedTarget) {\r\n\t\t\tjsc._capturedTarget.releaseCapture();\r\n\t\t\tjsc._capturedTarget = null;\r\n\t\t}\r\n\t},\r\n\r\n\r\n\tfireEvent : function (el, evnt) {\r\n\t\tif (!el) {\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tif (document.createEvent) {\r\n\t\t\tvar ev = document.createEvent('HTMLEvents');\r\n\t\t\tev.initEvent(evnt, true, true);\r\n\t\t\tel.dispatchEvent(ev);\r\n\t\t} else if (document.createEventObject) {\r\n\t\t\tvar ev = document.createEventObject();\r\n\t\t\tel.fireEvent('on' + evnt, ev);\r\n\t\t} else if (el['on' + evnt]) { // alternatively use the traditional event model\r\n\t\t\tel['on' + evnt]();\r\n\t\t}\r\n\t},\r\n\r\n\r\n\tclassNameToList : function (className) {\r\n\t\treturn className.replace(/^\\s+|\\s+$/g, '').split(/\\s+/);\r\n\t},\r\n\r\n\r\n\t// The className parameter (str) can only contain a single class name\r\n\thasClass : function (elm, className) {\r\n\t\tif (!className) {\r\n\t\t\treturn false;\r\n\t\t}\r\n\t\treturn -1 != (' ' + elm.className.replace(/\\s+/g, ' ') + ' ').indexOf(' ' + className + ' ');\r\n\t},\r\n\r\n\r\n\t// The className parameter (str) can contain multiple class names separated by whitespace\r\n\tsetClass : function (elm, className) {\r\n\t\tvar classList = jsc.classNameToList(className);\r\n\t\tfor (var i = 0; i < classList.length; i += 1) {\r\n\t\t\tif (!jsc.hasClass(elm, classList[i])) {\r\n\t\t\t\telm.className += (elm.className ? ' ' : '') + classList[i];\r\n\t\t\t}\r\n\t\t}\r\n\t},\r\n\r\n\r\n\t// The className parameter (str) can contain multiple class names separated by whitespace\r\n\tunsetClass : function (elm, className) {\r\n\t\tvar classList = jsc.classNameToList(className);\r\n\t\tfor (var i = 0; i < classList.length; i += 1) {\r\n\t\t\tvar repl = new RegExp(\r\n\t\t\t\t'^\\\\s*' + classList[i] + '\\\\s*|' +\r\n\t\t\t\t'\\\\s*' + classList[i] + '\\\\s*$|' +\r\n\t\t\t\t'\\\\s+' + classList[i] + '(\\\\s+)',\r\n\t\t\t\t'g'\r\n\t\t\t);\r\n\t\t\telm.className = elm.className.replace(repl, '$1');\r\n\t\t}\r\n\t},\r\n\r\n\r\n\tgetStyle : function (elm) {\r\n\t\treturn window.getComputedStyle ? window.getComputedStyle(elm) : elm.currentStyle;\r\n\t},\r\n\r\n\r\n\tsetStyle : (function () {\r\n\t\tvar helper = document.createElement('div');\r\n\t\tvar getSupportedProp = function (names) {\r\n\t\t\tfor (var i = 0; i < names.length; i += 1) {\r\n\t\t\t\tif (names[i] in helper.style) {\r\n\t\t\t\t\treturn names[i];\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t};\r\n\t\tvar props = {\r\n\t\t\tborderRadius: getSupportedProp(['borderRadius', 'MozBorderRadius', 'webkitBorderRadius']),\r\n\t\t\tboxShadow: getSupportedProp(['boxShadow', 'MozBoxShadow', 'webkitBoxShadow'])\r\n\t\t};\r\n\t\treturn function (elm, prop, value) {\r\n\t\t\tswitch (prop.toLowerCase()) {\r\n\t\t\tcase 'opacity':\r\n\t\t\t\tvar alphaOpacity = Math.round(parseFloat(value) * 100);\r\n\t\t\t\telm.style.opacity = value;\r\n\t\t\t\telm.style.filter = 'alpha(opacity=' + alphaOpacity + ')';\r\n\t\t\t\tbreak;\r\n\t\t\tdefault:\r\n\t\t\t\telm.style[props[prop]] = value;\r\n\t\t\t\tbreak;\r\n\t\t\t}\r\n\t\t};\r\n\t})(),\r\n\r\n\r\n\tsetBorderRadius : function (elm, value) {\r\n\t\tjsc.setStyle(elm, 'borderRadius', value || '0');\r\n\t},\r\n\r\n\r\n\tsetBoxShadow : function (elm, value) {\r\n\t\tjsc.setStyle(elm, 'boxShadow', value || 'none');\r\n\t},\r\n\r\n\r\n\tgetElementPos : function (e, relativeToViewport) {\r\n\t\tvar x=0, y=0;\r\n\t\tvar rect = e.getBoundingClientRect();\r\n\t\tx = rect.left;\r\n\t\ty = rect.top;\r\n\t\tif (!relativeToViewport) {\r\n\t\t\tvar viewPos = jsc.getViewPos();\r\n\t\t\tx += viewPos[0];\r\n\t\t\ty += viewPos[1];\r\n\t\t}\r\n\t\treturn [x, y];\r\n\t},\r\n\r\n\r\n\tgetElementSize : function (e) {\r\n\t\treturn [e.offsetWidth, e.offsetHeight];\r\n\t},\r\n\r\n\r\n\t// get pointer's X/Y coordinates relative to viewport\r\n\tgetAbsPointerPos : function (e) {\r\n\t\tif (!e) { e = window.event; }\r\n\t\tvar x = 0, y = 0;\r\n\t\tif (typeof e.changedTouches !== 'undefined' && e.changedTouches.length) {\r\n\t\t\t// touch devices\r\n\t\t\tx = e.changedTouches[0].clientX;\r\n\t\t\ty = e.changedTouches[0].clientY;\r\n\t\t} else if (typeof e.clientX === 'number') {\r\n\t\t\tx = e.clientX;\r\n\t\t\ty = e.clientY;\r\n\t\t}\r\n\t\treturn { x: x, y: y };\r\n\t},\r\n\r\n\r\n\t// get pointer's X/Y coordinates relative to target element\r\n\tgetRelPointerPos : function (e) {\r\n\t\tif (!e) { e = window.event; }\r\n\t\tvar target = e.target || e.srcElement;\r\n\t\tvar targetRect = target.getBoundingClientRect();\r\n\r\n\t\tvar x = 0, y = 0;\r\n\r\n\t\tvar clientX = 0, clientY = 0;\r\n\t\tif (typeof e.changedTouches !== 'undefined' && e.changedTouches.length) {\r\n\t\t\t// touch devices\r\n\t\t\tclientX = e.changedTouches[0].clientX;\r\n\t\t\tclientY = e.changedTouches[0].clientY;\r\n\t\t} else if (typeof e.clientX === 'number') {\r\n\t\t\tclientX = e.clientX;\r\n\t\t\tclientY = e.clientY;\r\n\t\t}\r\n\r\n\t\tx = clientX - targetRect.left;\r\n\t\ty = clientY - targetRect.top;\r\n\t\treturn { x: x, y: y };\r\n\t},\r\n\r\n\r\n\tgetViewPos : function () {\r\n\t\tvar doc = document.documentElement;\r\n\t\treturn [\r\n\t\t\t(window.pageXOffset || doc.scrollLeft) - (doc.clientLeft || 0),\r\n\t\t\t(window.pageYOffset || doc.scrollTop) - (doc.clientTop || 0)\r\n\t\t];\r\n\t},\r\n\r\n\r\n\tgetViewSize : function () {\r\n\t\tvar doc = document.documentElement;\r\n\t\treturn [\r\n\t\t\t(window.innerWidth || doc.clientWidth),\r\n\t\t\t(window.innerHeight || doc.clientHeight),\r\n\t\t];\r\n\t},\r\n\r\n\r\n\tredrawPosition : function () {\r\n\r\n\t\tif (jsc.picker && jsc.picker.owner) {\r\n\t\t\tvar thisObj = jsc.picker.owner;\r\n\r\n\t\t\tvar tp, vp;\r\n\r\n\t\t\tif (thisObj.fixed) {\r\n\t\t\t\t// Fixed elements are positioned relative to viewport,\r\n\t\t\t\t// therefore we can ignore the scroll offset\r\n\t\t\t\ttp = jsc.getElementPos(thisObj.targetElement, true); // target pos\r\n\t\t\t\tvp = [0, 0]; // view pos\r\n\t\t\t} else {\r\n\t\t\t\ttp = jsc.getElementPos(thisObj.targetElement); // target pos\r\n\t\t\t\tvp = jsc.getViewPos(); // view pos\r\n\t\t\t}\r\n\r\n\t\t\tvar ts = jsc.getElementSize(thisObj.targetElement); // target size\r\n\t\t\tvar vs = jsc.getViewSize(); // view size\r\n\t\t\tvar ps = jsc.getPickerOuterDims(thisObj); // picker size\r\n\t\t\tvar a, b, c;\r\n\t\t\tswitch (thisObj.position.toLowerCase()) {\r\n\t\t\t\tcase 'left': a=1; b=0; c=-1; break;\r\n\t\t\t\tcase 'right':a=1; b=0; c=1; break;\r\n\t\t\t\tcase 'top':  a=0; b=1; c=-1; break;\r\n\t\t\t\tdefault:     a=0; b=1; c=1; break;\r\n\t\t\t}\r\n\t\t\tvar l = (ts[b]+ps[b])/2;\r\n\r\n\t\t\t// compute picker position\r\n\t\t\tif (!thisObj.smartPosition) {\r\n\t\t\t\tvar pp = [\r\n\t\t\t\t\ttp[a],\r\n\t\t\t\t\ttp[b]+ts[b]-l+l*c\r\n\t\t\t\t];\r\n\t\t\t} else {\r\n\t\t\t\tvar pp = [\r\n\t\t\t\t\t-vp[a]+tp[a]+ps[a] > vs[a] ?\r\n\t\t\t\t\t\t(-vp[a]+tp[a]+ts[a]/2 > vs[a]/2 && tp[a]+ts[a]-ps[a] >= 0 ? tp[a]+ts[a]-ps[a] : tp[a]) :\r\n\t\t\t\t\t\ttp[a],\r\n\t\t\t\t\t-vp[b]+tp[b]+ts[b]+ps[b]-l+l*c > vs[b] ?\r\n\t\t\t\t\t\t(-vp[b]+tp[b]+ts[b]/2 > vs[b]/2 && tp[b]+ts[b]-l-l*c >= 0 ? tp[b]+ts[b]-l-l*c : tp[b]+ts[b]-l+l*c) :\r\n\t\t\t\t\t\t(tp[b]+ts[b]-l+l*c >= 0 ? tp[b]+ts[b]-l+l*c : tp[b]+ts[b]-l-l*c)\r\n\t\t\t\t];\r\n\t\t\t}\r\n\r\n\t\t\tvar x = pp[a];\r\n\t\t\tvar y = pp[b];\r\n\t\t\tvar positionValue = thisObj.fixed ? 'fixed' : 'absolute';\r\n\t\t\tvar contractShadow =\r\n\t\t\t\t(pp[0] + ps[0] > tp[0] || pp[0] < tp[0] + ts[0]) &&\r\n\t\t\t\t(pp[1] + ps[1] < tp[1] + ts[1]);\r\n\r\n\t\t\tjsc._drawPosition(thisObj, x, y, positionValue, contractShadow);\r\n\t\t}\r\n\t},\r\n\r\n\r\n\t_drawPosition : function (thisObj, x, y, positionValue, contractShadow) {\r\n\t\tvar vShadow = contractShadow ? 0 : thisObj.shadowBlur; // px\r\n\r\n\t\tjsc.picker.wrap.style.position = positionValue;\r\n\t\tjsc.picker.wrap.style.left = x + 'px';\r\n\t\tjsc.picker.wrap.style.top = y + 'px';\r\n\r\n\t\tjsc.setBoxShadow(\r\n\t\t\tjsc.picker.boxS,\r\n\t\t\tthisObj.shadow ?\r\n\t\t\t\tnew jsc.BoxShadow(0, vShadow, thisObj.shadowBlur, 0, thisObj.shadowColor) :\r\n\t\t\t\tnull);\r\n\t},\r\n\r\n\r\n\tgetPickerDims : function (thisObj) {\r\n\t\tvar displaySlider = !!jsc.getSliderComponent(thisObj);\r\n\t\tvar dims = [\r\n\t\t\t2 * thisObj.insetWidth + 2 * thisObj.padding + thisObj.width +\r\n\t\t\t\t(displaySlider ? 2 * thisObj.insetWidth + jsc.getPadToSliderPadding(thisObj) + thisObj.sliderSize : 0),\r\n\t\t\t2 * thisObj.insetWidth + 2 * thisObj.padding + thisObj.height +\r\n\t\t\t\t(thisObj.closable ? 2 * thisObj.insetWidth + thisObj.padding + thisObj.buttonHeight : 0)\r\n\t\t];\r\n\t\treturn dims;\r\n\t},\r\n\r\n\r\n\tgetPickerOuterDims : function (thisObj) {\r\n\t\tvar dims = jsc.getPickerDims(thisObj);\r\n\t\treturn [\r\n\t\t\tdims[0] + 2 * thisObj.borderWidth,\r\n\t\t\tdims[1] + 2 * thisObj.borderWidth\r\n\t\t];\r\n\t},\r\n\r\n\r\n\tgetPadToSliderPadding : function (thisObj) {\r\n\t\treturn Math.max(thisObj.padding, 1.5 * (2 * thisObj.pointerBorderWidth + thisObj.pointerThickness));\r\n\t},\r\n\r\n\r\n\tgetPadYComponent : function (thisObj) {\r\n\t\tswitch (thisObj.mode.charAt(1).toLowerCase()) {\r\n\t\t\tcase 'v': return 'v'; break;\r\n\t\t}\r\n\t\treturn 's';\r\n\t},\r\n\r\n\r\n\tgetSliderComponent : function (thisObj) {\r\n\t\tif (thisObj.mode.length > 2) {\r\n\t\t\tswitch (thisObj.mode.charAt(2).toLowerCase()) {\r\n\t\t\t\tcase 's': return 's'; break;\r\n\t\t\t\tcase 'v': return 'v'; break;\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn null;\r\n\t},\r\n\r\n\r\n\tonDocumentMouseDown : function (e) {\r\n\t\tif (!e) { e = window.event; }\r\n\t\tvar target = e.target || e.srcElement;\r\n\r\n\t\tif (target._jscLinkedInstance) {\r\n\t\t\tif (target._jscLinkedInstance.showOnClick) {\r\n\t\t\t\ttarget._jscLinkedInstance.show();\r\n\t\t\t}\r\n\t\t} else if (target._jscControlName) {\r\n\t\t\tjsc.onControlPointerStart(e, target, target._jscControlName, 'mouse');\r\n\t\t} else {\r\n\t\t\t// Mouse is outside the picker controls -> hide the color picker!\r\n\t\t\tif (jsc.picker && jsc.picker.owner) {\r\n\t\t\t\tjsc.picker.owner.hide();\r\n\t\t\t}\r\n\t\t}\r\n\t},\r\n\r\n\r\n\tonDocumentTouchStart : function (e) {\r\n\t\tif (!e) { e = window.event; }\r\n\t\tvar target = e.target || e.srcElement;\r\n\r\n\t\tif (target._jscLinkedInstance) {\r\n\t\t\tif (target._jscLinkedInstance.showOnClick) {\r\n\t\t\t\ttarget._jscLinkedInstance.show();\r\n\t\t\t}\r\n\t\t} else if (target._jscControlName) {\r\n\t\t\tjsc.onControlPointerStart(e, target, target._jscControlName, 'touch');\r\n\t\t} else {\r\n\t\t\tif (jsc.picker && jsc.picker.owner) {\r\n\t\t\t\tjsc.picker.owner.hide();\r\n\t\t\t}\r\n\t\t}\r\n\t},\r\n\r\n\r\n\tonWindowResize : function (e) {\r\n\t\tjsc.redrawPosition();\r\n\t},\r\n\r\n\r\n\tonParentScroll : function (e) {\r\n\t\t// hide the picker when one of the parent elements is scrolled\r\n\t\tif (jsc.picker && jsc.picker.owner) {\r\n\t\t\tjsc.picker.owner.hide();\r\n\t\t}\r\n\t},\r\n\r\n\r\n\t_pointerMoveEvent : {\r\n\t\tmouse: 'mousemove',\r\n\t\ttouch: 'touchmove'\r\n\t},\r\n\t_pointerEndEvent : {\r\n\t\tmouse: 'mouseup',\r\n\t\ttouch: 'touchend'\r\n\t},\r\n\r\n\r\n\t_pointerOrigin : null,\r\n\t_capturedTarget : null,\r\n\r\n\r\n\tonControlPointerStart : function (e, target, controlName, pointerType) {\r\n\t\tvar thisObj = target._jscInstance;\r\n\r\n\t\tjsc.preventDefault(e);\r\n\t\tjsc.captureTarget(target);\r\n\r\n\t\tvar registerDragEvents = function (doc, offset) {\r\n\t\t\tjsc.attachGroupEvent('drag', doc, jsc._pointerMoveEvent[pointerType],\r\n\t\t\t\tjsc.onDocumentPointerMove(e, target, controlName, pointerType, offset));\r\n\t\t\tjsc.attachGroupEvent('drag', doc, jsc._pointerEndEvent[pointerType],\r\n\t\t\t\tjsc.onDocumentPointerEnd(e, target, controlName, pointerType));\r\n\t\t};\r\n\r\n\t\tregisterDragEvents(document, [0, 0]);\r\n\r\n\t\tif (window.parent && window.frameElement) {\r\n\t\t\tvar rect = window.frameElement.getBoundingClientRect();\r\n\t\t\tvar ofs = [-rect.left, -rect.top];\r\n\t\t\tregisterDragEvents(window.parent.window.document, ofs);\r\n\t\t}\r\n\r\n\t\tvar abs = jsc.getAbsPointerPos(e);\r\n\t\tvar rel = jsc.getRelPointerPos(e);\r\n\t\tjsc._pointerOrigin = {\r\n\t\t\tx: abs.x - rel.x,\r\n\t\t\ty: abs.y - rel.y\r\n\t\t};\r\n\r\n\t\tswitch (controlName) {\r\n\t\tcase 'pad':\r\n\t\t\t// if the slider is at the bottom, move it up\r\n\t\t\tswitch (jsc.getSliderComponent(thisObj)) {\r\n\t\t\tcase 's': if (thisObj.hsv[1] === 0) { thisObj.fromHSV(null, 100, null); }; break;\r\n\t\t\tcase 'v': if (thisObj.hsv[2] === 0) { thisObj.fromHSV(null, null, 100); }; break;\r\n\t\t\t}\r\n\t\t\tjsc.setPad(thisObj, e, 0, 0);\r\n\t\t\tbreak;\r\n\r\n\t\tcase 'sld':\r\n\t\t\tjsc.setSld(thisObj, e, 0);\r\n\t\t\tbreak;\r\n\t\t}\r\n\r\n\t\tjsc.dispatchFineChange(thisObj);\r\n\t},\r\n\r\n\r\n\tonDocumentPointerMove : function (e, target, controlName, pointerType, offset) {\r\n\t\treturn function (e) {\r\n\t\t\tvar thisObj = target._jscInstance;\r\n\t\t\tswitch (controlName) {\r\n\t\t\tcase 'pad':\r\n\t\t\t\tif (!e) { e = window.event; }\r\n\t\t\t\tjsc.setPad(thisObj, e, offset[0], offset[1]);\r\n\t\t\t\tjsc.dispatchFineChange(thisObj);\r\n\t\t\t\tbreak;\r\n\r\n\t\t\tcase 'sld':\r\n\t\t\t\tif (!e) { e = window.event; }\r\n\t\t\t\tjsc.setSld(thisObj, e, offset[1]);\r\n\t\t\t\tjsc.dispatchFineChange(thisObj);\r\n\t\t\t\tbreak;\r\n\t\t\t}\r\n\t\t}\r\n\t},\r\n\r\n\r\n\tonDocumentPointerEnd : function (e, target, controlName, pointerType) {\r\n\t\treturn function (e) {\r\n\t\t\tvar thisObj = target._jscInstance;\r\n\t\t\tjsc.detachGroupEvents('drag');\r\n\t\t\tjsc.releaseTarget();\r\n\t\t\t// Always dispatch changes after detaching outstanding mouse handlers,\r\n\t\t\t// in case some user interaction will occur in user's onchange callback\r\n\t\t\t// that would intrude with current mouse events\r\n\t\t\tjsc.dispatchChange(thisObj);\r\n\t\t};\r\n\t},\r\n\r\n\r\n\tdispatchChange : function (thisObj) {\r\n\t\tif (thisObj.valueElement) {\r\n\t\t\tif (jsc.isElementType(thisObj.valueElement, 'input')) {\r\n\t\t\t\tjsc.fireEvent(thisObj.valueElement, 'change');\r\n\t\t\t}\r\n\t\t}\r\n\t},\r\n\r\n\r\n\tdispatchFineChange : function (thisObj) {\r\n\t\tif (thisObj.onFineChange) {\r\n\t\t\tvar callback;\r\n\t\t\tif (typeof thisObj.onFineChange === 'string') {\r\n\t\t\t\tcallback = new Function (thisObj.onFineChange);\r\n\t\t\t} else {\r\n\t\t\t\tcallback = thisObj.onFineChange;\r\n\t\t\t}\r\n\t\t\tcallback.call(thisObj);\r\n\t\t}\r\n\t},\r\n\r\n\r\n\tsetPad : function (thisObj, e, ofsX, ofsY) {\r\n\t\tvar pointerAbs = jsc.getAbsPointerPos(e);\r\n\t\tvar x = ofsX + pointerAbs.x - jsc._pointerOrigin.x - thisObj.padding - thisObj.insetWidth;\r\n\t\tvar y = ofsY + pointerAbs.y - jsc._pointerOrigin.y - thisObj.padding - thisObj.insetWidth;\r\n\r\n\t\tvar xVal = x * (360 / (thisObj.width - 1));\r\n\t\tvar yVal = 100 - (y * (100 / (thisObj.height - 1)));\r\n\r\n\t\tswitch (jsc.getPadYComponent(thisObj)) {\r\n\t\tcase 's': thisObj.fromHSV(xVal, yVal, null, jsc.leaveSld); break;\r\n\t\tcase 'v': thisObj.fromHSV(xVal, null, yVal, jsc.leaveSld); break;\r\n\t\t}\r\n\t},\r\n\r\n\r\n\tsetSld : function (thisObj, e, ofsY) {\r\n\t\tvar pointerAbs = jsc.getAbsPointerPos(e);\r\n\t\tvar y = ofsY + pointerAbs.y - jsc._pointerOrigin.y - thisObj.padding - thisObj.insetWidth;\r\n\r\n\t\tvar yVal = 100 - (y * (100 / (thisObj.height - 1)));\r\n\r\n\t\tswitch (jsc.getSliderComponent(thisObj)) {\r\n\t\tcase 's': thisObj.fromHSV(null, yVal, null, jsc.leavePad); break;\r\n\t\tcase 'v': thisObj.fromHSV(null, null, yVal, jsc.leavePad); break;\r\n\t\t}\r\n\t},\r\n\r\n\r\n\t_vmlNS : 'jsc_vml_',\r\n\t_vmlCSS : 'jsc_vml_css_',\r\n\t_vmlReady : false,\r\n\r\n\r\n\tinitVML : function () {\r\n\t\tif (!jsc._vmlReady) {\r\n\t\t\t// init VML namespace\r\n\t\t\tvar doc = document;\r\n\t\t\tif (!doc.namespaces[jsc._vmlNS]) {\r\n\t\t\t\tdoc.namespaces.add(jsc._vmlNS, 'urn:schemas-microsoft-com:vml');\r\n\t\t\t}\r\n\t\t\tif (!doc.styleSheets[jsc._vmlCSS]) {\r\n\t\t\t\tvar tags = ['shape', 'shapetype', 'group', 'background', 'path', 'formulas', 'handles', 'fill', 'stroke', 'shadow', 'textbox', 'textpath', 'imagedata', 'line', 'polyline', 'curve', 'rect', 'roundrect', 'oval', 'arc', 'image'];\r\n\t\t\t\tvar ss = doc.createStyleSheet();\r\n\t\t\t\tss.owningElement.id = jsc._vmlCSS;\r\n\t\t\t\tfor (var i = 0; i < tags.length; i += 1) {\r\n\t\t\t\t\tss.addRule(jsc._vmlNS + '\\\\:' + tags[i], 'behavior:url(#default#VML);');\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tjsc._vmlReady = true;\r\n\t\t}\r\n\t},\r\n\r\n\r\n\tcreatePalette : function () {\r\n\r\n\t\tvar paletteObj = {\r\n\t\t\telm: null,\r\n\t\t\tdraw: null\r\n\t\t};\r\n\r\n\t\tif (jsc.isCanvasSupported) {\r\n\t\t\t// Canvas implementation for modern browsers\r\n\r\n\t\t\tvar canvas = document.createElement('canvas');\r\n\t\t\tvar ctx = canvas.getContext('2d');\r\n\r\n\t\t\tvar drawFunc = function (width, height, type) {\r\n\t\t\t\tcanvas.width = width;\r\n\t\t\t\tcanvas.height = height;\r\n\r\n\t\t\t\tctx.clearRect(0, 0, canvas.width, canvas.height);\r\n\r\n\t\t\t\tvar hGrad = ctx.createLinearGradient(0, 0, canvas.width, 0);\r\n\t\t\t\thGrad.addColorStop(0 / 6, '#F00');\r\n\t\t\t\thGrad.addColorStop(1 / 6, '#FF0');\r\n\t\t\t\thGrad.addColorStop(2 / 6, '#0F0');\r\n\t\t\t\thGrad.addColorStop(3 / 6, '#0FF');\r\n\t\t\t\thGrad.addColorStop(4 / 6, '#00F');\r\n\t\t\t\thGrad.addColorStop(5 / 6, '#F0F');\r\n\t\t\t\thGrad.addColorStop(6 / 6, '#F00');\r\n\r\n\t\t\t\tctx.fillStyle = hGrad;\r\n\t\t\t\tctx.fillRect(0, 0, canvas.width, canvas.height);\r\n\r\n\t\t\t\tvar vGrad = ctx.createLinearGradient(0, 0, 0, canvas.height);\r\n\t\t\t\tswitch (type.toLowerCase()) {\r\n\t\t\t\tcase 's':\r\n\t\t\t\t\tvGrad.addColorStop(0, 'rgba(255,255,255,0)');\r\n\t\t\t\t\tvGrad.addColorStop(1, 'rgba(255,255,255,1)');\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase 'v':\r\n\t\t\t\t\tvGrad.addColorStop(0, 'rgba(0,0,0,0)');\r\n\t\t\t\t\tvGrad.addColorStop(1, 'rgba(0,0,0,1)');\r\n\t\t\t\t\tbreak;\r\n\t\t\t\t}\r\n\t\t\t\tctx.fillStyle = vGrad;\r\n\t\t\t\tctx.fillRect(0, 0, canvas.width, canvas.height);\r\n\t\t\t};\r\n\r\n\t\t\tpaletteObj.elm = canvas;\r\n\t\t\tpaletteObj.draw = drawFunc;\r\n\r\n\t\t} else {\r\n\t\t\t// VML fallback for IE 7 and 8\r\n\r\n\t\t\tjsc.initVML();\r\n\r\n\t\t\tvar vmlContainer = document.createElement('div');\r\n\t\t\tvmlContainer.style.position = 'relative';\r\n\t\t\tvmlContainer.style.overflow = 'hidden';\r\n\r\n\t\t\tvar hGrad = document.createElement(jsc._vmlNS + ':fill');\r\n\t\t\thGrad.type = 'gradient';\r\n\t\t\thGrad.method = 'linear';\r\n\t\t\thGrad.angle = '90';\r\n\t\t\thGrad.colors = '16.67% #F0F, 33.33% #00F, 50% #0FF, 66.67% #0F0, 83.33% #FF0'\r\n\r\n\t\t\tvar hRect = document.createElement(jsc._vmlNS + ':rect');\r\n\t\t\thRect.style.position = 'absolute';\r\n\t\t\thRect.style.left = -1 + 'px';\r\n\t\t\thRect.style.top = -1 + 'px';\r\n\t\t\thRect.stroked = false;\r\n\t\t\thRect.appendChild(hGrad);\r\n\t\t\tvmlContainer.appendChild(hRect);\r\n\r\n\t\t\tvar vGrad = document.createElement(jsc._vmlNS + ':fill');\r\n\t\t\tvGrad.type = 'gradient';\r\n\t\t\tvGrad.method = 'linear';\r\n\t\t\tvGrad.angle = '180';\r\n\t\t\tvGrad.opacity = '0';\r\n\r\n\t\t\tvar vRect = document.createElement(jsc._vmlNS + ':rect');\r\n\t\t\tvRect.style.position = 'absolute';\r\n\t\t\tvRect.style.left = -1 + 'px';\r\n\t\t\tvRect.style.top = -1 + 'px';\r\n\t\t\tvRect.stroked = false;\r\n\t\t\tvRect.appendChild(vGrad);\r\n\t\t\tvmlContainer.appendChild(vRect);\r\n\r\n\t\t\tvar drawFunc = function (width, height, type) {\r\n\t\t\t\tvmlContainer.style.width = width + 'px';\r\n\t\t\t\tvmlContainer.style.height = height + 'px';\r\n\r\n\t\t\t\thRect.style.width =\r\n\t\t\t\tvRect.style.width =\r\n\t\t\t\t\t(width + 1) + 'px';\r\n\t\t\t\thRect.style.height =\r\n\t\t\t\tvRect.style.height =\r\n\t\t\t\t\t(height + 1) + 'px';\r\n\r\n\t\t\t\t// Colors must be specified during every redraw, otherwise IE won't display\r\n\t\t\t\t// a full gradient during a subsequential redraw\r\n\t\t\t\thGrad.color = '#F00';\r\n\t\t\t\thGrad.color2 = '#F00';\r\n\r\n\t\t\t\tswitch (type.toLowerCase()) {\r\n\t\t\t\tcase 's':\r\n\t\t\t\t\tvGrad.color = vGrad.color2 = '#FFF';\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase 'v':\r\n\t\t\t\t\tvGrad.color = vGrad.color2 = '#000';\r\n\t\t\t\t\tbreak;\r\n\t\t\t\t}\r\n\t\t\t};\r\n\t\t\t\r\n\t\t\tpaletteObj.elm = vmlContainer;\r\n\t\t\tpaletteObj.draw = drawFunc;\r\n\t\t}\r\n\r\n\t\treturn paletteObj;\r\n\t},\r\n\r\n\r\n\tcreateSliderGradient : function () {\r\n\r\n\t\tvar sliderObj = {\r\n\t\t\telm: null,\r\n\t\t\tdraw: null\r\n\t\t};\r\n\r\n\t\tif (jsc.isCanvasSupported) {\r\n\t\t\t// Canvas implementation for modern browsers\r\n\r\n\t\t\tvar canvas = document.createElement('canvas');\r\n\t\t\tvar ctx = canvas.getContext('2d');\r\n\r\n\t\t\tvar drawFunc = function (width, height, color1, color2) {\r\n\t\t\t\tcanvas.width = width;\r\n\t\t\t\tcanvas.height = height;\r\n\r\n\t\t\t\tctx.clearRect(0, 0, canvas.width, canvas.height);\r\n\r\n\t\t\t\tvar grad = ctx.createLinearGradient(0, 0, 0, canvas.height);\r\n\t\t\t\tgrad.addColorStop(0, color1);\r\n\t\t\t\tgrad.addColorStop(1, color2);\r\n\r\n\t\t\t\tctx.fillStyle = grad;\r\n\t\t\t\tctx.fillRect(0, 0, canvas.width, canvas.height);\r\n\t\t\t};\r\n\r\n\t\t\tsliderObj.elm = canvas;\r\n\t\t\tsliderObj.draw = drawFunc;\r\n\r\n\t\t} else {\r\n\t\t\t// VML fallback for IE 7 and 8\r\n\r\n\t\t\tjsc.initVML();\r\n\r\n\t\t\tvar vmlContainer = document.createElement('div');\r\n\t\t\tvmlContainer.style.position = 'relative';\r\n\t\t\tvmlContainer.style.overflow = 'hidden';\r\n\r\n\t\t\tvar grad = document.createElement(jsc._vmlNS + ':fill');\r\n\t\t\tgrad.type = 'gradient';\r\n\t\t\tgrad.method = 'linear';\r\n\t\t\tgrad.angle = '180';\r\n\r\n\t\t\tvar rect = document.createElement(jsc._vmlNS + ':rect');\r\n\t\t\trect.style.position = 'absolute';\r\n\t\t\trect.style.left = -1 + 'px';\r\n\t\t\trect.style.top = -1 + 'px';\r\n\t\t\trect.stroked = false;\r\n\t\t\trect.appendChild(grad);\r\n\t\t\tvmlContainer.appendChild(rect);\r\n\r\n\t\t\tvar drawFunc = function (width, height, color1, color2) {\r\n\t\t\t\tvmlContainer.style.width = width + 'px';\r\n\t\t\t\tvmlContainer.style.height = height + 'px';\r\n\r\n\t\t\t\trect.style.width = (width + 1) + 'px';\r\n\t\t\t\trect.style.height = (height + 1) + 'px';\r\n\r\n\t\t\t\tgrad.color = color1;\r\n\t\t\t\tgrad.color2 = color2;\r\n\t\t\t};\r\n\t\t\t\r\n\t\t\tsliderObj.elm = vmlContainer;\r\n\t\t\tsliderObj.draw = drawFunc;\r\n\t\t}\r\n\r\n\t\treturn sliderObj;\r\n\t},\r\n\r\n\r\n\tleaveValue : 1<<0,\r\n\tleaveStyle : 1<<1,\r\n\tleavePad : 1<<2,\r\n\tleaveSld : 1<<3,\r\n\r\n\r\n\tBoxShadow : (function () {\r\n\t\tvar BoxShadow = function (hShadow, vShadow, blur, spread, color, inset) {\r\n\t\t\tthis.hShadow = hShadow;\r\n\t\t\tthis.vShadow = vShadow;\r\n\t\t\tthis.blur = blur;\r\n\t\t\tthis.spread = spread;\r\n\t\t\tthis.color = color;\r\n\t\t\tthis.inset = !!inset;\r\n\t\t};\r\n\r\n\t\tBoxShadow.prototype.toString = function () {\r\n\t\t\tvar vals = [\r\n\t\t\t\tMath.round(this.hShadow) + 'px',\r\n\t\t\t\tMath.round(this.vShadow) + 'px',\r\n\t\t\t\tMath.round(this.blur) + 'px',\r\n\t\t\t\tMath.round(this.spread) + 'px',\r\n\t\t\t\tthis.color\r\n\t\t\t];\r\n\t\t\tif (this.inset) {\r\n\t\t\t\tvals.push('inset');\r\n\t\t\t}\r\n\t\t\treturn vals.join(' ');\r\n\t\t};\r\n\r\n\t\treturn BoxShadow;\r\n\t})(),\r\n\r\n\r\n\t//\r\n\t// Usage:\r\n\t// var myColor = new jscolor(<targetElement> [, <options>])\r\n\t//\r\n\r\n\tjscolor : function (targetElement, options) {\r\n\r\n\t\t// General options\r\n\t\t//\r\n\t\tthis.value = null; // initial HEX color. To change it later, use methods fromString(), fromHSV() and fromRGB()\r\n\t\tthis.valueElement = targetElement; // element that will be used to display and input the color code\r\n\t\tthis.styleElement = targetElement; // element that will preview the picked color using CSS backgroundColor\r\n\t\tthis.required = true; // whether the associated text <input> can be left empty\r\n\t\tthis.refine = true; // whether to refine the entered color code (e.g. uppercase it and remove whitespace)\r\n\t\tthis.hash = false; // whether to prefix the HEX color code with # symbol\r\n\t\tthis.uppercase = true; // whether to uppercase the color code\r\n\t\tthis.onFineChange = null; // called instantly every time the color changes (value can be either a function or a string with javascript code)\r\n\t\tthis.activeClass = 'jscolor-active'; // class to be set to the target element when a picker window is open on it\r\n\t\tthis.minS = 0; // min allowed saturation (0 - 100)\r\n\t\tthis.maxS = 100; // max allowed saturation (0 - 100)\r\n\t\tthis.minV = 0; // min allowed value (brightness) (0 - 100)\r\n\t\tthis.maxV = 100; // max allowed value (brightness) (0 - 100)\r\n\r\n\t\t// Accessing the picked color\r\n\t\t//\r\n\t\tthis.hsv = [0, 0, 100]; // read-only  [0-360, 0-100, 0-100]\r\n\t\tthis.rgb = [255, 255, 255]; // read-only  [0-255, 0-255, 0-255]\r\n\r\n\t\t// Color Picker options\r\n\t\t//\r\n\t\tthis.width = 181; // width of color palette (in px)\r\n\t\tthis.height = 101; // height of color palette (in px)\r\n\t\tthis.showOnClick = true; // whether to display the color picker when user clicks on its target element\r\n\t\tthis.mode = 'HSV'; // HSV | HVS | HS | HV - layout of the color picker controls\r\n\t\tthis.position = 'bottom'; // left | right | top | bottom - position relative to the target element\r\n\t\tthis.smartPosition = true; // automatically change picker position when there is not enough space for it\r\n\t\tthis.sliderSize = 16; // px\r\n\t\tthis.crossSize = 8; // px\r\n\t\tthis.closable = false; // whether to display the Close button\r\n\t\tthis.closeText = 'Close';\r\n\t\tthis.buttonColor = '#000000'; // CSS color\r\n\t\tthis.buttonHeight = 18; // px\r\n\t\tthis.padding = 12; // px\r\n\t\tthis.backgroundColor = '#FFFFFF'; // CSS color\r\n\t\tthis.borderWidth = 1; // px\r\n\t\tthis.borderColor = '#BBBBBB'; // CSS color\r\n\t\tthis.borderRadius = 8; // px\r\n\t\tthis.insetWidth = 1; // px\r\n\t\tthis.insetColor = '#BBBBBB'; // CSS color\r\n\t\tthis.shadow = true; // whether to display shadow\r\n\t\tthis.shadowBlur = 15; // px\r\n\t\tthis.shadowColor = 'rgba(0,0,0,0.2)'; // CSS color\r\n\t\tthis.pointerColor = '#4C4C4C'; // px\r\n\t\tthis.pointerBorderColor = '#FFFFFF'; // px\r\n        this.pointerBorderWidth = 1; // px\r\n        this.pointerThickness = 2; // px\r\n\t\tthis.zIndex = 1000;\r\n\t\tthis.container = null; // where to append the color picker (BODY element by default)\r\n\r\n\r\n\t\tfor (var opt in options) {\r\n\t\t\tif (options.hasOwnProperty(opt)) {\r\n\t\t\t\tthis[opt] = options[opt];\r\n\t\t\t}\r\n\t\t}\r\n\r\n\r\n\t\tthis.hide = function () {\r\n\t\t\tif (isPickerOwner()) {\r\n\t\t\t\tdetachPicker();\r\n\t\t\t}\r\n\t\t};\r\n\r\n\r\n\t\tthis.show = function () {\r\n\t\t\tdrawPicker();\r\n\t\t};\r\n\r\n\r\n\t\tthis.redraw = function () {\r\n\t\t\tif (isPickerOwner()) {\r\n\t\t\t\tdrawPicker();\r\n\t\t\t}\r\n\t\t};\r\n\r\n\r\n\t\tthis.importColor = function () {\r\n\t\t\tif (!this.valueElement) {\r\n\t\t\t\tthis.exportColor();\r\n\t\t\t} else {\r\n\t\t\t\tif (jsc.isElementType(this.valueElement, 'input')) {\r\n\t\t\t\t\tif (!this.refine) {\r\n\t\t\t\t\t\tif (!this.fromString(this.valueElement.value, jsc.leaveValue)) {\r\n\t\t\t\t\t\t\tif (this.styleElement) {\r\n\t\t\t\t\t\t\t\tthis.styleElement.style.backgroundImage = this.styleElement._jscOrigStyle.backgroundImage;\r\n\t\t\t\t\t\t\t\tthis.styleElement.style.backgroundColor = this.styleElement._jscOrigStyle.backgroundColor;\r\n\t\t\t\t\t\t\t\tthis.styleElement.style.color = this.styleElement._jscOrigStyle.color;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tthis.exportColor(jsc.leaveValue | jsc.leaveStyle);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t} else if (!this.required && /^\\s*$/.test(this.valueElement.value)) {\r\n\t\t\t\t\t\tthis.valueElement.value = '';\r\n\t\t\t\t\t\tif (this.styleElement) {\r\n\t\t\t\t\t\t\tthis.styleElement.style.backgroundImage = this.styleElement._jscOrigStyle.backgroundImage;\r\n\t\t\t\t\t\t\tthis.styleElement.style.backgroundColor = this.styleElement._jscOrigStyle.backgroundColor;\r\n\t\t\t\t\t\t\tthis.styleElement.style.color = this.styleElement._jscOrigStyle.color;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tthis.exportColor(jsc.leaveValue | jsc.leaveStyle);\r\n\r\n\t\t\t\t\t} else if (this.fromString(this.valueElement.value)) {\r\n\t\t\t\t\t\t// managed to import color successfully from the value -> OK, don't do anything\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tthis.exportColor();\r\n\t\t\t\t\t}\r\n\t\t\t\t} else {\r\n\t\t\t\t\t// not an input element -> doesn't have any value\r\n\t\t\t\t\tthis.exportColor();\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t};\r\n\r\n\r\n\t\tthis.exportColor = function (flags) {\r\n\t\t\tif (!(flags & jsc.leaveValue) && this.valueElement) {\r\n\t\t\t\tvar value = this.toString();\r\n\t\t\t\tif (this.uppercase) { value = value.toUpperCase(); }\r\n\t\t\t\tif (this.hash) { value = '#' + value; }\r\n\r\n\t\t\t\tif (jsc.isElementType(this.valueElement, 'input')) {\r\n\t\t\t\t\tthis.valueElement.value = value;\r\n\t\t\t\t} else {\r\n\t\t\t\t\tthis.valueElement.innerHTML = value;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tif (!(flags & jsc.leaveStyle)) {\r\n\t\t\t\tif (this.styleElement) {\r\n\t\t\t\t\tthis.styleElement.style.backgroundImage = 'none';\r\n\t\t\t\t\tthis.styleElement.style.backgroundColor = '#' + this.toString();\r\n\t\t\t\t\tthis.styleElement.style.color = this.isLight() ? '#000' : '#FFF';\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tif (!(flags & jsc.leavePad) && isPickerOwner()) {\r\n\t\t\t\tredrawPad();\r\n\t\t\t}\r\n\t\t\tif (!(flags & jsc.leaveSld) && isPickerOwner()) {\r\n\t\t\t\tredrawSld();\r\n\t\t\t}\r\n\t\t};\r\n\r\n\r\n\t\t// h: 0-360\r\n\t\t// s: 0-100\r\n\t\t// v: 0-100\r\n\t\t//\r\n\t\tthis.fromHSV = function (h, s, v, flags) { // null = don't change\r\n\t\t\tif (h !== null) {\r\n\t\t\t\tif (isNaN(h)) { return false; }\r\n\t\t\t\th = Math.max(0, Math.min(360, h));\r\n\t\t\t}\r\n\t\t\tif (s !== null) {\r\n\t\t\t\tif (isNaN(s)) { return false; }\r\n\t\t\t\ts = Math.max(0, Math.min(100, this.maxS, s), this.minS);\r\n\t\t\t}\r\n\t\t\tif (v !== null) {\r\n\t\t\t\tif (isNaN(v)) { return false; }\r\n\t\t\t\tv = Math.max(0, Math.min(100, this.maxV, v), this.minV);\r\n\t\t\t}\r\n\r\n\t\t\tthis.rgb = HSV_RGB(\r\n\t\t\t\th===null ? this.hsv[0] : (this.hsv[0]=h),\r\n\t\t\t\ts===null ? this.hsv[1] : (this.hsv[1]=s),\r\n\t\t\t\tv===null ? this.hsv[2] : (this.hsv[2]=v)\r\n\t\t\t);\r\n\r\n\t\t\tthis.exportColor(flags);\r\n\t\t};\r\n\r\n\r\n\t\t// r: 0-255\r\n\t\t// g: 0-255\r\n\t\t// b: 0-255\r\n\t\t//\r\n\t\tthis.fromRGB = function (r, g, b, flags) { // null = don't change\r\n\t\t\tif (r !== null) {\r\n\t\t\t\tif (isNaN(r)) { return false; }\r\n\t\t\t\tr = Math.max(0, Math.min(255, r));\r\n\t\t\t}\r\n\t\t\tif (g !== null) {\r\n\t\t\t\tif (isNaN(g)) { return false; }\r\n\t\t\t\tg = Math.max(0, Math.min(255, g));\r\n\t\t\t}\r\n\t\t\tif (b !== null) {\r\n\t\t\t\tif (isNaN(b)) { return false; }\r\n\t\t\t\tb = Math.max(0, Math.min(255, b));\r\n\t\t\t}\r\n\r\n\t\t\tvar hsv = RGB_HSV(\r\n\t\t\t\tr===null ? this.rgb[0] : r,\r\n\t\t\t\tg===null ? this.rgb[1] : g,\r\n\t\t\t\tb===null ? this.rgb[2] : b\r\n\t\t\t);\r\n\t\t\tif (hsv[0] !== null) {\r\n\t\t\t\tthis.hsv[0] = Math.max(0, Math.min(360, hsv[0]));\r\n\t\t\t}\r\n\t\t\tif (hsv[2] !== 0) {\r\n\t\t\t\tthis.hsv[1] = hsv[1]===null ? null : Math.max(0, this.minS, Math.min(100, this.maxS, hsv[1]));\r\n\t\t\t}\r\n\t\t\tthis.hsv[2] = hsv[2]===null ? null : Math.max(0, this.minV, Math.min(100, this.maxV, hsv[2]));\r\n\r\n\t\t\t// update RGB according to final HSV, as some values might be trimmed\r\n\t\t\tvar rgb = HSV_RGB(this.hsv[0], this.hsv[1], this.hsv[2]);\r\n\t\t\tthis.rgb[0] = rgb[0];\r\n\t\t\tthis.rgb[1] = rgb[1];\r\n\t\t\tthis.rgb[2] = rgb[2];\r\n\r\n\t\t\tthis.exportColor(flags);\r\n\t\t};\r\n\r\n\r\n\t\tthis.fromString = function (str, flags) {\r\n\t\t\tvar m;\r\n\t\t\tif (m = str.match(/^\\W*([0-9A-F]{3}([0-9A-F]{3})?)\\W*$/i)) {\r\n\t\t\t\t// HEX notation\r\n\t\t\t\t//\r\n\r\n\t\t\t\tif (m[1].length === 6) {\r\n\t\t\t\t\t// 6-char notation\r\n\t\t\t\t\tthis.fromRGB(\r\n\t\t\t\t\t\tparseInt(m[1].substr(0,2),16),\r\n\t\t\t\t\t\tparseInt(m[1].substr(2,2),16),\r\n\t\t\t\t\t\tparseInt(m[1].substr(4,2),16),\r\n\t\t\t\t\t\tflags\r\n\t\t\t\t\t);\r\n\t\t\t\t} else {\r\n\t\t\t\t\t// 3-char notation\r\n\t\t\t\t\tthis.fromRGB(\r\n\t\t\t\t\t\tparseInt(m[1].charAt(0) + m[1].charAt(0),16),\r\n\t\t\t\t\t\tparseInt(m[1].charAt(1) + m[1].charAt(1),16),\r\n\t\t\t\t\t\tparseInt(m[1].charAt(2) + m[1].charAt(2),16),\r\n\t\t\t\t\t\tflags\r\n\t\t\t\t\t);\r\n\t\t\t\t}\r\n\t\t\t\treturn true;\r\n\r\n\t\t\t} else if (m = str.match(/^\\W*rgba?\\(([^)]*)\\)\\W*$/i)) {\r\n\t\t\t\tvar params = m[1].split(',');\r\n\t\t\t\tvar re = /^\\s*(\\d*)(\\.\\d+)?\\s*$/;\r\n\t\t\t\tvar mR, mG, mB;\r\n\t\t\t\tif (\r\n\t\t\t\t\tparams.length >= 3 &&\r\n\t\t\t\t\t(mR = params[0].match(re)) &&\r\n\t\t\t\t\t(mG = params[1].match(re)) &&\r\n\t\t\t\t\t(mB = params[2].match(re))\r\n\t\t\t\t) {\r\n\t\t\t\t\tvar r = parseFloat((mR[1] || '0') + (mR[2] || ''));\r\n\t\t\t\t\tvar g = parseFloat((mG[1] || '0') + (mG[2] || ''));\r\n\t\t\t\t\tvar b = parseFloat((mB[1] || '0') + (mB[2] || ''));\r\n\t\t\t\t\tthis.fromRGB(r, g, b, flags);\r\n\t\t\t\t\treturn true;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\treturn false;\r\n\t\t};\r\n\r\n\r\n\t\tthis.toString = function () {\r\n\t\t\treturn (\r\n\t\t\t\t(0x100 | Math.round(this.rgb[0])).toString(16).substr(1) +\r\n\t\t\t\t(0x100 | Math.round(this.rgb[1])).toString(16).substr(1) +\r\n\t\t\t\t(0x100 | Math.round(this.rgb[2])).toString(16).substr(1)\r\n\t\t\t);\r\n\t\t};\r\n\r\n\r\n\t\tthis.toHEXString = function () {\r\n\t\t\treturn '#' + this.toString().toUpperCase();\r\n\t\t};\r\n\r\n\r\n\t\tthis.toRGBString = function () {\r\n\t\t\treturn ('rgb(' +\r\n\t\t\t\tMath.round(this.rgb[0]) + ',' +\r\n\t\t\t\tMath.round(this.rgb[1]) + ',' +\r\n\t\t\t\tMath.round(this.rgb[2]) + ')'\r\n\t\t\t);\r\n\t\t};\r\n\r\n\r\n\t\tthis.isLight = function () {\r\n\t\t\treturn (\r\n\t\t\t\t0.213 * this.rgb[0] +\r\n\t\t\t\t0.715 * this.rgb[1] +\r\n\t\t\t\t0.072 * this.rgb[2] >\r\n\t\t\t\t255 / 2\r\n\t\t\t);\r\n\t\t};\r\n\r\n\r\n\t\tthis._processParentElementsInDOM = function () {\r\n\t\t\tif (this._linkedElementsProcessed) { return; }\r\n\t\t\tthis._linkedElementsProcessed = true;\r\n\r\n\t\t\tvar elm = this.targetElement;\r\n\t\t\tdo {\r\n\t\t\t\t// If the target element or one of its parent nodes has fixed position,\r\n\t\t\t\t// then use fixed positioning instead\r\n\t\t\t\t//\r\n\t\t\t\t// Note: In Firefox, getComputedStyle returns null in a hidden iframe,\r\n\t\t\t\t// that's why we need to check if the returned style object is non-empty\r\n\t\t\t\tvar currStyle = jsc.getStyle(elm);\r\n\t\t\t\tif (currStyle && currStyle.position.toLowerCase() === 'fixed') {\r\n\t\t\t\t\tthis.fixed = true;\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif (elm !== this.targetElement) {\r\n\t\t\t\t\t// Ensure to attach onParentScroll only once to each parent element\r\n\t\t\t\t\t// (multiple targetElements can share the same parent nodes)\r\n\t\t\t\t\t//\r\n\t\t\t\t\t// Note: It's not just offsetParents that can be scrollable,\r\n\t\t\t\t\t// that's why we loop through all parent nodes\r\n\t\t\t\t\tif (!elm._jscEventsAttached) {\r\n\t\t\t\t\t\tjsc.attachEvent(elm, 'scroll', jsc.onParentScroll);\r\n\t\t\t\t\t\telm._jscEventsAttached = true;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t} while ((elm = elm.parentNode) && !jsc.isElementType(elm, 'body'));\r\n\t\t};\r\n\r\n\r\n\t\t// r: 0-255\r\n\t\t// g: 0-255\r\n\t\t// b: 0-255\r\n\t\t//\r\n\t\t// returns: [ 0-360, 0-100, 0-100 ]\r\n\t\t//\r\n\t\tfunction RGB_HSV (r, g, b) {\r\n\t\t\tr /= 255;\r\n\t\t\tg /= 255;\r\n\t\t\tb /= 255;\r\n\t\t\tvar n = Math.min(Math.min(r,g),b);\r\n\t\t\tvar v = Math.max(Math.max(r,g),b);\r\n\t\t\tvar m = v - n;\r\n\t\t\tif (m === 0) { return [ null, 0, 100 * v ]; }\r\n\t\t\tvar h = r===n ? 3+(b-g)/m : (g===n ? 5+(r-b)/m : 1+(g-r)/m);\r\n\t\t\treturn [\r\n\t\t\t\t60 * (h===6?0:h),\r\n\t\t\t\t100 * (m/v),\r\n\t\t\t\t100 * v\r\n\t\t\t];\r\n\t\t}\r\n\r\n\r\n\t\t// h: 0-360\r\n\t\t// s: 0-100\r\n\t\t// v: 0-100\r\n\t\t//\r\n\t\t// returns: [ 0-255, 0-255, 0-255 ]\r\n\t\t//\r\n\t\tfunction HSV_RGB (h, s, v) {\r\n\t\t\tvar u = 255 * (v / 100);\r\n\r\n\t\t\tif (h === null) {\r\n\t\t\t\treturn [ u, u, u ];\r\n\t\t\t}\r\n\r\n\t\t\th /= 60;\r\n\t\t\ts /= 100;\r\n\r\n\t\t\tvar i = Math.floor(h);\r\n\t\t\tvar f = i%2 ? h-i : 1-(h-i);\r\n\t\t\tvar m = u * (1 - s);\r\n\t\t\tvar n = u * (1 - s * f);\r\n\t\t\tswitch (i) {\r\n\t\t\t\tcase 6:\r\n\t\t\t\tcase 0: return [u,n,m];\r\n\t\t\t\tcase 1: return [n,u,m];\r\n\t\t\t\tcase 2: return [m,u,n];\r\n\t\t\t\tcase 3: return [m,n,u];\r\n\t\t\t\tcase 4: return [n,m,u];\r\n\t\t\t\tcase 5: return [u,m,n];\r\n\t\t\t}\r\n\t\t}\r\n\r\n\r\n\t\tfunction detachPicker () {\r\n\t\t\tjsc.unsetClass(THIS.targetElement, THIS.activeClass);\r\n\t\t\tjsc.picker.wrap.parentNode.removeChild(jsc.picker.wrap);\r\n\t\t\tdelete jsc.picker.owner;\r\n\t\t}\r\n\r\n\r\n\t\tfunction drawPicker () {\r\n\r\n\t\t\t// At this point, when drawing the picker, we know what the parent elements are\r\n\t\t\t// and we can do all related DOM operations, such as registering events on them\r\n\t\t\t// or checking their positioning\r\n\t\t\tTHIS._processParentElementsInDOM();\r\n\r\n\t\t\tif (!jsc.picker) {\r\n\t\t\t\tjsc.picker = {\r\n\t\t\t\t\towner: null,\r\n\t\t\t\t\twrap : document.createElement('div'),\r\n\t\t\t\t\tbox : document.createElement('div'),\r\n\t\t\t\t\tboxS : document.createElement('div'), // shadow area\r\n\t\t\t\t\tboxB : document.createElement('div'), // border\r\n\t\t\t\t\tpad : document.createElement('div'),\r\n\t\t\t\t\tpadB : document.createElement('div'), // border\r\n\t\t\t\t\tpadM : document.createElement('div'), // mouse/touch area\r\n\t\t\t\t\tpadPal : jsc.createPalette(),\r\n\t\t\t\t\tcross : document.createElement('div'),\r\n\t\t\t\t\tcrossBY : document.createElement('div'), // border Y\r\n\t\t\t\t\tcrossBX : document.createElement('div'), // border X\r\n\t\t\t\t\tcrossLY : document.createElement('div'), // line Y\r\n\t\t\t\t\tcrossLX : document.createElement('div'), // line X\r\n\t\t\t\t\tsld : document.createElement('div'),\r\n\t\t\t\t\tsldB : document.createElement('div'), // border\r\n\t\t\t\t\tsldM : document.createElement('div'), // mouse/touch area\r\n\t\t\t\t\tsldGrad : jsc.createSliderGradient(),\r\n\t\t\t\t\tsldPtrS : document.createElement('div'), // slider pointer spacer\r\n\t\t\t\t\tsldPtrIB : document.createElement('div'), // slider pointer inner border\r\n\t\t\t\t\tsldPtrMB : document.createElement('div'), // slider pointer middle border\r\n\t\t\t\t\tsldPtrOB : document.createElement('div'), // slider pointer outer border\r\n\t\t\t\t\tbtn : document.createElement('div'),\r\n\t\t\t\t\tbtnT : document.createElement('span') // text\r\n\t\t\t\t};\r\n\r\n\t\t\t\tjsc.picker.pad.appendChild(jsc.picker.padPal.elm);\r\n\t\t\t\tjsc.picker.padB.appendChild(jsc.picker.pad);\r\n\t\t\t\tjsc.picker.cross.appendChild(jsc.picker.crossBY);\r\n\t\t\t\tjsc.picker.cross.appendChild(jsc.picker.crossBX);\r\n\t\t\t\tjsc.picker.cross.appendChild(jsc.picker.crossLY);\r\n\t\t\t\tjsc.picker.cross.appendChild(jsc.picker.crossLX);\r\n\t\t\t\tjsc.picker.padB.appendChild(jsc.picker.cross);\r\n\t\t\t\tjsc.picker.box.appendChild(jsc.picker.padB);\r\n\t\t\t\tjsc.picker.box.appendChild(jsc.picker.padM);\r\n\r\n\t\t\t\tjsc.picker.sld.appendChild(jsc.picker.sldGrad.elm);\r\n\t\t\t\tjsc.picker.sldB.appendChild(jsc.picker.sld);\r\n\t\t\t\tjsc.picker.sldB.appendChild(jsc.picker.sldPtrOB);\r\n\t\t\t\tjsc.picker.sldPtrOB.appendChild(jsc.picker.sldPtrMB);\r\n\t\t\t\tjsc.picker.sldPtrMB.appendChild(jsc.picker.sldPtrIB);\r\n\t\t\t\tjsc.picker.sldPtrIB.appendChild(jsc.picker.sldPtrS);\r\n\t\t\t\tjsc.picker.box.appendChild(jsc.picker.sldB);\r\n\t\t\t\tjsc.picker.box.appendChild(jsc.picker.sldM);\r\n\r\n\t\t\t\tjsc.picker.btn.appendChild(jsc.picker.btnT);\r\n\t\t\t\tjsc.picker.box.appendChild(jsc.picker.btn);\r\n\r\n\t\t\t\tjsc.picker.boxB.appendChild(jsc.picker.box);\r\n\t\t\t\tjsc.picker.wrap.appendChild(jsc.picker.boxS);\r\n\t\t\t\tjsc.picker.wrap.appendChild(jsc.picker.boxB);\r\n\t\t\t}\r\n\r\n\t\t\tvar p = jsc.picker;\r\n\r\n\t\t\tvar displaySlider = !!jsc.getSliderComponent(THIS);\r\n\t\t\tvar dims = jsc.getPickerDims(THIS);\r\n\t\t\tvar crossOuterSize = (2 * THIS.pointerBorderWidth + THIS.pointerThickness + 2 * THIS.crossSize);\r\n\t\t\tvar padToSliderPadding = jsc.getPadToSliderPadding(THIS);\r\n\t\t\tvar borderRadius = Math.min(\r\n\t\t\t\tTHIS.borderRadius,\r\n\t\t\t\tMath.round(THIS.padding * Math.PI)); // px\r\n\t\t\tvar padCursor = 'crosshair';\r\n\r\n\t\t\t// wrap\r\n\t\t\tp.wrap.style.clear = 'both';\r\n\t\t\tp.wrap.style.width = (dims[0] + 2 * THIS.borderWidth) + 'px';\r\n\t\t\tp.wrap.style.height = (dims[1] + 2 * THIS.borderWidth) + 'px';\r\n\t\t\tp.wrap.style.zIndex = THIS.zIndex;\r\n\r\n\t\t\t// picker\r\n\t\t\tp.box.style.width = dims[0] + 'px';\r\n\t\t\tp.box.style.height = dims[1] + 'px';\r\n\r\n\t\t\tp.boxS.style.position = 'absolute';\r\n\t\t\tp.boxS.style.left = '0';\r\n\t\t\tp.boxS.style.top = '0';\r\n\t\t\tp.boxS.style.width = '100%';\r\n\t\t\tp.boxS.style.height = '100%';\r\n\t\t\tjsc.setBorderRadius(p.boxS, borderRadius + 'px');\r\n\r\n\t\t\t// picker border\r\n\t\t\tp.boxB.style.position = 'relative';\r\n\t\t\tp.boxB.style.border = THIS.borderWidth + 'px solid';\r\n\t\t\tp.boxB.style.borderColor = THIS.borderColor;\r\n\t\t\tp.boxB.style.background = THIS.backgroundColor;\r\n\t\t\tjsc.setBorderRadius(p.boxB, borderRadius + 'px');\r\n\r\n\t\t\t// IE hack:\r\n\t\t\t// If the element is transparent, IE will trigger the event on the elements under it,\r\n\t\t\t// e.g. on Canvas or on elements with border\r\n\t\t\tp.padM.style.background =\r\n\t\t\tp.sldM.style.background =\r\n\t\t\t\t'#FFF';\r\n\t\t\tjsc.setStyle(p.padM, 'opacity', '0');\r\n\t\t\tjsc.setStyle(p.sldM, 'opacity', '0');\r\n\r\n\t\t\t// pad\r\n\t\t\tp.pad.style.position = 'relative';\r\n\t\t\tp.pad.style.width = THIS.width + 'px';\r\n\t\t\tp.pad.style.height = THIS.height + 'px';\r\n\r\n\t\t\t// pad palettes (HSV and HVS)\r\n\t\t\tp.padPal.draw(THIS.width, THIS.height, jsc.getPadYComponent(THIS));\r\n\r\n\t\t\t// pad border\r\n\t\t\tp.padB.style.position = 'absolute';\r\n\t\t\tp.padB.style.left = THIS.padding + 'px';\r\n\t\t\tp.padB.style.top = THIS.padding + 'px';\r\n\t\t\tp.padB.style.border = THIS.insetWidth + 'px solid';\r\n\t\t\tp.padB.style.borderColor = THIS.insetColor;\r\n\r\n\t\t\t// pad mouse area\r\n\t\t\tp.padM._jscInstance = THIS;\r\n\t\t\tp.padM._jscControlName = 'pad';\r\n\t\t\tp.padM.style.position = 'absolute';\r\n\t\t\tp.padM.style.left = '0';\r\n\t\t\tp.padM.style.top = '0';\r\n\t\t\tp.padM.style.width = (THIS.padding + 2 * THIS.insetWidth + THIS.width + padToSliderPadding / 2) + 'px';\r\n\t\t\tp.padM.style.height = dims[1] + 'px';\r\n\t\t\tp.padM.style.cursor = padCursor;\r\n\r\n\t\t\t// pad cross\r\n\t\t\tp.cross.style.position = 'absolute';\r\n\t\t\tp.cross.style.left =\r\n\t\t\tp.cross.style.top =\r\n\t\t\t\t'0';\r\n\t\t\tp.cross.style.width =\r\n\t\t\tp.cross.style.height =\r\n\t\t\t\tcrossOuterSize + 'px';\r\n\r\n\t\t\t// pad cross border Y and X\r\n\t\t\tp.crossBY.style.position =\r\n\t\t\tp.crossBX.style.position =\r\n\t\t\t\t'absolute';\r\n\t\t\tp.crossBY.style.background =\r\n\t\t\tp.crossBX.style.background =\r\n\t\t\t\tTHIS.pointerBorderColor;\r\n\t\t\tp.crossBY.style.width =\r\n\t\t\tp.crossBX.style.height =\r\n\t\t\t\t(2 * THIS.pointerBorderWidth + THIS.pointerThickness) + 'px';\r\n\t\t\tp.crossBY.style.height =\r\n\t\t\tp.crossBX.style.width =\r\n\t\t\t\tcrossOuterSize + 'px';\r\n\t\t\tp.crossBY.style.left =\r\n\t\t\tp.crossBX.style.top =\r\n\t\t\t\t(Math.floor(crossOuterSize / 2) - Math.floor(THIS.pointerThickness / 2) - THIS.pointerBorderWidth) + 'px';\r\n\t\t\tp.crossBY.style.top =\r\n\t\t\tp.crossBX.style.left =\r\n\t\t\t\t'0';\r\n\r\n\t\t\t// pad cross line Y and X\r\n\t\t\tp.crossLY.style.position =\r\n\t\t\tp.crossLX.style.position =\r\n\t\t\t\t'absolute';\r\n\t\t\tp.crossLY.style.background =\r\n\t\t\tp.crossLX.style.background =\r\n\t\t\t\tTHIS.pointerColor;\r\n\t\t\tp.crossLY.style.height =\r\n\t\t\tp.crossLX.style.width =\r\n\t\t\t\t(crossOuterSize - 2 * THIS.pointerBorderWidth) + 'px';\r\n\t\t\tp.crossLY.style.width =\r\n\t\t\tp.crossLX.style.height =\r\n\t\t\t\tTHIS.pointerThickness + 'px';\r\n\t\t\tp.crossLY.style.left =\r\n\t\t\tp.crossLX.style.top =\r\n\t\t\t\t(Math.floor(crossOuterSize / 2) - Math.floor(THIS.pointerThickness / 2)) + 'px';\r\n\t\t\tp.crossLY.style.top =\r\n\t\t\tp.crossLX.style.left =\r\n\t\t\t\tTHIS.pointerBorderWidth + 'px';\r\n\r\n\t\t\t// slider\r\n\t\t\tp.sld.style.overflow = 'hidden';\r\n\t\t\tp.sld.style.width = THIS.sliderSize + 'px';\r\n\t\t\tp.sld.style.height = THIS.height + 'px';\r\n\r\n\t\t\t// slider gradient\r\n\t\t\tp.sldGrad.draw(THIS.sliderSize, THIS.height, '#000', '#000');\r\n\r\n\t\t\t// slider border\r\n\t\t\tp.sldB.style.display = displaySlider ? 'block' : 'none';\r\n\t\t\tp.sldB.style.position = 'absolute';\r\n\t\t\tp.sldB.style.right = THIS.padding + 'px';\r\n\t\t\tp.sldB.style.top = THIS.padding + 'px';\r\n\t\t\tp.sldB.style.border = THIS.insetWidth + 'px solid';\r\n\t\t\tp.sldB.style.borderColor = THIS.insetColor;\r\n\r\n\t\t\t// slider mouse area\r\n\t\t\tp.sldM._jscInstance = THIS;\r\n\t\t\tp.sldM._jscControlName = 'sld';\r\n\t\t\tp.sldM.style.display = displaySlider ? 'block' : 'none';\r\n\t\t\tp.sldM.style.position = 'absolute';\r\n\t\t\tp.sldM.style.right = '0';\r\n\t\t\tp.sldM.style.top = '0';\r\n\t\t\tp.sldM.style.width = (THIS.sliderSize + padToSliderPadding / 2 + THIS.padding + 2 * THIS.insetWidth) + 'px';\r\n\t\t\tp.sldM.style.height = dims[1] + 'px';\r\n\t\t\tp.sldM.style.cursor = 'default';\r\n\r\n\t\t\t// slider pointer inner and outer border\r\n\t\t\tp.sldPtrIB.style.border =\r\n\t\t\tp.sldPtrOB.style.border =\r\n\t\t\t\tTHIS.pointerBorderWidth + 'px solid ' + THIS.pointerBorderColor;\r\n\r\n\t\t\t// slider pointer outer border\r\n\t\t\tp.sldPtrOB.style.position = 'absolute';\r\n\t\t\tp.sldPtrOB.style.left = -(2 * THIS.pointerBorderWidth + THIS.pointerThickness) + 'px';\r\n\t\t\tp.sldPtrOB.style.top = '0';\r\n\r\n\t\t\t// slider pointer middle border\r\n\t\t\tp.sldPtrMB.style.border = THIS.pointerThickness + 'px solid ' + THIS.pointerColor;\r\n\r\n\t\t\t// slider pointer spacer\r\n\t\t\tp.sldPtrS.style.width = THIS.sliderSize + 'px';\r\n\t\t\tp.sldPtrS.style.height = sliderPtrSpace + 'px';\r\n\r\n\t\t\t// the Close button\r\n\t\t\tfunction setBtnBorder () {\r\n\t\t\t\tvar insetColors = THIS.insetColor.split(/\\s+/);\r\n\t\t\t\tvar outsetColor = insetColors.length < 2 ? insetColors[0] : insetColors[1] + ' ' + insetColors[0] + ' ' + insetColors[0] + ' ' + insetColors[1];\r\n\t\t\t\tp.btn.style.borderColor = outsetColor;\r\n\t\t\t}\r\n\t\t\tp.btn.style.display = THIS.closable ? 'block' : 'none';\r\n\t\t\tp.btn.style.position = 'absolute';\r\n\t\t\tp.btn.style.left = THIS.padding + 'px';\r\n\t\t\tp.btn.style.bottom = THIS.padding + 'px';\r\n\t\t\tp.btn.style.padding = '0 15px';\r\n\t\t\tp.btn.style.height = THIS.buttonHeight + 'px';\r\n\t\t\tp.btn.style.border = THIS.insetWidth + 'px solid';\r\n\t\t\tsetBtnBorder();\r\n\t\t\tp.btn.style.color = THIS.buttonColor;\r\n\t\t\tp.btn.style.font = '12px sans-serif';\r\n\t\t\tp.btn.style.textAlign = 'center';\r\n\t\t\ttry {\r\n\t\t\t\tp.btn.style.cursor = 'pointer';\r\n\t\t\t} catch(eOldIE) {\r\n\t\t\t\tp.btn.style.cursor = 'hand';\r\n\t\t\t}\r\n\t\t\tp.btn.onmousedown = function () {\r\n\t\t\t\tTHIS.hide();\r\n\t\t\t};\r\n\t\t\tp.btnT.style.lineHeight = THIS.buttonHeight + 'px';\r\n\t\t\tp.btnT.innerHTML = '';\r\n\t\t\tp.btnT.appendChild(document.createTextNode(THIS.closeText));\r\n\r\n\t\t\t// place pointers\r\n\t\t\tredrawPad();\r\n\t\t\tredrawSld();\r\n\r\n\t\t\t// If we are changing the owner without first closing the picker,\r\n\t\t\t// make sure to first deal with the old owner\r\n\t\t\tif (jsc.picker.owner && jsc.picker.owner !== THIS) {\r\n\t\t\t\tjsc.unsetClass(jsc.picker.owner.targetElement, THIS.activeClass);\r\n\t\t\t}\r\n\r\n\t\t\t// Set the new picker owner\r\n\t\t\tjsc.picker.owner = THIS;\r\n\r\n\t\t\t// The redrawPosition() method needs picker.owner to be set, that's why we call it here,\r\n\t\t\t// after setting the owner\r\n\t\t\tif (jsc.isElementType(container, 'body')) {\r\n\t\t\t\tjsc.redrawPosition();\r\n\t\t\t} else {\r\n\t\t\t\tjsc._drawPosition(THIS, 0, 0, 'relative', false);\r\n\t\t\t}\r\n\r\n\t\t\tif (p.wrap.parentNode != container) {\r\n\t\t\t\tcontainer.appendChild(p.wrap);\r\n\t\t\t}\r\n\r\n\t\t\tjsc.setClass(THIS.targetElement, THIS.activeClass);\r\n\t\t}\r\n\r\n\r\n\t\tfunction redrawPad () {\r\n\t\t\t// redraw the pad pointer\r\n\t\t\tswitch (jsc.getPadYComponent(THIS)) {\r\n\t\t\tcase 's': var yComponent = 1; break;\r\n\t\t\tcase 'v': var yComponent = 2; break;\r\n\t\t\t}\r\n\t\t\tvar x = Math.round((THIS.hsv[0] / 360) * (THIS.width - 1));\r\n\t\t\tvar y = Math.round((1 - THIS.hsv[yComponent] / 100) * (THIS.height - 1));\r\n\t\t\tvar crossOuterSize = (2 * THIS.pointerBorderWidth + THIS.pointerThickness + 2 * THIS.crossSize);\r\n\t\t\tvar ofs = -Math.floor(crossOuterSize / 2);\r\n\t\t\tjsc.picker.cross.style.left = (x + ofs) + 'px';\r\n\t\t\tjsc.picker.cross.style.top = (y + ofs) + 'px';\r\n\r\n\t\t\t// redraw the slider\r\n\t\t\tswitch (jsc.getSliderComponent(THIS)) {\r\n\t\t\tcase 's':\r\n\t\t\t\tvar rgb1 = HSV_RGB(THIS.hsv[0], 100, THIS.hsv[2]);\r\n\t\t\t\tvar rgb2 = HSV_RGB(THIS.hsv[0], 0, THIS.hsv[2]);\r\n\t\t\t\tvar color1 = 'rgb(' +\r\n\t\t\t\t\tMath.round(rgb1[0]) + ',' +\r\n\t\t\t\t\tMath.round(rgb1[1]) + ',' +\r\n\t\t\t\t\tMath.round(rgb1[2]) + ')';\r\n\t\t\t\tvar color2 = 'rgb(' +\r\n\t\t\t\t\tMath.round(rgb2[0]) + ',' +\r\n\t\t\t\t\tMath.round(rgb2[1]) + ',' +\r\n\t\t\t\t\tMath.round(rgb2[2]) + ')';\r\n\t\t\t\tjsc.picker.sldGrad.draw(THIS.sliderSize, THIS.height, color1, color2);\r\n\t\t\t\tbreak;\r\n\t\t\tcase 'v':\r\n\t\t\t\tvar rgb = HSV_RGB(THIS.hsv[0], THIS.hsv[1], 100);\r\n\t\t\t\tvar color1 = 'rgb(' +\r\n\t\t\t\t\tMath.round(rgb[0]) + ',' +\r\n\t\t\t\t\tMath.round(rgb[1]) + ',' +\r\n\t\t\t\t\tMath.round(rgb[2]) + ')';\r\n\t\t\t\tvar color2 = '#000';\r\n\t\t\t\tjsc.picker.sldGrad.draw(THIS.sliderSize, THIS.height, color1, color2);\r\n\t\t\t\tbreak;\r\n\t\t\t}\r\n\t\t}\r\n\r\n\r\n\t\tfunction redrawSld () {\r\n\t\t\tvar sldComponent = jsc.getSliderComponent(THIS);\r\n\t\t\tif (sldComponent) {\r\n\t\t\t\t// redraw the slider pointer\r\n\t\t\t\tswitch (sldComponent) {\r\n\t\t\t\tcase 's': var yComponent = 1; break;\r\n\t\t\t\tcase 'v': var yComponent = 2; break;\r\n\t\t\t\t}\r\n\t\t\t\tvar y = Math.round((1 - THIS.hsv[yComponent] / 100) * (THIS.height - 1));\r\n\t\t\t\tjsc.picker.sldPtrOB.style.top = (y - (2 * THIS.pointerBorderWidth + THIS.pointerThickness) - Math.floor(sliderPtrSpace / 2)) + 'px';\r\n\t\t\t}\r\n\t\t}\r\n\r\n\r\n\t\tfunction isPickerOwner () {\r\n\t\t\treturn jsc.picker && jsc.picker.owner === THIS;\r\n\t\t}\r\n\r\n\r\n\t\tfunction blurValue () {\r\n\t\t\tTHIS.importColor();\r\n\t\t}\r\n\r\n\r\n\t\t// Find the target element\r\n\t\tif (typeof targetElement === 'string') {\r\n\t\t\tvar id = targetElement;\r\n\t\t\tvar elm = document.getElementById(id);\r\n\t\t\tif (elm) {\r\n\t\t\t\tthis.targetElement = elm;\r\n\t\t\t} else {\r\n\t\t\t\tjsc.warn('Could not find target element with ID \\'' + id + '\\'');\r\n\t\t\t}\r\n\t\t} else if (targetElement) {\r\n\t\t\tthis.targetElement = targetElement;\r\n\t\t} else {\r\n\t\t\tjsc.warn('Invalid target element: \\'' + targetElement + '\\'');\r\n\t\t}\r\n\r\n\t\tif (this.targetElement._jscLinkedInstance) {\r\n\t\t\tjsc.warn('Cannot link jscolor twice to the same element. Skipping.');\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tthis.targetElement._jscLinkedInstance = this;\r\n\r\n\t\t// Find the value element\r\n\t\tthis.valueElement = jsc.fetchElement(this.valueElement);\r\n\t\t// Find the style element\r\n\t\tthis.styleElement = jsc.fetchElement(this.styleElement);\r\n\r\n\t\tvar THIS = this;\r\n\t\tvar container =\r\n\t\t\tthis.container ?\r\n\t\t\tjsc.fetchElement(this.container) :\r\n\t\t\tdocument.getElementsByTagName('body')[0];\r\n\t\tvar sliderPtrSpace = 3; // px\r\n\r\n\t\t// For BUTTON elements it's important to stop them from sending the form when clicked\r\n\t\t// (e.g. in Safari)\r\n\t\tif (jsc.isElementType(this.targetElement, 'button')) {\r\n\t\t\tif (this.targetElement.onclick) {\r\n\t\t\t\tvar origCallback = this.targetElement.onclick;\r\n\t\t\t\tthis.targetElement.onclick = function (evt) {\r\n\t\t\t\t\torigCallback.call(this, evt);\r\n\t\t\t\t\treturn false;\r\n\t\t\t\t};\r\n\t\t\t} else {\r\n\t\t\t\tthis.targetElement.onclick = function () { return false; };\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\t/*\r\n\t\tvar elm = this.targetElement;\r\n\t\tdo {\r\n\t\t\t// If the target element or one of its offsetParents has fixed position,\r\n\t\t\t// then use fixed positioning instead\r\n\t\t\t//\r\n\t\t\t// Note: In Firefox, getComputedStyle returns null in a hidden iframe,\r\n\t\t\t// that's why we need to check if the returned style object is non-empty\r\n\t\t\tvar currStyle = jsc.getStyle(elm);\r\n\t\t\tif (currStyle && currStyle.position.toLowerCase() === 'fixed') {\r\n\t\t\t\tthis.fixed = true;\r\n\t\t\t}\r\n\r\n\t\t\tif (elm !== this.targetElement) {\r\n\t\t\t\t// attach onParentScroll so that we can recompute the picker position\r\n\t\t\t\t// when one of the offsetParents is scrolled\r\n\t\t\t\tif (!elm._jscEventsAttached) {\r\n\t\t\t\t\tjsc.attachEvent(elm, 'scroll', jsc.onParentScroll);\r\n\t\t\t\t\telm._jscEventsAttached = true;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t} while ((elm = elm.offsetParent) && !jsc.isElementType(elm, 'body'));\r\n\t\t*/\r\n\r\n\t\t// valueElement\r\n\t\tif (this.valueElement) {\r\n\t\t\tif (jsc.isElementType(this.valueElement, 'input')) {\r\n\t\t\t\tvar updateField = function () {\r\n\t\t\t\t\tTHIS.fromString(THIS.valueElement.value, jsc.leaveValue);\r\n\t\t\t\t\tjsc.dispatchFineChange(THIS);\r\n\t\t\t\t};\r\n\t\t\t\tjsc.attachEvent(this.valueElement, 'keyup', updateField);\r\n\t\t\t\tjsc.attachEvent(this.valueElement, 'input', updateField);\r\n\t\t\t\tjsc.attachEvent(this.valueElement, 'blur', blurValue);\r\n\t\t\t\tthis.valueElement.setAttribute('autocomplete', 'off');\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\t// styleElement\r\n\t\tif (this.styleElement) {\r\n\t\t\tthis.styleElement._jscOrigStyle = {\r\n\t\t\t\tbackgroundImage : this.styleElement.style.backgroundImage,\r\n\t\t\t\tbackgroundColor : this.styleElement.style.backgroundColor,\r\n\t\t\t\tcolor : this.styleElement.style.color\r\n\t\t\t};\r\n\t\t}\r\n\r\n\t\tif (this.value) {\r\n\t\t\t// Try to set the color from the .value option and if unsuccessful,\r\n\t\t\t// export the current color\r\n\t\t\tthis.fromString(this.value) || this.exportColor();\r\n\t\t} else {\r\n\t\t\tthis.importColor();\r\n\t\t}\r\n\t}\r\n\r\n};\r\n\r\n\r\n//================================\r\n// Public properties and methods\r\n//================================\r\n\r\n\r\n// By default, search for all elements with class=\"jscolor\" and install a color picker on them.\r\n//\r\n// You can change what class name will be looked for by setting the property jscolor.lookupClass\r\n// anywhere in your HTML document. To completely disable the automatic lookup, set it to null.\r\n//\r\njsc.jscolor.lookupClass = 'jscolor';\r\n\r\n\r\njsc.jscolor.installByClassName = function (className) {\r\n\tvar inputElms = document.getElementsByTagName('input');\r\n\tvar buttonElms = document.getElementsByTagName('button');\r\n\r\n\tjsc.tryInstallOnElements(inputElms, className);\r\n\tjsc.tryInstallOnElements(buttonElms, className);\r\n};\r\n\r\n\r\njsc.register();\r\n\r\n\r\nreturn jsc.jscolor;\r\n\r\n\r\n})(); }\r\n","yachtApp.controller('RoomController', function RoomController($scope) {\r\n  $.getJSON(\"/users\", function(data){\r\n    $scope.users = data.users;\r\n    $scope.$apply();\r\n  });\r\n});\r\n","/*====================================================================\r\n *\r\n * This file is used to setup all the necessary tools the other scripts need.\r\n *\r\n =====================================================================*/\r\n\r\n// Setup Angular\r\n// Define the `phonecatApp` module\r\nwindow.yachtApp = angular.module('yachtApp', []);\r\n\r\n//Setup Canvas \"stuff\"\r\n//========================\r\nwindow.currUser = \"\";\r\nwindow.cursorStates = {};\r\nwindow.drawing = false;\r\nwindow.mousePos = { x:0, y:0 };\r\nwindow.lastPos = mousePos;\r\n\r\n// Mouse Layer\r\nwindow.mouseCanvas = document.getElementById(\"mouse-canvas\");\r\nwindow.mouseCtx = mouseCanvas.getContext(\"2d\");\r\n\r\n// Drawing Layer\r\nwindow.collabCanvas = document.getElementById(\"collab-canvas\");\r\nwindow.ctx = collabCanvas.getContext(\"2d\");\r\nctx.strokeStyle = \"#222222\";\r\nctx.lineWidth = 2;\r\n","import \"phoenix_html\"\nimport {Socket} from \"phoenix\"\n\r\n// Initialize Socket.\r\nlet socket = new Socket(\"/socket\", {params: {token: window.userToken}});\r\n\r\n//Functions\r\n//=============================================\r\nfunction clearCanvas() {\r\n  collabCanvas.width = collabCanvas.width;\n}\n\r\nfunction reloadUserTable() {\r\n  var scope = $('#mainBody').scope();\r\n  $.getJSON(\"/users\", function(data){\r\n    scope.users = data.users;\r\n    scope.$apply();\r\n  });\r\n}\r\n\r\n//MAINLINE code\r\n//==============================================\r\n\r\n//Connect socket.\r\nsocket.connect();\r\nwindow.channel = socket.channel(\"room:lobby\", {});\n\nchannel.join()\n  .receive(\"ok\", resp => { console.log(\"Joined successfully\", resp) })\n  .receive(\"error\", resp => { console.log(\"Unable to join\", resp) });\n\n//Socket events\n//==========================\nchannel.on(\"drawline\", payload => {\r\n    ctx.moveTo(payload.from.x, payload.from.y);\r\n    ctx.lineTo(payload.to.x, payload.to.y);\r\n    ctx.stroke();\r\n});\r\n\r\nchannel.on(\"clear\", payload => {\r\n  console.log(\"Clearing canvas.\");\r\n  clearCanvas();\r\n});\r\n\r\nchannel.on(\"mousemove\", payload => {\r\n  var img = document.getElementById(\"cursor\");\r\n  img.display=\"inline\";\r\n  mouseCanvas.width = mouseCanvas.width;\r\n  if(payload.name != currUser)\r\n  {\r\n    cursorStates[payload.name] = {\"x\" : payload.position.x, \"y\" :  payload.position.y}\r\n  }\r\n\r\n  //Iterate through every cursor position and draw them all back. This may be slow...\r\n  var cursorKeys = Object.keys(cursorStates);\r\n  cursorKeys.forEach(function(currKey){\r\n    mouseCtx.drawImage(img, cursorStates[currKey].x, cursorStates[currKey].y);\r\n  });\r\n});\n\nchannel.on(\"userJoined\", payload =>{\n  console.log(\"Reloading User Table.\");\r\n  //Not sure why it only works if I give it a timeout, prolly an async somewhere.\r\n  setTimeout(reloadUserTable, 100);\r\n});\r\n","import \"./setup.js\"\nimport \"./roomcontroller.js\"\nimport \"./socket.js\"\n//Taken from http://jscolor.com/\nimport \"./jscolor.js\"\n\nfunction clearCanvas() {\n  collabCanvas.width = collabCanvas.width;\n}\n\nfunction downloadCanvas(link, canvasId, filename) {\n  link.href = collabCanvas.toDataURL();\n  link.download = filename;\n}\n\n$(document).ready(function(){\n   if(!currUser)\n   {\n     var baseName = \"Anon\" + Math.floor(Math.random() * 100);\n     currUser = baseName;\n     $(\"#username\").val(baseName);\n     channel.push(\"userJoined\", {\n       \"name\": currUser\n     });\n   }\n});\n\n$( \"#colorSelector\" ).change(function() {\n  var colorValue = \"#\" + this.value\n  ctx.strokeStyle = colorValue\n  console.log(\"Changing stroke color to \" + colorValue);\n});\n\ndocument.getElementById('downloadBtn').addEventListener('click', function() {\n    downloadCanvas(this, 'canvas', 'test.png');\n}, false);\n\n(function() {\n\t// Get a regular interval for drawing to the screen\n\twindow.requestAnimFrame = (function (callback) {\n\t\treturn window.requestAnimationFrame ||\n\t\t\t\t\twindow.webkitRequestAnimationFrame ||\n\t\t\t\t\twindow.mozRequestAnimationFrame ||\n\t\t\t\t\twindow.oRequestAnimationFrame ||\n\t\t\t\t\twindow.msRequestAnimaitonFrame ||\n\t\t\t\t\tfunction (callback) {\n\t\t\t\t\t \twindow.setTimeout(callback, 1000/60);\n\t\t\t\t\t};\n\t})();\n\t// Set up the UI\n\tvar clearBtn = document.getElementById(\"clearBtn\");\n\tclearBtn.addEventListener(\"click\", function (e) {\n    channel.push(\"clear\", { });\n\t\tclearCanvas();\n\t}, false);\n\n  var changeUserBtn = document.getElementById(\"enterUser\");\n  changeUserBtn.addEventListener(\"click\", function (e) {\n      channel.push(\"userJoined\", { });\n  }, false);\n\n  //Drawing events for desktop\n\tmouseCanvas.addEventListener(\"mousedown\", function (e) {\n\t\tdrawing = true;\n\t\tlastPos = getMousePos(collabCanvas, e);\n\t}, false);\n\tmouseCanvas.addEventListener(\"mouseup\", function (e) {\n\t\tdrawing = false;\n\t}, false);\n\tmouseCanvas.addEventListener(\"mousemove\", function (e) {\n\t\tmousePos = getMousePos(collabCanvas, e);\n    channel.push(\"mousemove\", {\n      \"name\": currUser,\n      \"position\" : {\n        \"x\" : mousePos.x,\n        \"y\" : mousePos.y\n      }\n    });\n\t}, false);\n\n\t// Drawing events for Mobile\n\tcollabCanvas.addEventListener(\"touchstart\", function (e) {\n\t\tmousePos = getTouchPos(collabCanvas, e);\n\t\tvar touch = e.touches[0];\n\t\tvar mouseEvent = new MouseEvent(\"mousedown\", {\n\t\t\tclientX: touch.clientX,\n\t\t\tclientY: touch.clientY\n\t\t});\n\t\tcanvas.dispatchEvent(mouseEvent);\n\t}, false);\n\tcollabCanvas.addEventListener(\"touchend\", function (e) {\n\t\tvar mouseEvent = new MouseEvent(\"mouseup\", {});\n\t\tcanvas.dispatchEvent(mouseEvent);\n\t}, false);\n\tcollabCanvas.addEventListener(\"touchmove\", function (e) {\n\t\tvar touch = e.touches[0];\n\t\tvar mouseEvent = new MouseEvent(\"mousemove\", {\n\t\t\tclientX: touch.clientX,\n\t\t\tclientY: touch.clientY\n\t\t});\n\t\tcanvas.dispatchEvent(mouseEvent);\n\t}, false);\n\n\t// Prevent scrolling when touching the canvas\n\tdocument.body.addEventListener(\"touchstart\", function (e) {\n\t\tif (e.target == canvas) {\n\t\t\te.preventDefault();\n\t\t}\n\t}, false);\n\tdocument.body.addEventListener(\"touchend\", function (e) {\n\t\tif (e.target == canvas) {\n\t\t\te.preventDefault();\n\t\t}\n\t}, false);\n\tdocument.body.addEventListener(\"touchmove\", function (e) {\n\t\tif (e.target == canvas) {\n\t\t\te.preventDefault();\n\t\t}\n\t}, false);\n\n\t// Get the position of the mouse relative to the canvas\n\tfunction getMousePos(canvasDom, mouseEvent) {\n\t\tvar rect = canvasDom.getBoundingClientRect();\n\t\treturn {\n\t\t\tx: mouseEvent.clientX - rect.left,\n\t\t\ty: mouseEvent.clientY - rect.top\n\t\t};\n\t}\n\n\t// Get the position of a touch relative to the canvas\n\tfunction getTouchPos(canvasDom, touchEvent) {\n\t\tvar rect = canvasDom.getBoundingClientRect();\n\t\treturn {\n\t\t\tx: touchEvent.touches[0].clientX - rect.left,\n\t\t\ty: touchEvent.touches[0].clientY - rect.top\n\t\t};\n\t}\n\n\t// Draw to the canvas\n\tfunction renderCanvas() {\n\t\tif (drawing) {\n      if(lastPos.x != mousePos.x || lastPos.y != mousePos.y)\n      {\n        channel.push(\"drawline\", {\n          from : {\n            x : lastPos.x,\n            y : lastPos.y\n          },\n          to : {\n            x : mousePos.x,\n            y : mousePos.y\n          }\n        });\n      }\n\t\t\tctx.moveTo(lastPos.x, lastPos.y);\n\t\t\tctx.lineTo(mousePos.x, mousePos.y);\n\t\t\tctx.stroke();\n\t\t\tlastPos = mousePos;\n\t\t}\n\t}\n\n\t// Allow for animation\n\t(function drawLoop () {\n\t\trequestAnimFrame(drawLoop);\n\t\trenderCanvas();\n\t})();\n\n})();\n","/**\r\n * jscolor - JavaScript Color Picker\r\n *\r\n * @link    http://jscolor.com\r\n * @license For open source use: GPLv3\r\n *          For commercial use: JSColor Commercial License\r\n * @author  Jan Odvarko\r\n * @version 2.0.4\r\n *\r\n * See usage examples at http://jscolor.com/examples/\r\n */\r\n\r\n\r\n\"use strict\";\r\n\r\n\r\nif (!window.jscolor) { window.jscolor = (function () {\r\n\r\n\r\nvar jsc = {\r\n\r\n\r\n\tregister : function () {\r\n\t\tjsc.attachDOMReadyEvent(jsc.init);\r\n\t\tjsc.attachEvent(document, 'mousedown', jsc.onDocumentMouseDown);\r\n\t\tjsc.attachEvent(document, 'touchstart', jsc.onDocumentTouchStart);\r\n\t\tjsc.attachEvent(window, 'resize', jsc.onWindowResize);\r\n\t},\r\n\r\n\r\n\tinit : function () {\r\n\t\tif (jsc.jscolor.lookupClass) {\r\n\t\t\tjsc.jscolor.installByClassName(jsc.jscolor.lookupClass);\r\n\t\t}\r\n\t},\r\n\r\n\r\n\ttryInstallOnElements : function (elms, className) {\r\n\t\tvar matchClass = new RegExp('(^|\\\\s)(' + className + ')(\\\\s*(\\\\{[^}]*\\\\})|\\\\s|$)', 'i');\r\n\r\n\t\tfor (var i = 0; i < elms.length; i += 1) {\r\n\t\t\tif (elms[i].type !== undefined && elms[i].type.toLowerCase() == 'color') {\r\n\t\t\t\tif (jsc.isColorAttrSupported) {\r\n\t\t\t\t\t// skip inputs of type 'color' if supported by the browser\r\n\t\t\t\t\tcontinue;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tvar m;\r\n\t\t\tif (!elms[i].jscolor && elms[i].className && (m = elms[i].className.match(matchClass))) {\r\n\t\t\t\tvar targetElm = elms[i];\r\n\t\t\t\tvar optsStr = null;\r\n\r\n\t\t\t\tvar dataOptions = jsc.getDataAttr(targetElm, 'jscolor');\r\n\t\t\t\tif (dataOptions !== null) {\r\n\t\t\t\t\toptsStr = dataOptions;\r\n\t\t\t\t} else if (m[4]) {\r\n\t\t\t\t\toptsStr = m[4];\r\n\t\t\t\t}\r\n\r\n\t\t\t\tvar opts = {};\r\n\t\t\t\tif (optsStr) {\r\n\t\t\t\t\ttry {\r\n\t\t\t\t\t\topts = (new Function ('return (' + optsStr + ')'))();\r\n\t\t\t\t\t} catch(eParseError) {\r\n\t\t\t\t\t\tjsc.warn('Error parsing jscolor options: ' + eParseError + ':\\n' + optsStr);\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\ttargetElm.jscolor = new jsc.jscolor(targetElm, opts);\r\n\t\t\t}\r\n\t\t}\r\n\t},\r\n\r\n\r\n\tisColorAttrSupported : (function () {\r\n\t\tvar elm = document.createElement('input');\r\n\t\tif (elm.setAttribute) {\r\n\t\t\telm.setAttribute('type', 'color');\r\n\t\t\tif (elm.type.toLowerCase() == 'color') {\r\n\t\t\t\treturn true;\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn false;\r\n\t})(),\r\n\r\n\r\n\tisCanvasSupported : (function () {\r\n\t\tvar elm = document.createElement('canvas');\r\n\t\treturn !!(elm.getContext && elm.getContext('2d'));\r\n\t})(),\r\n\r\n\r\n\tfetchElement : function (mixed) {\r\n\t\treturn typeof mixed === 'string' ? document.getElementById(mixed) : mixed;\r\n\t},\r\n\r\n\r\n\tisElementType : function (elm, type) {\r\n\t\treturn elm.nodeName.toLowerCase() === type.toLowerCase();\r\n\t},\r\n\r\n\r\n\tgetDataAttr : function (el, name) {\r\n\t\tvar attrName = 'data-' + name;\r\n\t\tvar attrValue = el.getAttribute(attrName);\r\n\t\tif (attrValue !== null) {\r\n\t\t\treturn attrValue;\r\n\t\t}\r\n\t\treturn null;\r\n\t},\r\n\r\n\r\n\tattachEvent : function (el, evnt, func) {\r\n\t\tif (el.addEventListener) {\r\n\t\t\tel.addEventListener(evnt, func, false);\r\n\t\t} else if (el.attachEvent) {\r\n\t\t\tel.attachEvent('on' + evnt, func);\r\n\t\t}\r\n\t},\r\n\r\n\r\n\tdetachEvent : function (el, evnt, func) {\r\n\t\tif (el.removeEventListener) {\r\n\t\t\tel.removeEventListener(evnt, func, false);\r\n\t\t} else if (el.detachEvent) {\r\n\t\t\tel.detachEvent('on' + evnt, func);\r\n\t\t}\r\n\t},\r\n\r\n\r\n\t_attachedGroupEvents : {},\r\n\r\n\r\n\tattachGroupEvent : function (groupName, el, evnt, func) {\r\n\t\tif (!jsc._attachedGroupEvents.hasOwnProperty(groupName)) {\r\n\t\t\tjsc._attachedGroupEvents[groupName] = [];\r\n\t\t}\r\n\t\tjsc._attachedGroupEvents[groupName].push([el, evnt, func]);\r\n\t\tjsc.attachEvent(el, evnt, func);\r\n\t},\r\n\r\n\r\n\tdetachGroupEvents : function (groupName) {\r\n\t\tif (jsc._attachedGroupEvents.hasOwnProperty(groupName)) {\r\n\t\t\tfor (var i = 0; i < jsc._attachedGroupEvents[groupName].length; i += 1) {\r\n\t\t\t\tvar evt = jsc._attachedGroupEvents[groupName][i];\r\n\t\t\t\tjsc.detachEvent(evt[0], evt[1], evt[2]);\r\n\t\t\t}\r\n\t\t\tdelete jsc._attachedGroupEvents[groupName];\r\n\t\t}\r\n\t},\r\n\r\n\r\n\tattachDOMReadyEvent : function (func) {\r\n\t\tvar fired = false;\r\n\t\tvar fireOnce = function () {\r\n\t\t\tif (!fired) {\r\n\t\t\t\tfired = true;\r\n\t\t\t\tfunc();\r\n\t\t\t}\r\n\t\t};\r\n\r\n\t\tif (document.readyState === 'complete') {\r\n\t\t\tsetTimeout(fireOnce, 1); // async\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tif (document.addEventListener) {\r\n\t\t\tdocument.addEventListener('DOMContentLoaded', fireOnce, false);\r\n\r\n\t\t\t// Fallback\r\n\t\t\twindow.addEventListener('load', fireOnce, false);\r\n\r\n\t\t} else if (document.attachEvent) {\r\n\t\t\t// IE\r\n\t\t\tdocument.attachEvent('onreadystatechange', function () {\r\n\t\t\t\tif (document.readyState === 'complete') {\r\n\t\t\t\t\tdocument.detachEvent('onreadystatechange', arguments.callee);\r\n\t\t\t\t\tfireOnce();\r\n\t\t\t\t}\r\n\t\t\t})\r\n\r\n\t\t\t// Fallback\r\n\t\t\twindow.attachEvent('onload', fireOnce);\r\n\r\n\t\t\t// IE7/8\r\n\t\t\tif (document.documentElement.doScroll && window == window.top) {\r\n\t\t\t\tvar tryScroll = function () {\r\n\t\t\t\t\tif (!document.body) { return; }\r\n\t\t\t\t\ttry {\r\n\t\t\t\t\t\tdocument.documentElement.doScroll('left');\r\n\t\t\t\t\t\tfireOnce();\r\n\t\t\t\t\t} catch (e) {\r\n\t\t\t\t\t\tsetTimeout(tryScroll, 1);\r\n\t\t\t\t\t}\r\n\t\t\t\t};\r\n\t\t\t\ttryScroll();\r\n\t\t\t}\r\n\t\t}\r\n\t},\r\n\r\n\r\n\twarn : function (msg) {\r\n\t\tif (window.console && window.console.warn) {\r\n\t\t\twindow.console.warn(msg);\r\n\t\t}\r\n\t},\r\n\r\n\r\n\tpreventDefault : function (e) {\r\n\t\tif (e.preventDefault) { e.preventDefault(); }\r\n\t\te.returnValue = false;\r\n\t},\r\n\r\n\r\n\tcaptureTarget : function (target) {\r\n\t\t// IE\r\n\t\tif (target.setCapture) {\r\n\t\t\tjsc._capturedTarget = target;\r\n\t\t\tjsc._capturedTarget.setCapture();\r\n\t\t}\r\n\t},\r\n\r\n\r\n\treleaseTarget : function () {\r\n\t\t// IE\r\n\t\tif (jsc._capturedTarget) {\r\n\t\t\tjsc._capturedTarget.releaseCapture();\r\n\t\t\tjsc._capturedTarget = null;\r\n\t\t}\r\n\t},\r\n\r\n\r\n\tfireEvent : function (el, evnt) {\r\n\t\tif (!el) {\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tif (document.createEvent) {\r\n\t\t\tvar ev = document.createEvent('HTMLEvents');\r\n\t\t\tev.initEvent(evnt, true, true);\r\n\t\t\tel.dispatchEvent(ev);\r\n\t\t} else if (document.createEventObject) {\r\n\t\t\tvar ev = document.createEventObject();\r\n\t\t\tel.fireEvent('on' + evnt, ev);\r\n\t\t} else if (el['on' + evnt]) { // alternatively use the traditional event model\r\n\t\t\tel['on' + evnt]();\r\n\t\t}\r\n\t},\r\n\r\n\r\n\tclassNameToList : function (className) {\r\n\t\treturn className.replace(/^\\s+|\\s+$/g, '').split(/\\s+/);\r\n\t},\r\n\r\n\r\n\t// The className parameter (str) can only contain a single class name\r\n\thasClass : function (elm, className) {\r\n\t\tif (!className) {\r\n\t\t\treturn false;\r\n\t\t}\r\n\t\treturn -1 != (' ' + elm.className.replace(/\\s+/g, ' ') + ' ').indexOf(' ' + className + ' ');\r\n\t},\r\n\r\n\r\n\t// The className parameter (str) can contain multiple class names separated by whitespace\r\n\tsetClass : function (elm, className) {\r\n\t\tvar classList = jsc.classNameToList(className);\r\n\t\tfor (var i = 0; i < classList.length; i += 1) {\r\n\t\t\tif (!jsc.hasClass(elm, classList[i])) {\r\n\t\t\t\telm.className += (elm.className ? ' ' : '') + classList[i];\r\n\t\t\t}\r\n\t\t}\r\n\t},\r\n\r\n\r\n\t// The className parameter (str) can contain multiple class names separated by whitespace\r\n\tunsetClass : function (elm, className) {\r\n\t\tvar classList = jsc.classNameToList(className);\r\n\t\tfor (var i = 0; i < classList.length; i += 1) {\r\n\t\t\tvar repl = new RegExp(\r\n\t\t\t\t'^\\\\s*' + classList[i] + '\\\\s*|' +\r\n\t\t\t\t'\\\\s*' + classList[i] + '\\\\s*$|' +\r\n\t\t\t\t'\\\\s+' + classList[i] + '(\\\\s+)',\r\n\t\t\t\t'g'\r\n\t\t\t);\r\n\t\t\telm.className = elm.className.replace(repl, '$1');\r\n\t\t}\r\n\t},\r\n\r\n\r\n\tgetStyle : function (elm) {\r\n\t\treturn window.getComputedStyle ? window.getComputedStyle(elm) : elm.currentStyle;\r\n\t},\r\n\r\n\r\n\tsetStyle : (function () {\r\n\t\tvar helper = document.createElement('div');\r\n\t\tvar getSupportedProp = function (names) {\r\n\t\t\tfor (var i = 0; i < names.length; i += 1) {\r\n\t\t\t\tif (names[i] in helper.style) {\r\n\t\t\t\t\treturn names[i];\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t};\r\n\t\tvar props = {\r\n\t\t\tborderRadius: getSupportedProp(['borderRadius', 'MozBorderRadius', 'webkitBorderRadius']),\r\n\t\t\tboxShadow: getSupportedProp(['boxShadow', 'MozBoxShadow', 'webkitBoxShadow'])\r\n\t\t};\r\n\t\treturn function (elm, prop, value) {\r\n\t\t\tswitch (prop.toLowerCase()) {\r\n\t\t\tcase 'opacity':\r\n\t\t\t\tvar alphaOpacity = Math.round(parseFloat(value) * 100);\r\n\t\t\t\telm.style.opacity = value;\r\n\t\t\t\telm.style.filter = 'alpha(opacity=' + alphaOpacity + ')';\r\n\t\t\t\tbreak;\r\n\t\t\tdefault:\r\n\t\t\t\telm.style[props[prop]] = value;\r\n\t\t\t\tbreak;\r\n\t\t\t}\r\n\t\t};\r\n\t})(),\r\n\r\n\r\n\tsetBorderRadius : function (elm, value) {\r\n\t\tjsc.setStyle(elm, 'borderRadius', value || '0');\r\n\t},\r\n\r\n\r\n\tsetBoxShadow : function (elm, value) {\r\n\t\tjsc.setStyle(elm, 'boxShadow', value || 'none');\r\n\t},\r\n\r\n\r\n\tgetElementPos : function (e, relativeToViewport) {\r\n\t\tvar x=0, y=0;\r\n\t\tvar rect = e.getBoundingClientRect();\r\n\t\tx = rect.left;\r\n\t\ty = rect.top;\r\n\t\tif (!relativeToViewport) {\r\n\t\t\tvar viewPos = jsc.getViewPos();\r\n\t\t\tx += viewPos[0];\r\n\t\t\ty += viewPos[1];\r\n\t\t}\r\n\t\treturn [x, y];\r\n\t},\r\n\r\n\r\n\tgetElementSize : function (e) {\r\n\t\treturn [e.offsetWidth, e.offsetHeight];\r\n\t},\r\n\r\n\r\n\t// get pointer's X/Y coordinates relative to viewport\r\n\tgetAbsPointerPos : function (e) {\r\n\t\tif (!e) { e = window.event; }\r\n\t\tvar x = 0, y = 0;\r\n\t\tif (typeof e.changedTouches !== 'undefined' && e.changedTouches.length) {\r\n\t\t\t// touch devices\r\n\t\t\tx = e.changedTouches[0].clientX;\r\n\t\t\ty = e.changedTouches[0].clientY;\r\n\t\t} else if (typeof e.clientX === 'number') {\r\n\t\t\tx = e.clientX;\r\n\t\t\ty = e.clientY;\r\n\t\t}\r\n\t\treturn { x: x, y: y };\r\n\t},\r\n\r\n\r\n\t// get pointer's X/Y coordinates relative to target element\r\n\tgetRelPointerPos : function (e) {\r\n\t\tif (!e) { e = window.event; }\r\n\t\tvar target = e.target || e.srcElement;\r\n\t\tvar targetRect = target.getBoundingClientRect();\r\n\r\n\t\tvar x = 0, y = 0;\r\n\r\n\t\tvar clientX = 0, clientY = 0;\r\n\t\tif (typeof e.changedTouches !== 'undefined' && e.changedTouches.length) {\r\n\t\t\t// touch devices\r\n\t\t\tclientX = e.changedTouches[0].clientX;\r\n\t\t\tclientY = e.changedTouches[0].clientY;\r\n\t\t} else if (typeof e.clientX === 'number') {\r\n\t\t\tclientX = e.clientX;\r\n\t\t\tclientY = e.clientY;\r\n\t\t}\r\n\r\n\t\tx = clientX - targetRect.left;\r\n\t\ty = clientY - targetRect.top;\r\n\t\treturn { x: x, y: y };\r\n\t},\r\n\r\n\r\n\tgetViewPos : function () {\r\n\t\tvar doc = document.documentElement;\r\n\t\treturn [\r\n\t\t\t(window.pageXOffset || doc.scrollLeft) - (doc.clientLeft || 0),\r\n\t\t\t(window.pageYOffset || doc.scrollTop) - (doc.clientTop || 0)\r\n\t\t];\r\n\t},\r\n\r\n\r\n\tgetViewSize : function () {\r\n\t\tvar doc = document.documentElement;\r\n\t\treturn [\r\n\t\t\t(window.innerWidth || doc.clientWidth),\r\n\t\t\t(window.innerHeight || doc.clientHeight),\r\n\t\t];\r\n\t},\r\n\r\n\r\n\tredrawPosition : function () {\r\n\r\n\t\tif (jsc.picker && jsc.picker.owner) {\r\n\t\t\tvar thisObj = jsc.picker.owner;\r\n\r\n\t\t\tvar tp, vp;\r\n\r\n\t\t\tif (thisObj.fixed) {\r\n\t\t\t\t// Fixed elements are positioned relative to viewport,\r\n\t\t\t\t// therefore we can ignore the scroll offset\r\n\t\t\t\ttp = jsc.getElementPos(thisObj.targetElement, true); // target pos\r\n\t\t\t\tvp = [0, 0]; // view pos\r\n\t\t\t} else {\r\n\t\t\t\ttp = jsc.getElementPos(thisObj.targetElement); // target pos\r\n\t\t\t\tvp = jsc.getViewPos(); // view pos\r\n\t\t\t}\r\n\r\n\t\t\tvar ts = jsc.getElementSize(thisObj.targetElement); // target size\r\n\t\t\tvar vs = jsc.getViewSize(); // view size\r\n\t\t\tvar ps = jsc.getPickerOuterDims(thisObj); // picker size\r\n\t\t\tvar a, b, c;\r\n\t\t\tswitch (thisObj.position.toLowerCase()) {\r\n\t\t\t\tcase 'left': a=1; b=0; c=-1; break;\r\n\t\t\t\tcase 'right':a=1; b=0; c=1; break;\r\n\t\t\t\tcase 'top':  a=0; b=1; c=-1; break;\r\n\t\t\t\tdefault:     a=0; b=1; c=1; break;\r\n\t\t\t}\r\n\t\t\tvar l = (ts[b]+ps[b])/2;\r\n\r\n\t\t\t// compute picker position\r\n\t\t\tif (!thisObj.smartPosition) {\r\n\t\t\t\tvar pp = [\r\n\t\t\t\t\ttp[a],\r\n\t\t\t\t\ttp[b]+ts[b]-l+l*c\r\n\t\t\t\t];\r\n\t\t\t} else {\r\n\t\t\t\tvar pp = [\r\n\t\t\t\t\t-vp[a]+tp[a]+ps[a] > vs[a] ?\r\n\t\t\t\t\t\t(-vp[a]+tp[a]+ts[a]/2 > vs[a]/2 && tp[a]+ts[a]-ps[a] >= 0 ? tp[a]+ts[a]-ps[a] : tp[a]) :\r\n\t\t\t\t\t\ttp[a],\r\n\t\t\t\t\t-vp[b]+tp[b]+ts[b]+ps[b]-l+l*c > vs[b] ?\r\n\t\t\t\t\t\t(-vp[b]+tp[b]+ts[b]/2 > vs[b]/2 && tp[b]+ts[b]-l-l*c >= 0 ? tp[b]+ts[b]-l-l*c : tp[b]+ts[b]-l+l*c) :\r\n\t\t\t\t\t\t(tp[b]+ts[b]-l+l*c >= 0 ? tp[b]+ts[b]-l+l*c : tp[b]+ts[b]-l-l*c)\r\n\t\t\t\t];\r\n\t\t\t}\r\n\r\n\t\t\tvar x = pp[a];\r\n\t\t\tvar y = pp[b];\r\n\t\t\tvar positionValue = thisObj.fixed ? 'fixed' : 'absolute';\r\n\t\t\tvar contractShadow =\r\n\t\t\t\t(pp[0] + ps[0] > tp[0] || pp[0] < tp[0] + ts[0]) &&\r\n\t\t\t\t(pp[1] + ps[1] < tp[1] + ts[1]);\r\n\r\n\t\t\tjsc._drawPosition(thisObj, x, y, positionValue, contractShadow);\r\n\t\t}\r\n\t},\r\n\r\n\r\n\t_drawPosition : function (thisObj, x, y, positionValue, contractShadow) {\r\n\t\tvar vShadow = contractShadow ? 0 : thisObj.shadowBlur; // px\r\n\r\n\t\tjsc.picker.wrap.style.position = positionValue;\r\n\t\tjsc.picker.wrap.style.left = x + 'px';\r\n\t\tjsc.picker.wrap.style.top = y + 'px';\r\n\r\n\t\tjsc.setBoxShadow(\r\n\t\t\tjsc.picker.boxS,\r\n\t\t\tthisObj.shadow ?\r\n\t\t\t\tnew jsc.BoxShadow(0, vShadow, thisObj.shadowBlur, 0, thisObj.shadowColor) :\r\n\t\t\t\tnull);\r\n\t},\r\n\r\n\r\n\tgetPickerDims : function (thisObj) {\r\n\t\tvar displaySlider = !!jsc.getSliderComponent(thisObj);\r\n\t\tvar dims = [\r\n\t\t\t2 * thisObj.insetWidth + 2 * thisObj.padding + thisObj.width +\r\n\t\t\t\t(displaySlider ? 2 * thisObj.insetWidth + jsc.getPadToSliderPadding(thisObj) + thisObj.sliderSize : 0),\r\n\t\t\t2 * thisObj.insetWidth + 2 * thisObj.padding + thisObj.height +\r\n\t\t\t\t(thisObj.closable ? 2 * thisObj.insetWidth + thisObj.padding + thisObj.buttonHeight : 0)\r\n\t\t];\r\n\t\treturn dims;\r\n\t},\r\n\r\n\r\n\tgetPickerOuterDims : function (thisObj) {\r\n\t\tvar dims = jsc.getPickerDims(thisObj);\r\n\t\treturn [\r\n\t\t\tdims[0] + 2 * thisObj.borderWidth,\r\n\t\t\tdims[1] + 2 * thisObj.borderWidth\r\n\t\t];\r\n\t},\r\n\r\n\r\n\tgetPadToSliderPadding : function (thisObj) {\r\n\t\treturn Math.max(thisObj.padding, 1.5 * (2 * thisObj.pointerBorderWidth + thisObj.pointerThickness));\r\n\t},\r\n\r\n\r\n\tgetPadYComponent : function (thisObj) {\r\n\t\tswitch (thisObj.mode.charAt(1).toLowerCase()) {\r\n\t\t\tcase 'v': return 'v'; break;\r\n\t\t}\r\n\t\treturn 's';\r\n\t},\r\n\r\n\r\n\tgetSliderComponent : function (thisObj) {\r\n\t\tif (thisObj.mode.length > 2) {\r\n\t\t\tswitch (thisObj.mode.charAt(2).toLowerCase()) {\r\n\t\t\t\tcase 's': return 's'; break;\r\n\t\t\t\tcase 'v': return 'v'; break;\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn null;\r\n\t},\r\n\r\n\r\n\tonDocumentMouseDown : function (e) {\r\n\t\tif (!e) { e = window.event; }\r\n\t\tvar target = e.target || e.srcElement;\r\n\r\n\t\tif (target._jscLinkedInstance) {\r\n\t\t\tif (target._jscLinkedInstance.showOnClick) {\r\n\t\t\t\ttarget._jscLinkedInstance.show();\r\n\t\t\t}\r\n\t\t} else if (target._jscControlName) {\r\n\t\t\tjsc.onControlPointerStart(e, target, target._jscControlName, 'mouse');\r\n\t\t} else {\r\n\t\t\t// Mouse is outside the picker controls -> hide the color picker!\r\n\t\t\tif (jsc.picker && jsc.picker.owner) {\r\n\t\t\t\tjsc.picker.owner.hide();\r\n\t\t\t}\r\n\t\t}\r\n\t},\r\n\r\n\r\n\tonDocumentTouchStart : function (e) {\r\n\t\tif (!e) { e = window.event; }\r\n\t\tvar target = e.target || e.srcElement;\r\n\r\n\t\tif (target._jscLinkedInstance) {\r\n\t\t\tif (target._jscLinkedInstance.showOnClick) {\r\n\t\t\t\ttarget._jscLinkedInstance.show();\r\n\t\t\t}\r\n\t\t} else if (target._jscControlName) {\r\n\t\t\tjsc.onControlPointerStart(e, target, target._jscControlName, 'touch');\r\n\t\t} else {\r\n\t\t\tif (jsc.picker && jsc.picker.owner) {\r\n\t\t\t\tjsc.picker.owner.hide();\r\n\t\t\t}\r\n\t\t}\r\n\t},\r\n\r\n\r\n\tonWindowResize : function (e) {\r\n\t\tjsc.redrawPosition();\r\n\t},\r\n\r\n\r\n\tonParentScroll : function (e) {\r\n\t\t// hide the picker when one of the parent elements is scrolled\r\n\t\tif (jsc.picker && jsc.picker.owner) {\r\n\t\t\tjsc.picker.owner.hide();\r\n\t\t}\r\n\t},\r\n\r\n\r\n\t_pointerMoveEvent : {\r\n\t\tmouse: 'mousemove',\r\n\t\ttouch: 'touchmove'\r\n\t},\r\n\t_pointerEndEvent : {\r\n\t\tmouse: 'mouseup',\r\n\t\ttouch: 'touchend'\r\n\t},\r\n\r\n\r\n\t_pointerOrigin : null,\r\n\t_capturedTarget : null,\r\n\r\n\r\n\tonControlPointerStart : function (e, target, controlName, pointerType) {\r\n\t\tvar thisObj = target._jscInstance;\r\n\r\n\t\tjsc.preventDefault(e);\r\n\t\tjsc.captureTarget(target);\r\n\r\n\t\tvar registerDragEvents = function (doc, offset) {\r\n\t\t\tjsc.attachGroupEvent('drag', doc, jsc._pointerMoveEvent[pointerType],\r\n\t\t\t\tjsc.onDocumentPointerMove(e, target, controlName, pointerType, offset));\r\n\t\t\tjsc.attachGroupEvent('drag', doc, jsc._pointerEndEvent[pointerType],\r\n\t\t\t\tjsc.onDocumentPointerEnd(e, target, controlName, pointerType));\r\n\t\t};\r\n\r\n\t\tregisterDragEvents(document, [0, 0]);\r\n\r\n\t\tif (window.parent && window.frameElement) {\r\n\t\t\tvar rect = window.frameElement.getBoundingClientRect();\r\n\t\t\tvar ofs = [-rect.left, -rect.top];\r\n\t\t\tregisterDragEvents(window.parent.window.document, ofs);\r\n\t\t}\r\n\r\n\t\tvar abs = jsc.getAbsPointerPos(e);\r\n\t\tvar rel = jsc.getRelPointerPos(e);\r\n\t\tjsc._pointerOrigin = {\r\n\t\t\tx: abs.x - rel.x,\r\n\t\t\ty: abs.y - rel.y\r\n\t\t};\r\n\r\n\t\tswitch (controlName) {\r\n\t\tcase 'pad':\r\n\t\t\t// if the slider is at the bottom, move it up\r\n\t\t\tswitch (jsc.getSliderComponent(thisObj)) {\r\n\t\t\tcase 's': if (thisObj.hsv[1] === 0) { thisObj.fromHSV(null, 100, null); }; break;\r\n\t\t\tcase 'v': if (thisObj.hsv[2] === 0) { thisObj.fromHSV(null, null, 100); }; break;\r\n\t\t\t}\r\n\t\t\tjsc.setPad(thisObj, e, 0, 0);\r\n\t\t\tbreak;\r\n\r\n\t\tcase 'sld':\r\n\t\t\tjsc.setSld(thisObj, e, 0);\r\n\t\t\tbreak;\r\n\t\t}\r\n\r\n\t\tjsc.dispatchFineChange(thisObj);\r\n\t},\r\n\r\n\r\n\tonDocumentPointerMove : function (e, target, controlName, pointerType, offset) {\r\n\t\treturn function (e) {\r\n\t\t\tvar thisObj = target._jscInstance;\r\n\t\t\tswitch (controlName) {\r\n\t\t\tcase 'pad':\r\n\t\t\t\tif (!e) { e = window.event; }\r\n\t\t\t\tjsc.setPad(thisObj, e, offset[0], offset[1]);\r\n\t\t\t\tjsc.dispatchFineChange(thisObj);\r\n\t\t\t\tbreak;\r\n\r\n\t\t\tcase 'sld':\r\n\t\t\t\tif (!e) { e = window.event; }\r\n\t\t\t\tjsc.setSld(thisObj, e, offset[1]);\r\n\t\t\t\tjsc.dispatchFineChange(thisObj);\r\n\t\t\t\tbreak;\r\n\t\t\t}\r\n\t\t}\r\n\t},\r\n\r\n\r\n\tonDocumentPointerEnd : function (e, target, controlName, pointerType) {\r\n\t\treturn function (e) {\r\n\t\t\tvar thisObj = target._jscInstance;\r\n\t\t\tjsc.detachGroupEvents('drag');\r\n\t\t\tjsc.releaseTarget();\r\n\t\t\t// Always dispatch changes after detaching outstanding mouse handlers,\r\n\t\t\t// in case some user interaction will occur in user's onchange callback\r\n\t\t\t// that would intrude with current mouse events\r\n\t\t\tjsc.dispatchChange(thisObj);\r\n\t\t};\r\n\t},\r\n\r\n\r\n\tdispatchChange : function (thisObj) {\r\n\t\tif (thisObj.valueElement) {\r\n\t\t\tif (jsc.isElementType(thisObj.valueElement, 'input')) {\r\n\t\t\t\tjsc.fireEvent(thisObj.valueElement, 'change');\r\n\t\t\t}\r\n\t\t}\r\n\t},\r\n\r\n\r\n\tdispatchFineChange : function (thisObj) {\r\n\t\tif (thisObj.onFineChange) {\r\n\t\t\tvar callback;\r\n\t\t\tif (typeof thisObj.onFineChange === 'string') {\r\n\t\t\t\tcallback = new Function (thisObj.onFineChange);\r\n\t\t\t} else {\r\n\t\t\t\tcallback = thisObj.onFineChange;\r\n\t\t\t}\r\n\t\t\tcallback.call(thisObj);\r\n\t\t}\r\n\t},\r\n\r\n\r\n\tsetPad : function (thisObj, e, ofsX, ofsY) {\r\n\t\tvar pointerAbs = jsc.getAbsPointerPos(e);\r\n\t\tvar x = ofsX + pointerAbs.x - jsc._pointerOrigin.x - thisObj.padding - thisObj.insetWidth;\r\n\t\tvar y = ofsY + pointerAbs.y - jsc._pointerOrigin.y - thisObj.padding - thisObj.insetWidth;\r\n\r\n\t\tvar xVal = x * (360 / (thisObj.width - 1));\r\n\t\tvar yVal = 100 - (y * (100 / (thisObj.height - 1)));\r\n\r\n\t\tswitch (jsc.getPadYComponent(thisObj)) {\r\n\t\tcase 's': thisObj.fromHSV(xVal, yVal, null, jsc.leaveSld); break;\r\n\t\tcase 'v': thisObj.fromHSV(xVal, null, yVal, jsc.leaveSld); break;\r\n\t\t}\r\n\t},\r\n\r\n\r\n\tsetSld : function (thisObj, e, ofsY) {\r\n\t\tvar pointerAbs = jsc.getAbsPointerPos(e);\r\n\t\tvar y = ofsY + pointerAbs.y - jsc._pointerOrigin.y - thisObj.padding - thisObj.insetWidth;\r\n\r\n\t\tvar yVal = 100 - (y * (100 / (thisObj.height - 1)));\r\n\r\n\t\tswitch (jsc.getSliderComponent(thisObj)) {\r\n\t\tcase 's': thisObj.fromHSV(null, yVal, null, jsc.leavePad); break;\r\n\t\tcase 'v': thisObj.fromHSV(null, null, yVal, jsc.leavePad); break;\r\n\t\t}\r\n\t},\r\n\r\n\r\n\t_vmlNS : 'jsc_vml_',\r\n\t_vmlCSS : 'jsc_vml_css_',\r\n\t_vmlReady : false,\r\n\r\n\r\n\tinitVML : function () {\r\n\t\tif (!jsc._vmlReady) {\r\n\t\t\t// init VML namespace\r\n\t\t\tvar doc = document;\r\n\t\t\tif (!doc.namespaces[jsc._vmlNS]) {\r\n\t\t\t\tdoc.namespaces.add(jsc._vmlNS, 'urn:schemas-microsoft-com:vml');\r\n\t\t\t}\r\n\t\t\tif (!doc.styleSheets[jsc._vmlCSS]) {\r\n\t\t\t\tvar tags = ['shape', 'shapetype', 'group', 'background', 'path', 'formulas', 'handles', 'fill', 'stroke', 'shadow', 'textbox', 'textpath', 'imagedata', 'line', 'polyline', 'curve', 'rect', 'roundrect', 'oval', 'arc', 'image'];\r\n\t\t\t\tvar ss = doc.createStyleSheet();\r\n\t\t\t\tss.owningElement.id = jsc._vmlCSS;\r\n\t\t\t\tfor (var i = 0; i < tags.length; i += 1) {\r\n\t\t\t\t\tss.addRule(jsc._vmlNS + '\\\\:' + tags[i], 'behavior:url(#default#VML);');\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tjsc._vmlReady = true;\r\n\t\t}\r\n\t},\r\n\r\n\r\n\tcreatePalette : function () {\r\n\r\n\t\tvar paletteObj = {\r\n\t\t\telm: null,\r\n\t\t\tdraw: null\r\n\t\t};\r\n\r\n\t\tif (jsc.isCanvasSupported) {\r\n\t\t\t// Canvas implementation for modern browsers\r\n\r\n\t\t\tvar canvas = document.createElement('canvas');\r\n\t\t\tvar ctx = canvas.getContext('2d');\r\n\r\n\t\t\tvar drawFunc = function (width, height, type) {\r\n\t\t\t\tcanvas.width = width;\r\n\t\t\t\tcanvas.height = height;\r\n\r\n\t\t\t\tctx.clearRect(0, 0, canvas.width, canvas.height);\r\n\r\n\t\t\t\tvar hGrad = ctx.createLinearGradient(0, 0, canvas.width, 0);\r\n\t\t\t\thGrad.addColorStop(0 / 6, '#F00');\r\n\t\t\t\thGrad.addColorStop(1 / 6, '#FF0');\r\n\t\t\t\thGrad.addColorStop(2 / 6, '#0F0');\r\n\t\t\t\thGrad.addColorStop(3 / 6, '#0FF');\r\n\t\t\t\thGrad.addColorStop(4 / 6, '#00F');\r\n\t\t\t\thGrad.addColorStop(5 / 6, '#F0F');\r\n\t\t\t\thGrad.addColorStop(6 / 6, '#F00');\r\n\r\n\t\t\t\tctx.fillStyle = hGrad;\r\n\t\t\t\tctx.fillRect(0, 0, canvas.width, canvas.height);\r\n\r\n\t\t\t\tvar vGrad = ctx.createLinearGradient(0, 0, 0, canvas.height);\r\n\t\t\t\tswitch (type.toLowerCase()) {\r\n\t\t\t\tcase 's':\r\n\t\t\t\t\tvGrad.addColorStop(0, 'rgba(255,255,255,0)');\r\n\t\t\t\t\tvGrad.addColorStop(1, 'rgba(255,255,255,1)');\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase 'v':\r\n\t\t\t\t\tvGrad.addColorStop(0, 'rgba(0,0,0,0)');\r\n\t\t\t\t\tvGrad.addColorStop(1, 'rgba(0,0,0,1)');\r\n\t\t\t\t\tbreak;\r\n\t\t\t\t}\r\n\t\t\t\tctx.fillStyle = vGrad;\r\n\t\t\t\tctx.fillRect(0, 0, canvas.width, canvas.height);\r\n\t\t\t};\r\n\r\n\t\t\tpaletteObj.elm = canvas;\r\n\t\t\tpaletteObj.draw = drawFunc;\r\n\r\n\t\t} else {\r\n\t\t\t// VML fallback for IE 7 and 8\r\n\r\n\t\t\tjsc.initVML();\r\n\r\n\t\t\tvar vmlContainer = document.createElement('div');\r\n\t\t\tvmlContainer.style.position = 'relative';\r\n\t\t\tvmlContainer.style.overflow = 'hidden';\r\n\r\n\t\t\tvar hGrad = document.createElement(jsc._vmlNS + ':fill');\r\n\t\t\thGrad.type = 'gradient';\r\n\t\t\thGrad.method = 'linear';\r\n\t\t\thGrad.angle = '90';\r\n\t\t\thGrad.colors = '16.67% #F0F, 33.33% #00F, 50% #0FF, 66.67% #0F0, 83.33% #FF0'\r\n\r\n\t\t\tvar hRect = document.createElement(jsc._vmlNS + ':rect');\r\n\t\t\thRect.style.position = 'absolute';\r\n\t\t\thRect.style.left = -1 + 'px';\r\n\t\t\thRect.style.top = -1 + 'px';\r\n\t\t\thRect.stroked = false;\r\n\t\t\thRect.appendChild(hGrad);\r\n\t\t\tvmlContainer.appendChild(hRect);\r\n\r\n\t\t\tvar vGrad = document.createElement(jsc._vmlNS + ':fill');\r\n\t\t\tvGrad.type = 'gradient';\r\n\t\t\tvGrad.method = 'linear';\r\n\t\t\tvGrad.angle = '180';\r\n\t\t\tvGrad.opacity = '0';\r\n\r\n\t\t\tvar vRect = document.createElement(jsc._vmlNS + ':rect');\r\n\t\t\tvRect.style.position = 'absolute';\r\n\t\t\tvRect.style.left = -1 + 'px';\r\n\t\t\tvRect.style.top = -1 + 'px';\r\n\t\t\tvRect.stroked = false;\r\n\t\t\tvRect.appendChild(vGrad);\r\n\t\t\tvmlContainer.appendChild(vRect);\r\n\r\n\t\t\tvar drawFunc = function (width, height, type) {\r\n\t\t\t\tvmlContainer.style.width = width + 'px';\r\n\t\t\t\tvmlContainer.style.height = height + 'px';\r\n\r\n\t\t\t\thRect.style.width =\r\n\t\t\t\tvRect.style.width =\r\n\t\t\t\t\t(width + 1) + 'px';\r\n\t\t\t\thRect.style.height =\r\n\t\t\t\tvRect.style.height =\r\n\t\t\t\t\t(height + 1) + 'px';\r\n\r\n\t\t\t\t// Colors must be specified during every redraw, otherwise IE won't display\r\n\t\t\t\t// a full gradient during a subsequential redraw\r\n\t\t\t\thGrad.color = '#F00';\r\n\t\t\t\thGrad.color2 = '#F00';\r\n\r\n\t\t\t\tswitch (type.toLowerCase()) {\r\n\t\t\t\tcase 's':\r\n\t\t\t\t\tvGrad.color = vGrad.color2 = '#FFF';\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase 'v':\r\n\t\t\t\t\tvGrad.color = vGrad.color2 = '#000';\r\n\t\t\t\t\tbreak;\r\n\t\t\t\t}\r\n\t\t\t};\r\n\t\t\t\r\n\t\t\tpaletteObj.elm = vmlContainer;\r\n\t\t\tpaletteObj.draw = drawFunc;\r\n\t\t}\r\n\r\n\t\treturn paletteObj;\r\n\t},\r\n\r\n\r\n\tcreateSliderGradient : function () {\r\n\r\n\t\tvar sliderObj = {\r\n\t\t\telm: null,\r\n\t\t\tdraw: null\r\n\t\t};\r\n\r\n\t\tif (jsc.isCanvasSupported) {\r\n\t\t\t// Canvas implementation for modern browsers\r\n\r\n\t\t\tvar canvas = document.createElement('canvas');\r\n\t\t\tvar ctx = canvas.getContext('2d');\r\n\r\n\t\t\tvar drawFunc = function (width, height, color1, color2) {\r\n\t\t\t\tcanvas.width = width;\r\n\t\t\t\tcanvas.height = height;\r\n\r\n\t\t\t\tctx.clearRect(0, 0, canvas.width, canvas.height);\r\n\r\n\t\t\t\tvar grad = ctx.createLinearGradient(0, 0, 0, canvas.height);\r\n\t\t\t\tgrad.addColorStop(0, color1);\r\n\t\t\t\tgrad.addColorStop(1, color2);\r\n\r\n\t\t\t\tctx.fillStyle = grad;\r\n\t\t\t\tctx.fillRect(0, 0, canvas.width, canvas.height);\r\n\t\t\t};\r\n\r\n\t\t\tsliderObj.elm = canvas;\r\n\t\t\tsliderObj.draw = drawFunc;\r\n\r\n\t\t} else {\r\n\t\t\t// VML fallback for IE 7 and 8\r\n\r\n\t\t\tjsc.initVML();\r\n\r\n\t\t\tvar vmlContainer = document.createElement('div');\r\n\t\t\tvmlContainer.style.position = 'relative';\r\n\t\t\tvmlContainer.style.overflow = 'hidden';\r\n\r\n\t\t\tvar grad = document.createElement(jsc._vmlNS + ':fill');\r\n\t\t\tgrad.type = 'gradient';\r\n\t\t\tgrad.method = 'linear';\r\n\t\t\tgrad.angle = '180';\r\n\r\n\t\t\tvar rect = document.createElement(jsc._vmlNS + ':rect');\r\n\t\t\trect.style.position = 'absolute';\r\n\t\t\trect.style.left = -1 + 'px';\r\n\t\t\trect.style.top = -1 + 'px';\r\n\t\t\trect.stroked = false;\r\n\t\t\trect.appendChild(grad);\r\n\t\t\tvmlContainer.appendChild(rect);\r\n\r\n\t\t\tvar drawFunc = function (width, height, color1, color2) {\r\n\t\t\t\tvmlContainer.style.width = width + 'px';\r\n\t\t\t\tvmlContainer.style.height = height + 'px';\r\n\r\n\t\t\t\trect.style.width = (width + 1) + 'px';\r\n\t\t\t\trect.style.height = (height + 1) + 'px';\r\n\r\n\t\t\t\tgrad.color = color1;\r\n\t\t\t\tgrad.color2 = color2;\r\n\t\t\t};\r\n\t\t\t\r\n\t\t\tsliderObj.elm = vmlContainer;\r\n\t\t\tsliderObj.draw = drawFunc;\r\n\t\t}\r\n\r\n\t\treturn sliderObj;\r\n\t},\r\n\r\n\r\n\tleaveValue : 1<<0,\r\n\tleaveStyle : 1<<1,\r\n\tleavePad : 1<<2,\r\n\tleaveSld : 1<<3,\r\n\r\n\r\n\tBoxShadow : (function () {\r\n\t\tvar BoxShadow = function (hShadow, vShadow, blur, spread, color, inset) {\r\n\t\t\tthis.hShadow = hShadow;\r\n\t\t\tthis.vShadow = vShadow;\r\n\t\t\tthis.blur = blur;\r\n\t\t\tthis.spread = spread;\r\n\t\t\tthis.color = color;\r\n\t\t\tthis.inset = !!inset;\r\n\t\t};\r\n\r\n\t\tBoxShadow.prototype.toString = function () {\r\n\t\t\tvar vals = [\r\n\t\t\t\tMath.round(this.hShadow) + 'px',\r\n\t\t\t\tMath.round(this.vShadow) + 'px',\r\n\t\t\t\tMath.round(this.blur) + 'px',\r\n\t\t\t\tMath.round(this.spread) + 'px',\r\n\t\t\t\tthis.color\r\n\t\t\t];\r\n\t\t\tif (this.inset) {\r\n\t\t\t\tvals.push('inset');\r\n\t\t\t}\r\n\t\t\treturn vals.join(' ');\r\n\t\t};\r\n\r\n\t\treturn BoxShadow;\r\n\t})(),\r\n\r\n\r\n\t//\r\n\t// Usage:\r\n\t// var myColor = new jscolor(<targetElement> [, <options>])\r\n\t//\r\n\r\n\tjscolor : function (targetElement, options) {\r\n\r\n\t\t// General options\r\n\t\t//\r\n\t\tthis.value = null; // initial HEX color. To change it later, use methods fromString(), fromHSV() and fromRGB()\r\n\t\tthis.valueElement = targetElement; // element that will be used to display and input the color code\r\n\t\tthis.styleElement = targetElement; // element that will preview the picked color using CSS backgroundColor\r\n\t\tthis.required = true; // whether the associated text <input> can be left empty\r\n\t\tthis.refine = true; // whether to refine the entered color code (e.g. uppercase it and remove whitespace)\r\n\t\tthis.hash = false; // whether to prefix the HEX color code with # symbol\r\n\t\tthis.uppercase = true; // whether to uppercase the color code\r\n\t\tthis.onFineChange = null; // called instantly every time the color changes (value can be either a function or a string with javascript code)\r\n\t\tthis.activeClass = 'jscolor-active'; // class to be set to the target element when a picker window is open on it\r\n\t\tthis.minS = 0; // min allowed saturation (0 - 100)\r\n\t\tthis.maxS = 100; // max allowed saturation (0 - 100)\r\n\t\tthis.minV = 0; // min allowed value (brightness) (0 - 100)\r\n\t\tthis.maxV = 100; // max allowed value (brightness) (0 - 100)\r\n\r\n\t\t// Accessing the picked color\r\n\t\t//\r\n\t\tthis.hsv = [0, 0, 100]; // read-only  [0-360, 0-100, 0-100]\r\n\t\tthis.rgb = [255, 255, 255]; // read-only  [0-255, 0-255, 0-255]\r\n\r\n\t\t// Color Picker options\r\n\t\t//\r\n\t\tthis.width = 181; // width of color palette (in px)\r\n\t\tthis.height = 101; // height of color palette (in px)\r\n\t\tthis.showOnClick = true; // whether to display the color picker when user clicks on its target element\r\n\t\tthis.mode = 'HSV'; // HSV | HVS | HS | HV - layout of the color picker controls\r\n\t\tthis.position = 'bottom'; // left | right | top | bottom - position relative to the target element\r\n\t\tthis.smartPosition = true; // automatically change picker position when there is not enough space for it\r\n\t\tthis.sliderSize = 16; // px\r\n\t\tthis.crossSize = 8; // px\r\n\t\tthis.closable = false; // whether to display the Close button\r\n\t\tthis.closeText = 'Close';\r\n\t\tthis.buttonColor = '#000000'; // CSS color\r\n\t\tthis.buttonHeight = 18; // px\r\n\t\tthis.padding = 12; // px\r\n\t\tthis.backgroundColor = '#FFFFFF'; // CSS color\r\n\t\tthis.borderWidth = 1; // px\r\n\t\tthis.borderColor = '#BBBBBB'; // CSS color\r\n\t\tthis.borderRadius = 8; // px\r\n\t\tthis.insetWidth = 1; // px\r\n\t\tthis.insetColor = '#BBBBBB'; // CSS color\r\n\t\tthis.shadow = true; // whether to display shadow\r\n\t\tthis.shadowBlur = 15; // px\r\n\t\tthis.shadowColor = 'rgba(0,0,0,0.2)'; // CSS color\r\n\t\tthis.pointerColor = '#4C4C4C'; // px\r\n\t\tthis.pointerBorderColor = '#FFFFFF'; // px\r\n        this.pointerBorderWidth = 1; // px\r\n        this.pointerThickness = 2; // px\r\n\t\tthis.zIndex = 1000;\r\n\t\tthis.container = null; // where to append the color picker (BODY element by default)\r\n\r\n\r\n\t\tfor (var opt in options) {\r\n\t\t\tif (options.hasOwnProperty(opt)) {\r\n\t\t\t\tthis[opt] = options[opt];\r\n\t\t\t}\r\n\t\t}\r\n\r\n\r\n\t\tthis.hide = function () {\r\n\t\t\tif (isPickerOwner()) {\r\n\t\t\t\tdetachPicker();\r\n\t\t\t}\r\n\t\t};\r\n\r\n\r\n\t\tthis.show = function () {\r\n\t\t\tdrawPicker();\r\n\t\t};\r\n\r\n\r\n\t\tthis.redraw = function () {\r\n\t\t\tif (isPickerOwner()) {\r\n\t\t\t\tdrawPicker();\r\n\t\t\t}\r\n\t\t};\r\n\r\n\r\n\t\tthis.importColor = function () {\r\n\t\t\tif (!this.valueElement) {\r\n\t\t\t\tthis.exportColor();\r\n\t\t\t} else {\r\n\t\t\t\tif (jsc.isElementType(this.valueElement, 'input')) {\r\n\t\t\t\t\tif (!this.refine) {\r\n\t\t\t\t\t\tif (!this.fromString(this.valueElement.value, jsc.leaveValue)) {\r\n\t\t\t\t\t\t\tif (this.styleElement) {\r\n\t\t\t\t\t\t\t\tthis.styleElement.style.backgroundImage = this.styleElement._jscOrigStyle.backgroundImage;\r\n\t\t\t\t\t\t\t\tthis.styleElement.style.backgroundColor = this.styleElement._jscOrigStyle.backgroundColor;\r\n\t\t\t\t\t\t\t\tthis.styleElement.style.color = this.styleElement._jscOrigStyle.color;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tthis.exportColor(jsc.leaveValue | jsc.leaveStyle);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t} else if (!this.required && /^\\s*$/.test(this.valueElement.value)) {\r\n\t\t\t\t\t\tthis.valueElement.value = '';\r\n\t\t\t\t\t\tif (this.styleElement) {\r\n\t\t\t\t\t\t\tthis.styleElement.style.backgroundImage = this.styleElement._jscOrigStyle.backgroundImage;\r\n\t\t\t\t\t\t\tthis.styleElement.style.backgroundColor = this.styleElement._jscOrigStyle.backgroundColor;\r\n\t\t\t\t\t\t\tthis.styleElement.style.color = this.styleElement._jscOrigStyle.color;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tthis.exportColor(jsc.leaveValue | jsc.leaveStyle);\r\n\r\n\t\t\t\t\t} else if (this.fromString(this.valueElement.value)) {\r\n\t\t\t\t\t\t// managed to import color successfully from the value -> OK, don't do anything\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tthis.exportColor();\r\n\t\t\t\t\t}\r\n\t\t\t\t} else {\r\n\t\t\t\t\t// not an input element -> doesn't have any value\r\n\t\t\t\t\tthis.exportColor();\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t};\r\n\r\n\r\n\t\tthis.exportColor = function (flags) {\r\n\t\t\tif (!(flags & jsc.leaveValue) && this.valueElement) {\r\n\t\t\t\tvar value = this.toString();\r\n\t\t\t\tif (this.uppercase) { value = value.toUpperCase(); }\r\n\t\t\t\tif (this.hash) { value = '#' + value; }\r\n\r\n\t\t\t\tif (jsc.isElementType(this.valueElement, 'input')) {\r\n\t\t\t\t\tthis.valueElement.value = value;\r\n\t\t\t\t} else {\r\n\t\t\t\t\tthis.valueElement.innerHTML = value;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tif (!(flags & jsc.leaveStyle)) {\r\n\t\t\t\tif (this.styleElement) {\r\n\t\t\t\t\tthis.styleElement.style.backgroundImage = 'none';\r\n\t\t\t\t\tthis.styleElement.style.backgroundColor = '#' + this.toString();\r\n\t\t\t\t\tthis.styleElement.style.color = this.isLight() ? '#000' : '#FFF';\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tif (!(flags & jsc.leavePad) && isPickerOwner()) {\r\n\t\t\t\tredrawPad();\r\n\t\t\t}\r\n\t\t\tif (!(flags & jsc.leaveSld) && isPickerOwner()) {\r\n\t\t\t\tredrawSld();\r\n\t\t\t}\r\n\t\t};\r\n\r\n\r\n\t\t// h: 0-360\r\n\t\t// s: 0-100\r\n\t\t// v: 0-100\r\n\t\t//\r\n\t\tthis.fromHSV = function (h, s, v, flags) { // null = don't change\r\n\t\t\tif (h !== null) {\r\n\t\t\t\tif (isNaN(h)) { return false; }\r\n\t\t\t\th = Math.max(0, Math.min(360, h));\r\n\t\t\t}\r\n\t\t\tif (s !== null) {\r\n\t\t\t\tif (isNaN(s)) { return false; }\r\n\t\t\t\ts = Math.max(0, Math.min(100, this.maxS, s), this.minS);\r\n\t\t\t}\r\n\t\t\tif (v !== null) {\r\n\t\t\t\tif (isNaN(v)) { return false; }\r\n\t\t\t\tv = Math.max(0, Math.min(100, this.maxV, v), this.minV);\r\n\t\t\t}\r\n\r\n\t\t\tthis.rgb = HSV_RGB(\r\n\t\t\t\th===null ? this.hsv[0] : (this.hsv[0]=h),\r\n\t\t\t\ts===null ? this.hsv[1] : (this.hsv[1]=s),\r\n\t\t\t\tv===null ? this.hsv[2] : (this.hsv[2]=v)\r\n\t\t\t);\r\n\r\n\t\t\tthis.exportColor(flags);\r\n\t\t};\r\n\r\n\r\n\t\t// r: 0-255\r\n\t\t// g: 0-255\r\n\t\t// b: 0-255\r\n\t\t//\r\n\t\tthis.fromRGB = function (r, g, b, flags) { // null = don't change\r\n\t\t\tif (r !== null) {\r\n\t\t\t\tif (isNaN(r)) { return false; }\r\n\t\t\t\tr = Math.max(0, Math.min(255, r));\r\n\t\t\t}\r\n\t\t\tif (g !== null) {\r\n\t\t\t\tif (isNaN(g)) { return false; }\r\n\t\t\t\tg = Math.max(0, Math.min(255, g));\r\n\t\t\t}\r\n\t\t\tif (b !== null) {\r\n\t\t\t\tif (isNaN(b)) { return false; }\r\n\t\t\t\tb = Math.max(0, Math.min(255, b));\r\n\t\t\t}\r\n\r\n\t\t\tvar hsv = RGB_HSV(\r\n\t\t\t\tr===null ? this.rgb[0] : r,\r\n\t\t\t\tg===null ? this.rgb[1] : g,\r\n\t\t\t\tb===null ? this.rgb[2] : b\r\n\t\t\t);\r\n\t\t\tif (hsv[0] !== null) {\r\n\t\t\t\tthis.hsv[0] = Math.max(0, Math.min(360, hsv[0]));\r\n\t\t\t}\r\n\t\t\tif (hsv[2] !== 0) {\r\n\t\t\t\tthis.hsv[1] = hsv[1]===null ? null : Math.max(0, this.minS, Math.min(100, this.maxS, hsv[1]));\r\n\t\t\t}\r\n\t\t\tthis.hsv[2] = hsv[2]===null ? null : Math.max(0, this.minV, Math.min(100, this.maxV, hsv[2]));\r\n\r\n\t\t\t// update RGB according to final HSV, as some values might be trimmed\r\n\t\t\tvar rgb = HSV_RGB(this.hsv[0], this.hsv[1], this.hsv[2]);\r\n\t\t\tthis.rgb[0] = rgb[0];\r\n\t\t\tthis.rgb[1] = rgb[1];\r\n\t\t\tthis.rgb[2] = rgb[2];\r\n\r\n\t\t\tthis.exportColor(flags);\r\n\t\t};\r\n\r\n\r\n\t\tthis.fromString = function (str, flags) {\r\n\t\t\tvar m;\r\n\t\t\tif (m = str.match(/^\\W*([0-9A-F]{3}([0-9A-F]{3})?)\\W*$/i)) {\r\n\t\t\t\t// HEX notation\r\n\t\t\t\t//\r\n\r\n\t\t\t\tif (m[1].length === 6) {\r\n\t\t\t\t\t// 6-char notation\r\n\t\t\t\t\tthis.fromRGB(\r\n\t\t\t\t\t\tparseInt(m[1].substr(0,2),16),\r\n\t\t\t\t\t\tparseInt(m[1].substr(2,2),16),\r\n\t\t\t\t\t\tparseInt(m[1].substr(4,2),16),\r\n\t\t\t\t\t\tflags\r\n\t\t\t\t\t);\r\n\t\t\t\t} else {\r\n\t\t\t\t\t// 3-char notation\r\n\t\t\t\t\tthis.fromRGB(\r\n\t\t\t\t\t\tparseInt(m[1].charAt(0) + m[1].charAt(0),16),\r\n\t\t\t\t\t\tparseInt(m[1].charAt(1) + m[1].charAt(1),16),\r\n\t\t\t\t\t\tparseInt(m[1].charAt(2) + m[1].charAt(2),16),\r\n\t\t\t\t\t\tflags\r\n\t\t\t\t\t);\r\n\t\t\t\t}\r\n\t\t\t\treturn true;\r\n\r\n\t\t\t} else if (m = str.match(/^\\W*rgba?\\(([^)]*)\\)\\W*$/i)) {\r\n\t\t\t\tvar params = m[1].split(',');\r\n\t\t\t\tvar re = /^\\s*(\\d*)(\\.\\d+)?\\s*$/;\r\n\t\t\t\tvar mR, mG, mB;\r\n\t\t\t\tif (\r\n\t\t\t\t\tparams.length >= 3 &&\r\n\t\t\t\t\t(mR = params[0].match(re)) &&\r\n\t\t\t\t\t(mG = params[1].match(re)) &&\r\n\t\t\t\t\t(mB = params[2].match(re))\r\n\t\t\t\t) {\r\n\t\t\t\t\tvar r = parseFloat((mR[1] || '0') + (mR[2] || ''));\r\n\t\t\t\t\tvar g = parseFloat((mG[1] || '0') + (mG[2] || ''));\r\n\t\t\t\t\tvar b = parseFloat((mB[1] || '0') + (mB[2] || ''));\r\n\t\t\t\t\tthis.fromRGB(r, g, b, flags);\r\n\t\t\t\t\treturn true;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\treturn false;\r\n\t\t};\r\n\r\n\r\n\t\tthis.toString = function () {\r\n\t\t\treturn (\r\n\t\t\t\t(0x100 | Math.round(this.rgb[0])).toString(16).substr(1) +\r\n\t\t\t\t(0x100 | Math.round(this.rgb[1])).toString(16).substr(1) +\r\n\t\t\t\t(0x100 | Math.round(this.rgb[2])).toString(16).substr(1)\r\n\t\t\t);\r\n\t\t};\r\n\r\n\r\n\t\tthis.toHEXString = function () {\r\n\t\t\treturn '#' + this.toString().toUpperCase();\r\n\t\t};\r\n\r\n\r\n\t\tthis.toRGBString = function () {\r\n\t\t\treturn ('rgb(' +\r\n\t\t\t\tMath.round(this.rgb[0]) + ',' +\r\n\t\t\t\tMath.round(this.rgb[1]) + ',' +\r\n\t\t\t\tMath.round(this.rgb[2]) + ')'\r\n\t\t\t);\r\n\t\t};\r\n\r\n\r\n\t\tthis.isLight = function () {\r\n\t\t\treturn (\r\n\t\t\t\t0.213 * this.rgb[0] +\r\n\t\t\t\t0.715 * this.rgb[1] +\r\n\t\t\t\t0.072 * this.rgb[2] >\r\n\t\t\t\t255 / 2\r\n\t\t\t);\r\n\t\t};\r\n\r\n\r\n\t\tthis._processParentElementsInDOM = function () {\r\n\t\t\tif (this._linkedElementsProcessed) { return; }\r\n\t\t\tthis._linkedElementsProcessed = true;\r\n\r\n\t\t\tvar elm = this.targetElement;\r\n\t\t\tdo {\r\n\t\t\t\t// If the target element or one of its parent nodes has fixed position,\r\n\t\t\t\t// then use fixed positioning instead\r\n\t\t\t\t//\r\n\t\t\t\t// Note: In Firefox, getComputedStyle returns null in a hidden iframe,\r\n\t\t\t\t// that's why we need to check if the returned style object is non-empty\r\n\t\t\t\tvar currStyle = jsc.getStyle(elm);\r\n\t\t\t\tif (currStyle && currStyle.position.toLowerCase() === 'fixed') {\r\n\t\t\t\t\tthis.fixed = true;\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif (elm !== this.targetElement) {\r\n\t\t\t\t\t// Ensure to attach onParentScroll only once to each parent element\r\n\t\t\t\t\t// (multiple targetElements can share the same parent nodes)\r\n\t\t\t\t\t//\r\n\t\t\t\t\t// Note: It's not just offsetParents that can be scrollable,\r\n\t\t\t\t\t// that's why we loop through all parent nodes\r\n\t\t\t\t\tif (!elm._jscEventsAttached) {\r\n\t\t\t\t\t\tjsc.attachEvent(elm, 'scroll', jsc.onParentScroll);\r\n\t\t\t\t\t\telm._jscEventsAttached = true;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t} while ((elm = elm.parentNode) && !jsc.isElementType(elm, 'body'));\r\n\t\t};\r\n\r\n\r\n\t\t// r: 0-255\r\n\t\t// g: 0-255\r\n\t\t// b: 0-255\r\n\t\t//\r\n\t\t// returns: [ 0-360, 0-100, 0-100 ]\r\n\t\t//\r\n\t\tfunction RGB_HSV (r, g, b) {\r\n\t\t\tr /= 255;\r\n\t\t\tg /= 255;\r\n\t\t\tb /= 255;\r\n\t\t\tvar n = Math.min(Math.min(r,g),b);\r\n\t\t\tvar v = Math.max(Math.max(r,g),b);\r\n\t\t\tvar m = v - n;\r\n\t\t\tif (m === 0) { return [ null, 0, 100 * v ]; }\r\n\t\t\tvar h = r===n ? 3+(b-g)/m : (g===n ? 5+(r-b)/m : 1+(g-r)/m);\r\n\t\t\treturn [\r\n\t\t\t\t60 * (h===6?0:h),\r\n\t\t\t\t100 * (m/v),\r\n\t\t\t\t100 * v\r\n\t\t\t];\r\n\t\t}\r\n\r\n\r\n\t\t// h: 0-360\r\n\t\t// s: 0-100\r\n\t\t// v: 0-100\r\n\t\t//\r\n\t\t// returns: [ 0-255, 0-255, 0-255 ]\r\n\t\t//\r\n\t\tfunction HSV_RGB (h, s, v) {\r\n\t\t\tvar u = 255 * (v / 100);\r\n\r\n\t\t\tif (h === null) {\r\n\t\t\t\treturn [ u, u, u ];\r\n\t\t\t}\r\n\r\n\t\t\th /= 60;\r\n\t\t\ts /= 100;\r\n\r\n\t\t\tvar i = Math.floor(h);\r\n\t\t\tvar f = i%2 ? h-i : 1-(h-i);\r\n\t\t\tvar m = u * (1 - s);\r\n\t\t\tvar n = u * (1 - s * f);\r\n\t\t\tswitch (i) {\r\n\t\t\t\tcase 6:\r\n\t\t\t\tcase 0: return [u,n,m];\r\n\t\t\t\tcase 1: return [n,u,m];\r\n\t\t\t\tcase 2: return [m,u,n];\r\n\t\t\t\tcase 3: return [m,n,u];\r\n\t\t\t\tcase 4: return [n,m,u];\r\n\t\t\t\tcase 5: return [u,m,n];\r\n\t\t\t}\r\n\t\t}\r\n\r\n\r\n\t\tfunction detachPicker () {\r\n\t\t\tjsc.unsetClass(THIS.targetElement, THIS.activeClass);\r\n\t\t\tjsc.picker.wrap.parentNode.removeChild(jsc.picker.wrap);\r\n\t\t\tdelete jsc.picker.owner;\r\n\t\t}\r\n\r\n\r\n\t\tfunction drawPicker () {\r\n\r\n\t\t\t// At this point, when drawing the picker, we know what the parent elements are\r\n\t\t\t// and we can do all related DOM operations, such as registering events on them\r\n\t\t\t// or checking their positioning\r\n\t\t\tTHIS._processParentElementsInDOM();\r\n\r\n\t\t\tif (!jsc.picker) {\r\n\t\t\t\tjsc.picker = {\r\n\t\t\t\t\towner: null,\r\n\t\t\t\t\twrap : document.createElement('div'),\r\n\t\t\t\t\tbox : document.createElement('div'),\r\n\t\t\t\t\tboxS : document.createElement('div'), // shadow area\r\n\t\t\t\t\tboxB : document.createElement('div'), // border\r\n\t\t\t\t\tpad : document.createElement('div'),\r\n\t\t\t\t\tpadB : document.createElement('div'), // border\r\n\t\t\t\t\tpadM : document.createElement('div'), // mouse/touch area\r\n\t\t\t\t\tpadPal : jsc.createPalette(),\r\n\t\t\t\t\tcross : document.createElement('div'),\r\n\t\t\t\t\tcrossBY : document.createElement('div'), // border Y\r\n\t\t\t\t\tcrossBX : document.createElement('div'), // border X\r\n\t\t\t\t\tcrossLY : document.createElement('div'), // line Y\r\n\t\t\t\t\tcrossLX : document.createElement('div'), // line X\r\n\t\t\t\t\tsld : document.createElement('div'),\r\n\t\t\t\t\tsldB : document.createElement('div'), // border\r\n\t\t\t\t\tsldM : document.createElement('div'), // mouse/touch area\r\n\t\t\t\t\tsldGrad : jsc.createSliderGradient(),\r\n\t\t\t\t\tsldPtrS : document.createElement('div'), // slider pointer spacer\r\n\t\t\t\t\tsldPtrIB : document.createElement('div'), // slider pointer inner border\r\n\t\t\t\t\tsldPtrMB : document.createElement('div'), // slider pointer middle border\r\n\t\t\t\t\tsldPtrOB : document.createElement('div'), // slider pointer outer border\r\n\t\t\t\t\tbtn : document.createElement('div'),\r\n\t\t\t\t\tbtnT : document.createElement('span') // text\r\n\t\t\t\t};\r\n\r\n\t\t\t\tjsc.picker.pad.appendChild(jsc.picker.padPal.elm);\r\n\t\t\t\tjsc.picker.padB.appendChild(jsc.picker.pad);\r\n\t\t\t\tjsc.picker.cross.appendChild(jsc.picker.crossBY);\r\n\t\t\t\tjsc.picker.cross.appendChild(jsc.picker.crossBX);\r\n\t\t\t\tjsc.picker.cross.appendChild(jsc.picker.crossLY);\r\n\t\t\t\tjsc.picker.cross.appendChild(jsc.picker.crossLX);\r\n\t\t\t\tjsc.picker.padB.appendChild(jsc.picker.cross);\r\n\t\t\t\tjsc.picker.box.appendChild(jsc.picker.padB);\r\n\t\t\t\tjsc.picker.box.appendChild(jsc.picker.padM);\r\n\r\n\t\t\t\tjsc.picker.sld.appendChild(jsc.picker.sldGrad.elm);\r\n\t\t\t\tjsc.picker.sldB.appendChild(jsc.picker.sld);\r\n\t\t\t\tjsc.picker.sldB.appendChild(jsc.picker.sldPtrOB);\r\n\t\t\t\tjsc.picker.sldPtrOB.appendChild(jsc.picker.sldPtrMB);\r\n\t\t\t\tjsc.picker.sldPtrMB.appendChild(jsc.picker.sldPtrIB);\r\n\t\t\t\tjsc.picker.sldPtrIB.appendChild(jsc.picker.sldPtrS);\r\n\t\t\t\tjsc.picker.box.appendChild(jsc.picker.sldB);\r\n\t\t\t\tjsc.picker.box.appendChild(jsc.picker.sldM);\r\n\r\n\t\t\t\tjsc.picker.btn.appendChild(jsc.picker.btnT);\r\n\t\t\t\tjsc.picker.box.appendChild(jsc.picker.btn);\r\n\r\n\t\t\t\tjsc.picker.boxB.appendChild(jsc.picker.box);\r\n\t\t\t\tjsc.picker.wrap.appendChild(jsc.picker.boxS);\r\n\t\t\t\tjsc.picker.wrap.appendChild(jsc.picker.boxB);\r\n\t\t\t}\r\n\r\n\t\t\tvar p = jsc.picker;\r\n\r\n\t\t\tvar displaySlider = !!jsc.getSliderComponent(THIS);\r\n\t\t\tvar dims = jsc.getPickerDims(THIS);\r\n\t\t\tvar crossOuterSize = (2 * THIS.pointerBorderWidth + THIS.pointerThickness + 2 * THIS.crossSize);\r\n\t\t\tvar padToSliderPadding = jsc.getPadToSliderPadding(THIS);\r\n\t\t\tvar borderRadius = Math.min(\r\n\t\t\t\tTHIS.borderRadius,\r\n\t\t\t\tMath.round(THIS.padding * Math.PI)); // px\r\n\t\t\tvar padCursor = 'crosshair';\r\n\r\n\t\t\t// wrap\r\n\t\t\tp.wrap.style.clear = 'both';\r\n\t\t\tp.wrap.style.width = (dims[0] + 2 * THIS.borderWidth) + 'px';\r\n\t\t\tp.wrap.style.height = (dims[1] + 2 * THIS.borderWidth) + 'px';\r\n\t\t\tp.wrap.style.zIndex = THIS.zIndex;\r\n\r\n\t\t\t// picker\r\n\t\t\tp.box.style.width = dims[0] + 'px';\r\n\t\t\tp.box.style.height = dims[1] + 'px';\r\n\r\n\t\t\tp.boxS.style.position = 'absolute';\r\n\t\t\tp.boxS.style.left = '0';\r\n\t\t\tp.boxS.style.top = '0';\r\n\t\t\tp.boxS.style.width = '100%';\r\n\t\t\tp.boxS.style.height = '100%';\r\n\t\t\tjsc.setBorderRadius(p.boxS, borderRadius + 'px');\r\n\r\n\t\t\t// picker border\r\n\t\t\tp.boxB.style.position = 'relative';\r\n\t\t\tp.boxB.style.border = THIS.borderWidth + 'px solid';\r\n\t\t\tp.boxB.style.borderColor = THIS.borderColor;\r\n\t\t\tp.boxB.style.background = THIS.backgroundColor;\r\n\t\t\tjsc.setBorderRadius(p.boxB, borderRadius + 'px');\r\n\r\n\t\t\t// IE hack:\r\n\t\t\t// If the element is transparent, IE will trigger the event on the elements under it,\r\n\t\t\t// e.g. on Canvas or on elements with border\r\n\t\t\tp.padM.style.background =\r\n\t\t\tp.sldM.style.background =\r\n\t\t\t\t'#FFF';\r\n\t\t\tjsc.setStyle(p.padM, 'opacity', '0');\r\n\t\t\tjsc.setStyle(p.sldM, 'opacity', '0');\r\n\r\n\t\t\t// pad\r\n\t\t\tp.pad.style.position = 'relative';\r\n\t\t\tp.pad.style.width = THIS.width + 'px';\r\n\t\t\tp.pad.style.height = THIS.height + 'px';\r\n\r\n\t\t\t// pad palettes (HSV and HVS)\r\n\t\t\tp.padPal.draw(THIS.width, THIS.height, jsc.getPadYComponent(THIS));\r\n\r\n\t\t\t// pad border\r\n\t\t\tp.padB.style.position = 'absolute';\r\n\t\t\tp.padB.style.left = THIS.padding + 'px';\r\n\t\t\tp.padB.style.top = THIS.padding + 'px';\r\n\t\t\tp.padB.style.border = THIS.insetWidth + 'px solid';\r\n\t\t\tp.padB.style.borderColor = THIS.insetColor;\r\n\r\n\t\t\t// pad mouse area\r\n\t\t\tp.padM._jscInstance = THIS;\r\n\t\t\tp.padM._jscControlName = 'pad';\r\n\t\t\tp.padM.style.position = 'absolute';\r\n\t\t\tp.padM.style.left = '0';\r\n\t\t\tp.padM.style.top = '0';\r\n\t\t\tp.padM.style.width = (THIS.padding + 2 * THIS.insetWidth + THIS.width + padToSliderPadding / 2) + 'px';\r\n\t\t\tp.padM.style.height = dims[1] + 'px';\r\n\t\t\tp.padM.style.cursor = padCursor;\r\n\r\n\t\t\t// pad cross\r\n\t\t\tp.cross.style.position = 'absolute';\r\n\t\t\tp.cross.style.left =\r\n\t\t\tp.cross.style.top =\r\n\t\t\t\t'0';\r\n\t\t\tp.cross.style.width =\r\n\t\t\tp.cross.style.height =\r\n\t\t\t\tcrossOuterSize + 'px';\r\n\r\n\t\t\t// pad cross border Y and X\r\n\t\t\tp.crossBY.style.position =\r\n\t\t\tp.crossBX.style.position =\r\n\t\t\t\t'absolute';\r\n\t\t\tp.crossBY.style.background =\r\n\t\t\tp.crossBX.style.background =\r\n\t\t\t\tTHIS.pointerBorderColor;\r\n\t\t\tp.crossBY.style.width =\r\n\t\t\tp.crossBX.style.height =\r\n\t\t\t\t(2 * THIS.pointerBorderWidth + THIS.pointerThickness) + 'px';\r\n\t\t\tp.crossBY.style.height =\r\n\t\t\tp.crossBX.style.width =\r\n\t\t\t\tcrossOuterSize + 'px';\r\n\t\t\tp.crossBY.style.left =\r\n\t\t\tp.crossBX.style.top =\r\n\t\t\t\t(Math.floor(crossOuterSize / 2) - Math.floor(THIS.pointerThickness / 2) - THIS.pointerBorderWidth) + 'px';\r\n\t\t\tp.crossBY.style.top =\r\n\t\t\tp.crossBX.style.left =\r\n\t\t\t\t'0';\r\n\r\n\t\t\t// pad cross line Y and X\r\n\t\t\tp.crossLY.style.position =\r\n\t\t\tp.crossLX.style.position =\r\n\t\t\t\t'absolute';\r\n\t\t\tp.crossLY.style.background =\r\n\t\t\tp.crossLX.style.background =\r\n\t\t\t\tTHIS.pointerColor;\r\n\t\t\tp.crossLY.style.height =\r\n\t\t\tp.crossLX.style.width =\r\n\t\t\t\t(crossOuterSize - 2 * THIS.pointerBorderWidth) + 'px';\r\n\t\t\tp.crossLY.style.width =\r\n\t\t\tp.crossLX.style.height =\r\n\t\t\t\tTHIS.pointerThickness + 'px';\r\n\t\t\tp.crossLY.style.left =\r\n\t\t\tp.crossLX.style.top =\r\n\t\t\t\t(Math.floor(crossOuterSize / 2) - Math.floor(THIS.pointerThickness / 2)) + 'px';\r\n\t\t\tp.crossLY.style.top =\r\n\t\t\tp.crossLX.style.left =\r\n\t\t\t\tTHIS.pointerBorderWidth + 'px';\r\n\r\n\t\t\t// slider\r\n\t\t\tp.sld.style.overflow = 'hidden';\r\n\t\t\tp.sld.style.width = THIS.sliderSize + 'px';\r\n\t\t\tp.sld.style.height = THIS.height + 'px';\r\n\r\n\t\t\t// slider gradient\r\n\t\t\tp.sldGrad.draw(THIS.sliderSize, THIS.height, '#000', '#000');\r\n\r\n\t\t\t// slider border\r\n\t\t\tp.sldB.style.display = displaySlider ? 'block' : 'none';\r\n\t\t\tp.sldB.style.position = 'absolute';\r\n\t\t\tp.sldB.style.right = THIS.padding + 'px';\r\n\t\t\tp.sldB.style.top = THIS.padding + 'px';\r\n\t\t\tp.sldB.style.border = THIS.insetWidth + 'px solid';\r\n\t\t\tp.sldB.style.borderColor = THIS.insetColor;\r\n\r\n\t\t\t// slider mouse area\r\n\t\t\tp.sldM._jscInstance = THIS;\r\n\t\t\tp.sldM._jscControlName = 'sld';\r\n\t\t\tp.sldM.style.display = displaySlider ? 'block' : 'none';\r\n\t\t\tp.sldM.style.position = 'absolute';\r\n\t\t\tp.sldM.style.right = '0';\r\n\t\t\tp.sldM.style.top = '0';\r\n\t\t\tp.sldM.style.width = (THIS.sliderSize + padToSliderPadding / 2 + THIS.padding + 2 * THIS.insetWidth) + 'px';\r\n\t\t\tp.sldM.style.height = dims[1] + 'px';\r\n\t\t\tp.sldM.style.cursor = 'default';\r\n\r\n\t\t\t// slider pointer inner and outer border\r\n\t\t\tp.sldPtrIB.style.border =\r\n\t\t\tp.sldPtrOB.style.border =\r\n\t\t\t\tTHIS.pointerBorderWidth + 'px solid ' + THIS.pointerBorderColor;\r\n\r\n\t\t\t// slider pointer outer border\r\n\t\t\tp.sldPtrOB.style.position = 'absolute';\r\n\t\t\tp.sldPtrOB.style.left = -(2 * THIS.pointerBorderWidth + THIS.pointerThickness) + 'px';\r\n\t\t\tp.sldPtrOB.style.top = '0';\r\n\r\n\t\t\t// slider pointer middle border\r\n\t\t\tp.sldPtrMB.style.border = THIS.pointerThickness + 'px solid ' + THIS.pointerColor;\r\n\r\n\t\t\t// slider pointer spacer\r\n\t\t\tp.sldPtrS.style.width = THIS.sliderSize + 'px';\r\n\t\t\tp.sldPtrS.style.height = sliderPtrSpace + 'px';\r\n\r\n\t\t\t// the Close button\r\n\t\t\tfunction setBtnBorder () {\r\n\t\t\t\tvar insetColors = THIS.insetColor.split(/\\s+/);\r\n\t\t\t\tvar outsetColor = insetColors.length < 2 ? insetColors[0] : insetColors[1] + ' ' + insetColors[0] + ' ' + insetColors[0] + ' ' + insetColors[1];\r\n\t\t\t\tp.btn.style.borderColor = outsetColor;\r\n\t\t\t}\r\n\t\t\tp.btn.style.display = THIS.closable ? 'block' : 'none';\r\n\t\t\tp.btn.style.position = 'absolute';\r\n\t\t\tp.btn.style.left = THIS.padding + 'px';\r\n\t\t\tp.btn.style.bottom = THIS.padding + 'px';\r\n\t\t\tp.btn.style.padding = '0 15px';\r\n\t\t\tp.btn.style.height = THIS.buttonHeight + 'px';\r\n\t\t\tp.btn.style.border = THIS.insetWidth + 'px solid';\r\n\t\t\tsetBtnBorder();\r\n\t\t\tp.btn.style.color = THIS.buttonColor;\r\n\t\t\tp.btn.style.font = '12px sans-serif';\r\n\t\t\tp.btn.style.textAlign = 'center';\r\n\t\t\ttry {\r\n\t\t\t\tp.btn.style.cursor = 'pointer';\r\n\t\t\t} catch(eOldIE) {\r\n\t\t\t\tp.btn.style.cursor = 'hand';\r\n\t\t\t}\r\n\t\t\tp.btn.onmousedown = function () {\r\n\t\t\t\tTHIS.hide();\r\n\t\t\t};\r\n\t\t\tp.btnT.style.lineHeight = THIS.buttonHeight + 'px';\r\n\t\t\tp.btnT.innerHTML = '';\r\n\t\t\tp.btnT.appendChild(document.createTextNode(THIS.closeText));\r\n\r\n\t\t\t// place pointers\r\n\t\t\tredrawPad();\r\n\t\t\tredrawSld();\r\n\r\n\t\t\t// If we are changing the owner without first closing the picker,\r\n\t\t\t// make sure to first deal with the old owner\r\n\t\t\tif (jsc.picker.owner && jsc.picker.owner !== THIS) {\r\n\t\t\t\tjsc.unsetClass(jsc.picker.owner.targetElement, THIS.activeClass);\r\n\t\t\t}\r\n\r\n\t\t\t// Set the new picker owner\r\n\t\t\tjsc.picker.owner = THIS;\r\n\r\n\t\t\t// The redrawPosition() method needs picker.owner to be set, that's why we call it here,\r\n\t\t\t// after setting the owner\r\n\t\t\tif (jsc.isElementType(container, 'body')) {\r\n\t\t\t\tjsc.redrawPosition();\r\n\t\t\t} else {\r\n\t\t\t\tjsc._drawPosition(THIS, 0, 0, 'relative', false);\r\n\t\t\t}\r\n\r\n\t\t\tif (p.wrap.parentNode != container) {\r\n\t\t\t\tcontainer.appendChild(p.wrap);\r\n\t\t\t}\r\n\r\n\t\t\tjsc.setClass(THIS.targetElement, THIS.activeClass);\r\n\t\t}\r\n\r\n\r\n\t\tfunction redrawPad () {\r\n\t\t\t// redraw the pad pointer\r\n\t\t\tswitch (jsc.getPadYComponent(THIS)) {\r\n\t\t\tcase 's': var yComponent = 1; break;\r\n\t\t\tcase 'v': var yComponent = 2; break;\r\n\t\t\t}\r\n\t\t\tvar x = Math.round((THIS.hsv[0] / 360) * (THIS.width - 1));\r\n\t\t\tvar y = Math.round((1 - THIS.hsv[yComponent] / 100) * (THIS.height - 1));\r\n\t\t\tvar crossOuterSize = (2 * THIS.pointerBorderWidth + THIS.pointerThickness + 2 * THIS.crossSize);\r\n\t\t\tvar ofs = -Math.floor(crossOuterSize / 2);\r\n\t\t\tjsc.picker.cross.style.left = (x + ofs) + 'px';\r\n\t\t\tjsc.picker.cross.style.top = (y + ofs) + 'px';\r\n\r\n\t\t\t// redraw the slider\r\n\t\t\tswitch (jsc.getSliderComponent(THIS)) {\r\n\t\t\tcase 's':\r\n\t\t\t\tvar rgb1 = HSV_RGB(THIS.hsv[0], 100, THIS.hsv[2]);\r\n\t\t\t\tvar rgb2 = HSV_RGB(THIS.hsv[0], 0, THIS.hsv[2]);\r\n\t\t\t\tvar color1 = 'rgb(' +\r\n\t\t\t\t\tMath.round(rgb1[0]) + ',' +\r\n\t\t\t\t\tMath.round(rgb1[1]) + ',' +\r\n\t\t\t\t\tMath.round(rgb1[2]) + ')';\r\n\t\t\t\tvar color2 = 'rgb(' +\r\n\t\t\t\t\tMath.round(rgb2[0]) + ',' +\r\n\t\t\t\t\tMath.round(rgb2[1]) + ',' +\r\n\t\t\t\t\tMath.round(rgb2[2]) + ')';\r\n\t\t\t\tjsc.picker.sldGrad.draw(THIS.sliderSize, THIS.height, color1, color2);\r\n\t\t\t\tbreak;\r\n\t\t\tcase 'v':\r\n\t\t\t\tvar rgb = HSV_RGB(THIS.hsv[0], THIS.hsv[1], 100);\r\n\t\t\t\tvar color1 = 'rgb(' +\r\n\t\t\t\t\tMath.round(rgb[0]) + ',' +\r\n\t\t\t\t\tMath.round(rgb[1]) + ',' +\r\n\t\t\t\t\tMath.round(rgb[2]) + ')';\r\n\t\t\t\tvar color2 = '#000';\r\n\t\t\t\tjsc.picker.sldGrad.draw(THIS.sliderSize, THIS.height, color1, color2);\r\n\t\t\t\tbreak;\r\n\t\t\t}\r\n\t\t}\r\n\r\n\r\n\t\tfunction redrawSld () {\r\n\t\t\tvar sldComponent = jsc.getSliderComponent(THIS);\r\n\t\t\tif (sldComponent) {\r\n\t\t\t\t// redraw the slider pointer\r\n\t\t\t\tswitch (sldComponent) {\r\n\t\t\t\tcase 's': var yComponent = 1; break;\r\n\t\t\t\tcase 'v': var yComponent = 2; break;\r\n\t\t\t\t}\r\n\t\t\t\tvar y = Math.round((1 - THIS.hsv[yComponent] / 100) * (THIS.height - 1));\r\n\t\t\t\tjsc.picker.sldPtrOB.style.top = (y - (2 * THIS.pointerBorderWidth + THIS.pointerThickness) - Math.floor(sliderPtrSpace / 2)) + 'px';\r\n\t\t\t}\r\n\t\t}\r\n\r\n\r\n\t\tfunction isPickerOwner () {\r\n\t\t\treturn jsc.picker && jsc.picker.owner === THIS;\r\n\t\t}\r\n\r\n\r\n\t\tfunction blurValue () {\r\n\t\t\tTHIS.importColor();\r\n\t\t}\r\n\r\n\r\n\t\t// Find the target element\r\n\t\tif (typeof targetElement === 'string') {\r\n\t\t\tvar id = targetElement;\r\n\t\t\tvar elm = document.getElementById(id);\r\n\t\t\tif (elm) {\r\n\t\t\t\tthis.targetElement = elm;\r\n\t\t\t} else {\r\n\t\t\t\tjsc.warn('Could not find target element with ID \\'' + id + '\\'');\r\n\t\t\t}\r\n\t\t} else if (targetElement) {\r\n\t\t\tthis.targetElement = targetElement;\r\n\t\t} else {\r\n\t\t\tjsc.warn('Invalid target element: \\'' + targetElement + '\\'');\r\n\t\t}\r\n\r\n\t\tif (this.targetElement._jscLinkedInstance) {\r\n\t\t\tjsc.warn('Cannot link jscolor twice to the same element. Skipping.');\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tthis.targetElement._jscLinkedInstance = this;\r\n\r\n\t\t// Find the value element\r\n\t\tthis.valueElement = jsc.fetchElement(this.valueElement);\r\n\t\t// Find the style element\r\n\t\tthis.styleElement = jsc.fetchElement(this.styleElement);\r\n\r\n\t\tvar THIS = this;\r\n\t\tvar container =\r\n\t\t\tthis.container ?\r\n\t\t\tjsc.fetchElement(this.container) :\r\n\t\t\tdocument.getElementsByTagName('body')[0];\r\n\t\tvar sliderPtrSpace = 3; // px\r\n\r\n\t\t// For BUTTON elements it's important to stop them from sending the form when clicked\r\n\t\t// (e.g. in Safari)\r\n\t\tif (jsc.isElementType(this.targetElement, 'button')) {\r\n\t\t\tif (this.targetElement.onclick) {\r\n\t\t\t\tvar origCallback = this.targetElement.onclick;\r\n\t\t\t\tthis.targetElement.onclick = function (evt) {\r\n\t\t\t\t\torigCallback.call(this, evt);\r\n\t\t\t\t\treturn false;\r\n\t\t\t\t};\r\n\t\t\t} else {\r\n\t\t\t\tthis.targetElement.onclick = function () { return false; };\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\t/*\r\n\t\tvar elm = this.targetElement;\r\n\t\tdo {\r\n\t\t\t// If the target element or one of its offsetParents has fixed position,\r\n\t\t\t// then use fixed positioning instead\r\n\t\t\t//\r\n\t\t\t// Note: In Firefox, getComputedStyle returns null in a hidden iframe,\r\n\t\t\t// that's why we need to check if the returned style object is non-empty\r\n\t\t\tvar currStyle = jsc.getStyle(elm);\r\n\t\t\tif (currStyle && currStyle.position.toLowerCase() === 'fixed') {\r\n\t\t\t\tthis.fixed = true;\r\n\t\t\t}\r\n\r\n\t\t\tif (elm !== this.targetElement) {\r\n\t\t\t\t// attach onParentScroll so that we can recompute the picker position\r\n\t\t\t\t// when one of the offsetParents is scrolled\r\n\t\t\t\tif (!elm._jscEventsAttached) {\r\n\t\t\t\t\tjsc.attachEvent(elm, 'scroll', jsc.onParentScroll);\r\n\t\t\t\t\telm._jscEventsAttached = true;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t} while ((elm = elm.offsetParent) && !jsc.isElementType(elm, 'body'));\r\n\t\t*/\r\n\r\n\t\t// valueElement\r\n\t\tif (this.valueElement) {\r\n\t\t\tif (jsc.isElementType(this.valueElement, 'input')) {\r\n\t\t\t\tvar updateField = function () {\r\n\t\t\t\t\tTHIS.fromString(THIS.valueElement.value, jsc.leaveValue);\r\n\t\t\t\t\tjsc.dispatchFineChange(THIS);\r\n\t\t\t\t};\r\n\t\t\t\tjsc.attachEvent(this.valueElement, 'keyup', updateField);\r\n\t\t\t\tjsc.attachEvent(this.valueElement, 'input', updateField);\r\n\t\t\t\tjsc.attachEvent(this.valueElement, 'blur', blurValue);\r\n\t\t\t\tthis.valueElement.setAttribute('autocomplete', 'off');\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\t// styleElement\r\n\t\tif (this.styleElement) {\r\n\t\t\tthis.styleElement._jscOrigStyle = {\r\n\t\t\t\tbackgroundImage : this.styleElement.style.backgroundImage,\r\n\t\t\t\tbackgroundColor : this.styleElement.style.backgroundColor,\r\n\t\t\t\tcolor : this.styleElement.style.color\r\n\t\t\t};\r\n\t\t}\r\n\r\n\t\tif (this.value) {\r\n\t\t\t// Try to set the color from the .value option and if unsuccessful,\r\n\t\t\t// export the current color\r\n\t\t\tthis.fromString(this.value) || this.exportColor();\r\n\t\t} else {\r\n\t\t\tthis.importColor();\r\n\t\t}\r\n\t}\r\n\r\n};\r\n\r\n\r\n//================================\r\n// Public properties and methods\r\n//================================\r\n\r\n\r\n// By default, search for all elements with class=\"jscolor\" and install a color picker on them.\r\n//\r\n// You can change what class name will be looked for by setting the property jscolor.lookupClass\r\n// anywhere in your HTML document. To completely disable the automatic lookup, set it to null.\r\n//\r\njsc.jscolor.lookupClass = 'jscolor';\r\n\r\n\r\njsc.jscolor.installByClassName = function (className) {\r\n\tvar inputElms = document.getElementsByTagName('input');\r\n\tvar buttonElms = document.getElementsByTagName('button');\r\n\r\n\tjsc.tryInstallOnElements(inputElms, className);\r\n\tjsc.tryInstallOnElements(buttonElms, className);\r\n};\r\n\r\n\r\njsc.register();\r\n\r\n\r\nreturn jsc.jscolor;\r\n\r\n\r\n})(); }\r\n","yachtApp.controller('RoomController', function RoomController($scope) {\r\n  $.getJSON(\"/users\", function(data){\r\n    $scope.users = data.users;\r\n    $scope.$apply();\r\n  });\r\n});\r\n","/*====================================================================\r\n *\r\n * This file is used to setup all the necessary tools the other scripts need.\r\n *\r\n =====================================================================*/\r\n\r\n// Setup Angular\r\n// Define the `phonecatApp` module\r\nwindow.yachtApp = angular.module('yachtApp', []);\r\n\r\n//Setup Canvas \"stuff\"\r\n//========================\r\nwindow.currUser = \"\";\r\nwindow.cursorStates = {};\r\nwindow.drawing = false;\r\nwindow.mousePos = { x:0, y:0 };\r\nwindow.lastPos = mousePos;\r\n\r\n// Mouse Layer\r\nwindow.mouseCanvas = document.getElementById(\"mouse-canvas\");\r\nwindow.mouseCtx = mouseCanvas.getContext(\"2d\");\r\n\r\n// Drawing Layer\r\nwindow.collabCanvas = document.getElementById(\"collab-canvas\");\r\nwindow.ctx = collabCanvas.getContext(\"2d\");\r\nctx.strokeStyle = \"#222222\";\r\nctx.lineWidth = 2;\r\n","import \"phoenix_html\"\nimport {Socket} from \"phoenix\"\n\r\n// Initialize Socket.\r\nlet socket = new Socket(\"/socket\", {params: {token: window.userToken}});\r\n\r\n//Functions\r\n//=============================================\r\nfunction clearCanvas() {\r\n  collabCanvas.width = collabCanvas.width;\n}\n\r\nfunction reloadUserTable() {\r\n  var scope = $('#mainBody').scope();\r\n  $.getJSON(\"/users\", function(data){\r\n    scope.users = data.users;\r\n    scope.$apply();\r\n  });\r\n}\r\n\r\n//MAINLINE code\r\n//==============================================\r\n\r\n//Connect socket.\r\nsocket.connect();\r\nwindow.channel = socket.channel(\"room:lobby\", {});\n\nchannel.join()\n  .receive(\"ok\", resp => { console.log(\"Joined successfully\", resp) })\n  .receive(\"error\", resp => { console.log(\"Unable to join\", resp) });\n\n//Socket events\n//==========================\nchannel.on(\"drawline\", payload => {\r\n    ctx.moveTo(payload.from.x, payload.from.y);\r\n    ctx.lineTo(payload.to.x, payload.to.y);\r\n    ctx.stroke();\r\n});\r\n\r\nchannel.on(\"clear\", payload => {\r\n  console.log(\"Clearing canvas.\");\r\n  clearCanvas();\r\n});\r\n\r\nchannel.on(\"mousemove\", payload => {\r\n  var img = document.getElementById(\"cursor\");\r\n  img.display=\"inline\";\r\n  mouseCanvas.width = mouseCanvas.width;\r\n  if(payload.name != currUser)\r\n  {\r\n    cursorStates[payload.name] = {\"x\" : payload.position.x, \"y\" :  payload.position.y}\r\n  }\r\n\r\n  //Iterate through every cursor position and draw them all back. This may be slow...\r\n  var cursorKeys = Object.keys(cursorStates);\r\n  cursorKeys.forEach(function(currKey){\r\n    mouseCtx.drawImage(img, cursorStates[currKey].x, cursorStates[currKey].y);\r\n  });\r\n});\n\nchannel.on(\"userJoined\", payload =>{\n  console.log(\"Reloading User Table.\");\r\n  //Not sure why it only works if I give it a timeout, prolly an async somewhere.\r\n  setTimeout(reloadUserTable, 100);\r\n});\r\n"]}